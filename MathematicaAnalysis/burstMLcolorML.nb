(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    607056,      13586]
NotebookOptionsPosition[    579777,      13100]
NotebookOutlinePosition[    580565,      13128]
CellTagsIndexPosition[    580522,      13125]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["BurstML and ColorML ", "Title",
 CellChangeTimes->{{3.911987191929649*^9, 3.911987255131127*^9}, {
   3.9249559573312054`*^9, 3.924956111439991*^9}, 3.924956164799032*^9, {
   3.9250222224095*^9, 3.9250222272608376`*^9}, {3.927966772684485*^9, 
   3.927966775655207*^9}, {3.927979935569103*^9, 3.9279799529287815`*^9}, {
   3.9412168994476624`*^9, 3.941216936792906*^9}, 
   3.941217320190119*^9},ExpressionUUID->"62156fb9-ce8f-4703-a030-\
792eeb38a9b2"],

Cell[TextData[{
 StyleBox["BurstML",
  FontWeight->"Bold"],
 " and ",
 StyleBox["ColorML",
  FontWeight->"Bold"],
 "  are maximum likelihood (ML) methods developed to  analyze photon  bursts \
from  diffusing molecules undergoing conformational transitions.  The code \
below is  specifically written for a molecule with two interconverting \
states.\n\n",
 StyleBox["ColorML",
  FontWeight->"Bold"],
 "  gives the FRET efficiencies of the states and transition rates.  It is \
based on a reduced likelihood function without fluorescence intensities and \
does not involve burst selection criteria.  \n\n",
 StyleBox["BurstML",
  FontWeight->"Bold"],
 " gives brightness, diffusion times, FRET efficiencies of the states, and \
transition rates.  It optimizes a likelihood function that explicitly \
incorporates translational diffusion and conformational dynamics. \n\n",
 StyleBox["Input",
  FontWeight->"Bold"],
 ": a list of photon bursts; each burst is a list   {{",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "1"], TraditionalForm]],ExpressionUUID->
  "ba50bdd0-d49a-664d-81c2-aab528120cb6"],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]],ExpressionUUID->
  "d8b931ea-f03c-b34e-8728-804306eedac0"],
 "},{",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "2"], TraditionalForm]],ExpressionUUID->
  "cb7de2e8-6a02-f949-a744-f2e606da9055"],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "2"], TraditionalForm]],ExpressionUUID->
  "3e80ff96-48bf-a947-84a4-131c9c19cf3c"],
 "},...} with arrival time ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "i"], TraditionalForm]],ExpressionUUID->
  "50bbd206-25ad-494d-8cf8-8acaa6d2983b"],
 " and color ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "i"], TraditionalForm]],ExpressionUUID->
  "edf5ce03-03e6-7646-99a6-d1217ddc2dcf"],
 " (donor or acceptor) for ",
 StyleBox["i",
  FontSlant->"Italic"],
 "th photon. \n\nFurther details can be found  in   I .V. Gopich, J.M. Louis, \
 and  H.S. Chung,  \[OpenCurlyDoubleQuote]Maximum Likelihood Analysis of \
Diffusing Molecules with Conformational Dynamics in Single-Molecule FRET\
\[CloseCurlyDoubleQuote]. \n\nNovember, 2024."
}], "Text",
 CellChangeTimes->{{3.924956148433134*^9, 3.9249561766411743`*^9}, {
   3.924959164597851*^9, 3.924959174259962*^9}, 3.9250222431085224`*^9, {
   3.927966783247219*^9, 3.927966785271158*^9}, {3.927987493076542*^9, 
   3.9279874981092014`*^9}, {3.930223993860391*^9, 3.930223998968836*^9}, 
   3.9303073742052345`*^9, 3.9303899493667583`*^9, {3.930551479159078*^9, 
   3.930551479254263*^9}, 3.941216889099893*^9, {3.9412169535056744`*^9, 
   3.9412169651838846`*^9}, {3.941217171109112*^9, 3.941217306094869*^9}, {
   3.941217342022753*^9, 3.9412173857594376`*^9}, {3.941219763110386*^9, 
   3.9412197645600414`*^9}, {3.941219804310255*^9, 3.9412198431926994`*^9}, {
   3.941219886686596*^9, 3.9412201541906223`*^9}, {3.941220937704973*^9, 
   3.9412209381781464`*^9}, {3.9412214615184345`*^9, 3.94122150456863*^9}, {
   3.941276224834154*^9, 3.941276227224766*^9}, {3.941276624127208*^9, 
   3.941276629190109*^9}, {3.941276671952341*^9, 3.9412767801851673`*^9}, {
   3.94127690953368*^9, 3.9412769640824413`*^9}, {3.941277016689457*^9, 
   3.941277095637953*^9}, {3.9412771586550045`*^9, 3.941277191208713*^9}, {
   3.941277229305872*^9, 3.941277251794049*^9}, 3.9412772969102993`*^9, {
   3.9412773319842987`*^9, 3.941277347448513*^9}, {3.94127738378421*^9, 
   3.941277390337359*^9}, {3.941277462873249*^9, 3.9412774664006786`*^9}, {
   3.941277517568417*^9, 3.941277550895603*^9}, {3.941277644512869*^9, 
   3.9412776450141945`*^9}, {3.941277708280279*^9, 3.941277739313448*^9}, {
   3.9412777822019587`*^9, 3.9412777836409287`*^9}, {3.9412778330705166`*^9, 
   3.9412778496988926`*^9}, {3.9412778855370407`*^9, 3.941277926128298*^9}, {
   3.941278004470999*^9, 3.941278025613924*^9}, {3.941281938345646*^9, 
   3.9412819970245304`*^9}, {3.9414008956370587`*^9, 3.94140091314942*^9}, 
   3.9415408803097534`*^9},ExpressionUUID->"a27a199f-6b88-9f41-9829-\
fe4911119ee4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["BurstML", "Section",
 CellChangeTimes->{{3.9412174042452183`*^9, 
  3.9412174176937943`*^9}},ExpressionUUID->"4fa8f302-cdd9-a647-81c8-\
6b498f7475ca"],

Cell[CellGroupData[{

Cell["BurstML1", "Subsubsection",
 CellChangeTimes->{{3.90878652974298*^9, 3.908786535601168*^9}, 
   3.9279672147372055`*^9, {3.927968052062945*^9, 3.927968061966584*^9}, {
   3.94121776720718*^9, 
   3.941217787669775*^9}},ExpressionUUID->"39480b57-aa20-b347-b267-\
3d3962b1cb4d"],

Cell[TextData[{
 "BurstML1 uses an isotropic laser spot approximation.  The extracted \
diffusion time ",
 Cell[BoxData[
  FormBox[
   RowBox[{"taud", "=", 
    RowBox[{
     SuperscriptBox["a", "2"], "/", "D", " "}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "08e4aba8-886d-2741-ab7e-cf835cb1ab6b"],
 "needs to be converted to the diffusion time in the elongated laser spot.\n\n\
Input parameters: ",
 StyleBox["bursts",
  FontSlant->"Italic"],
 " -  list of bursts with photon arrival times and colors, ",
 StyleBox["bA",
  FontSlant->"Italic"],
 " and ",
 StyleBox["bD",
  FontSlant->"Italic"],
 " - acceptor  and donor  background count rates, ",
 StyleBox["nTh",
  FontSlant->"Italic"],
 " - threshold number of photons , ",
 StyleBox["tTh",
  FontSlant->"Italic"],
 " - threshold time, ",
 StyleBox["qMax",
  FontSlant->"Italic"],
 " - maximum dimensionless coordinate,",
 StyleBox[" jMax",
  FontSlant->"Italic"],
 " - the number of discrete points."
}], "Text",
 CellChangeTimes->{{3.924956148433134*^9, 3.9249561766411743`*^9}, {
   3.924959164597851*^9, 3.924959174259962*^9}, 3.9250222431085224`*^9, {
   3.927966783247219*^9, 3.927966785271158*^9}, {3.927987493076542*^9, 
   3.9279874981092014`*^9}, {3.930223993860391*^9, 3.930223998968836*^9}, 
   3.9303073742052345`*^9, 3.9303899493667583`*^9, {3.930551479159078*^9, 
   3.930551479254263*^9}, 3.9412168890998936`*^9, {3.9412169535056744`*^9, 
   3.9412169651838856`*^9}, {3.941217171109112*^9, 3.9412173060948696`*^9}, {
   3.941217342022753*^9, 3.9412173857594376`*^9}, {3.941217959157961*^9, 
   3.941218293518112*^9}, {3.9412184460314236`*^9, 3.9412184754956894`*^9}, {
   3.9412185132558517`*^9, 3.941218617240122*^9}, {3.941218652263172*^9, 
   3.941218663784281*^9}, {3.9412194211107426`*^9, 3.9412194403824387`*^9}, {
   3.941278185293604*^9, 3.941278233040186*^9}, {3.941279791718441*^9, 
   3.941280026378235*^9}, {3.9412803488811665`*^9, 3.941280357450285*^9}, {
   3.941281002323265*^9, 
   3.9412810329757214`*^9}},ExpressionUUID->"edbaee63-3696-9f45-b424-\
1c4d0cf019fb"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["matrices1Dyn2st",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[n0List_,eList_,taudList_,kList_,bA_,bD_,qMax_,jMax_] -- \
calculates matrices ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "A"], ",", " ", 
    SubscriptBox["N", "D"], ",", " ", 
    RowBox[{"L", "+", "K", "-", 
     SubscriptBox["N", "A"], "-", 
     SubscriptBox["N", "D"]}], ",", "  ", 
    RowBox[{"and", " ", "vector", " ", 
     SubscriptBox["p", "eq"]}]}], TraditionalForm]],
  FontColor->GrayLevel[0],ExpressionUUID->
  "d755a387-9bbb-0d4b-86d9-5b39d02dc555"],
 " for 2-state system"
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.9030276917840576`*^9, 
   3.903027695901171*^9}, {3.908626365157274*^9, 3.9086263921022034`*^9}, {
   3.90862646003325*^9, 3.9086264603617506`*^9}, {3.908630662202083*^9, 
   3.9086306666686726`*^9}, {3.908630784284457*^9, 3.908630798388486*^9}, {
   3.927967864695147*^9, 3.927967881269949*^9}, {3.927967920510504*^9, 
   3.9279679243493366`*^9}, {3.927968099927215*^9, 3.92796815252367*^9}, {
   3.9279707322104*^9, 3.927970735304434*^9}},
 FontSize->14,ExpressionUUID->"61c67ca1-4f31-b74a-8245-d6fd17708252"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrices1Dyn2st", "[", 
   RowBox[{
   "n0List_", ",", "eList_", ",", "taudList_", ",", "kList_", ",", "bA_", ",",
     "bD_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"June", " ", "21"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", 
      RowBox[{"matrices", " ", 
       SubscriptBox["N", "A"]}]}], ",", " ", 
     SubscriptBox["N", "D"], ",", " ", 
     RowBox[{"L", "+", "K", "-", "N"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "vector", " ", 
       SubscriptBox["p", "eq"], " ", "required", " ", "in", " ", "burstML"}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"diffusing", " ", "molecule", " ", "undergoing", " ", "2"}], 
       "-", 
       RowBox[{
       "state", " ", "transitions", "\n", "isotropic", " ", "spot", " ", 
        "approximation"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"1", " ", "discretized", " ", "coordinate"}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"return", ":", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["N", "A"], ",", 
           SubscriptBox["N", "D"], ",", 
           RowBox[{"L", "+", "K", "-", "N"}], ",", "peq"}], "}"}], "\n", "\n",
          "n0List"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "photon", " ", "count", " ", "rates", " ", 
          "at", " ", "the", " ", "center", " ", "of", " ", "the", " ", 
          "laser", " ", "spot", "\n", "eList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
          RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
           RowBox[{"(", 
            RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], "/", "d1"}], ",", 
             RowBox[{
              RowBox[{"a", "^", "2"}], "/", "d2"}]}], "}"}], " ", "-", " ", 
           RowBox[{"difusion", " ", "times", " ", 
            RowBox[{"(", 
             RowBox[{"a", " ", "-", " ", 
              RowBox[{
              "size", " ", "of", " ", "the", " ", "isotropic", " ", 
               "spot"}]}], ")"}], "\n", "kList"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
            RowBox[{
            "list", " ", "of", " ", "transition", " ", "rates", " ", "1"}]}], 
           "->", 
           RowBox[{
            RowBox[{"2", " ", "and", " ", "2"}], "->", 
            RowBox[{"1", "\n", "bA"}]}]}]}]}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
       RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
       " ", "-", " ", 
       RowBox[{
       "max", " ", "number", " ", "of", " ", "discretized", " ", 
        "points"}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "delta", ",", "q", ",", "lp", ",", "lm", ",", "j", ",", "mNA", ",", 
      "mND", ",", "peq0", ",", "peq", ",", "k1", ",", "k2", ",", "p1", ",", 
      "mK2", ",", "mK", ",", "mL", ",", "mL0", ",", "mP"}], "}"}], ",", 
    "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "=", "kList"}], ";", "\n", 
     RowBox[{"p1", "=", 
      RowBox[{"k2", "/", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}]}]}], ";", "\n", 
     RowBox[{"mK2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "k1"}], ",", "k2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"-", "k2"}]}], "}"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"matrix", " ", "of", " ", "2"}], "-", 
       RowBox[{"state", " ", "transitions"}]}], "*)"}], "\n", "\n", 
     RowBox[{"mK", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"mK2", ",", 
        RowBox[{"IdentityMatrix", "[", "jMax", "]"}]}], "]"}]}], ";", "\n", 
     "\n", 
     RowBox[{"delta", "=", 
      RowBox[{"qMax", "/", "jMax"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"q", "[", "j_", "]"}], "=", 
      RowBox[{"delta", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", 
         RowBox[{"1", "/", "2"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"dimensionless", " ", "coordinate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lp", "[", "j_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"j", "+", 
          RowBox[{"1", "/", "2"}]}], "]"}], "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"matrix", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", "[", "j_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"j", "-", 
          RowBox[{"1", "/", "2"}]}], "]"}], "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", "[", "1", "]"}], "=", "0"}], ";", "\n", 
     RowBox[{
      RowBox[{"lp", "[", "jMax", "]"}], "=", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"reflecting", " ", "bc"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "diffusion", " ", "matrix", " ", "L", " ", "without", " ", "taud", " ", 
       "factor"}], " ", "*)"}], "\n", 
     RowBox[{"mL0", "=", 
      RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "->", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lp", "[", "i", "]"}], "+", 
                RowBox[{"lm", "[", "i", "]"}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lp", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"jMax", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lm", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "jMax"}], "}"}]}], "]"}]}], "}"}], "//",
         "Flatten"}], "\[IndentingNewLine]", "]"}]}], ";", "\n", 
     RowBox[{"mL", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"1", "/", "taudList"}], "]"}], ",", "mL0"}], "]"}]}], ";", 
     "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{"discretized", " ", "point", " ", "spread", " ", "function"}], 
      " ", "*)"}], "\n", 
     RowBox[{"mP", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}], "->", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], "^", "2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "diagonal", " ", "matrix", " ", "NA", " ", "and", " ", "ND", " ", "of", 
       " ", "the", " ", "count", " ", "rates"}], " ", "*)"}], "\n", 
     RowBox[{"mNA", "=", " ", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"n0List", " ", "eList"}], "]"}], ",", "mP"}], "]"}], "+", 
       RowBox[{"bA", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"2", " ", "jMax"}], ",", "SparseArray"}], "]"}]}]}]}], ";", 
     "\n", 
     RowBox[{"mND", "=", " ", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"n0List", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "eList"}], ")"}]}], "]"}], ",", "mP"}], "]"}], 
       "+", 
       RowBox[{"bD", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"2", " ", "jMax"}], ",", "SparseArray"}], "]"}]}]}]}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{"vector", " ", 
       SubscriptBox["p", "eq"]}], "*)"}], "\n", 
     RowBox[{"peq0", "=", 
      RowBox[{"4", " ", "Pi", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "jMax"}], "}"}]}], "]"}]}]}], ";", "\n", 
     RowBox[{"peq", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", 
           RowBox[{"1", "-", "p1"}]}], "}"}], ",", "peq0"}], "]"}], "//", 
       "Flatten"}]}], ";", "\n", "\n", 
     RowBox[{"{", 
      RowBox[{"mNA", ",", "mND", ",", 
       RowBox[{"mL", "+", "mK", "-", "mNA", "-", "mND"}], ",", "peq"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.832865111168004*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.867242428034723*^9, 3.867242492515263*^9}, {3.867242529268175*^9, 
   3.867242560990389*^9}, 3.867242621479858*^9, {3.867242653420859*^9, 
   3.867242669582061*^9}, 3.867243147705471*^9, {3.867243368583119*^9, 
   3.867243383499181*^9}, {3.8672434472304697`*^9, 3.867243447507744*^9}, {
   3.867243495845126*^9, 3.8672435394414787`*^9}, {3.8672437597197824`*^9, 
   3.86724389989441*^9}, {3.867244111226159*^9, 3.867244152016118*^9}, {
   3.867244186852701*^9, 3.86724425254836*^9}, {3.8672443127818813`*^9, 
   3.867244326587611*^9}, {3.8672443689238586`*^9, 3.867244392771106*^9}, 
   3.867244511004591*^9, 3.867249228010229*^9, {3.883071995943559*^9, 
   3.883071998573907*^9}, {3.891600909761977*^9, 3.891601144276834*^9}, 
   3.891601209473031*^9, 3.891601412646661*^9, {3.891609401118507*^9, 
   3.891609422421115*^9}, {3.892546464701019*^9, 3.8925465663859944`*^9}, {
   3.892546625201773*^9, 3.8925467280634203`*^9}, {3.903022350910239*^9, 
   3.9030224198019505`*^9}, {3.9030224640470266`*^9, 3.903022483275598*^9}, {
   3.903022545113713*^9, 3.903022644301353*^9}, {3.903022824030433*^9, 
   3.903022826535358*^9}, {3.903027706278975*^9, 3.903027709831978*^9}, {
   3.908626604401679*^9, 3.9086267251611443`*^9}, {3.9086268200247335`*^9, 
   3.9086269909909062`*^9}, {3.908627164061992*^9, 3.908627169062672*^9}, {
   3.908627272854571*^9, 3.908627375745658*^9}, {3.9086274314802303`*^9, 
   3.908627601041118*^9}, {3.908627657166961*^9, 3.908627744577936*^9}, {
   3.90862777547253*^9, 3.908627787513935*^9}, {3.90862897391687*^9, 
   3.908629097272427*^9}, {3.908629345141813*^9, 3.9086293457457824`*^9}, {
   3.908630683962665*^9, 3.908630687212072*^9}, {3.908631106154132*^9, 
   3.9086311127183285`*^9}, {3.908631671983934*^9, 3.908631682437455*^9}, {
   3.908642646129793*^9, 3.908642648624449*^9}, {3.9086427556427546`*^9, 
   3.908642788253569*^9}, {3.927967884382105*^9, 3.927967929479215*^9}, {
   3.9279790062636204`*^9, 3.927979014761692*^9}, {3.941541289800417*^9, 
   3.9415413645652943`*^9}, {3.941541397878401*^9, 3.941541429769678*^9}, 
   3.9415415137239933`*^9, {3.9415415916069756`*^9, 3.941541657406719*^9}, {
   3.9415416972582417`*^9, 3.941541697741247*^9}, {3.9415430608568935`*^9, 
   3.941543061366886*^9}},ExpressionUUID->"d5f98567-49b2-b144-98e1-\
bf1dd672c95a"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["logLBurstML1Dyn2st",
  FontWeight->"Bold"],
 "[bursts_,{n0List_,eList_,taudList_,kList_},bA_,bD_,nTh_,tTh_,qMax_,jMax_] \
--  log-likelihood of several bursts for given values of photon count rates ",
 StyleBox["n0List",
  FontSlant->"Italic"],
 "={n01,n02}, FRET efficiencies ",
 StyleBox["eList",
  FontSlant->"Italic"],
 "={e1,e2}, diffusion times ",
 StyleBox["taudList",
  FontSlant->"Italic"],
 "={taud1, taud2}, and transition rates ",
 StyleBox["kList",
  FontSlant->"Italic"],
 "={k1,k2}  "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.903085703052754*^9, 3.9030857039156075`*^9}, {
   3.903092367313337*^9, 3.90309237381822*^9}, {3.903106203921193*^9, 
   3.903106251551284*^9}, {3.908645212102399*^9, 3.908645252966163*^9}, {
   3.908645284413948*^9, 3.908645287035169*^9}, {3.927968081822432*^9, 
   3.927968091254717*^9}, 3.927968247516983*^9, {3.94121925118104*^9, 
   3.9412192840542107`*^9}, {3.941280197641508*^9, 3.941280316120655*^9}},
 FontSize->14,ExpressionUUID->"d4031275-63c1-344a-839f-cf6c1d8c414e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logLBurstML1Dyn2st", "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{"n0List_", ",", "eList_", ",", "taudList_", ",", "kList_"}], 
     "}"}], ",", "bA_", ",", "bD_", ",", "nTh_", ",", "tTh_", ",", "qMax_", 
    ",", "jMax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"June", " ", "21"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", 
      RowBox[{"log", "-", 
       RowBox[{
       "likelihood", " ", "of", " ", "many", " ", "bursts", " ", "\n", 
        "diffusing", " ", "molecule", " ", "undergoing", " ", "2"}], "-", 
       RowBox[{
       "state", " ", "transitions", "\n", "isotropic", " ", "laser", " ", 
        "spot", " ", "approximation", "\n", "\n", 
        RowBox[{"return", ":", " ", 
         RowBox[{
          RowBox[{"sum", " ", "of", " ", "log", 
           RowBox[{"(", 
            SubscriptBox["L", "i"], ")"}], " ", "\n", "\n", "bursts"}], " ", 
          "-", " ", 
          RowBox[{"list", " ", "of", " ", "bursts", " ", 
           RowBox[{"{", 
            RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}]}], ",", 
     " ", 
     RowBox[{
     "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
      "arrival", " ", "times", " ", "and", " ", "colors", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "c0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
       "t"}], "=", 
      RowBox[{
       RowBox[{"0", "\n", "n0List"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "photon", " ", "count", " ", "rates", " ", 
          "at", " ", "the", " ", "center", " ", "of", " ", "the", " ", 
          "laser", " ", "spot", "\n", "eList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
          RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
           RowBox[{"(", 
            RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "^", "2"}], "/", "d1"}], ",", 
             RowBox[{
              RowBox[{"a", "^", "2"}], "/", "d2"}]}], "}"}], " ", "-", " ", 
           RowBox[{"difusion", " ", "times", " ", 
            RowBox[{"(", 
             RowBox[{"a", " ", "-", " ", 
              RowBox[{
              "size", " ", "of", " ", "the", " ", "isotropic", " ", 
               "spot"}]}], ")"}], "\n", "kList"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
            RowBox[{
            "list", " ", "of", " ", "transition", " ", "rates", " ", "1"}]}], 
           "->", 
           RowBox[{
            RowBox[{"2", " ", "and", " ", "2"}], "->", 
            RowBox[{"1", "\n", "bA"}]}]}]}]}]}]}]}], ",", " ", 
     RowBox[{"bD", " ", "-", " ", 
      RowBox[{
      "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
       " ", "rates", "\n", "nTh"}], " ", "-", " ", 
      RowBox[{
      "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
       "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
     RowBox[{"N", ">=", 
      RowBox[{
       RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
     "  ", 
     RowBox[{
      RowBox[{"\[Tau]", "<", 
       RowBox[{"tTh", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
       RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
       " ", "-", " ", 
       RowBox[{
       "max", " ", "number", " ", "of", " ", "discretized", " ", 
        "points"}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "norm", ",", "mNATr", ",", "mNDTr", ",", "p0", ",", "px", ",", "\n", 
      "mNA", ",", "mND", ",", "mRate", ",", "peq", ",", "vals", ",", "vecs", 
      ",", "mT", ",", "invT", ",", "valsZero", ",", "zero", ",", "valsOmega", 
      ",", "mM", ",", "valsM", ",", "vecsM", ",", "pin", ",", "pf", ",", "\n",
       "f", ",", "nPh", ",", "phCountRate", ",", "sumLogScale", ",", "scale", 
      ",", "logNorm", ",", "logL1", ",", "nBursts", ",", "logLb", ",", 
      "photonList"}], "}"}], ",", "\[IndentingNewLine]", "\n", 
    RowBox[{"(*", 
     RowBox[{"matrices", ";", " ", 
      RowBox[{"mRate", "=", 
       RowBox[{"L", "+", "K", "-", "NA", "-", "ND"}]}]}], "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mNA", ",", "mND", ",", "mRate", ",", "peq"}], "}"}], "=", 
      RowBox[{"matrices1Dyn2st", "[", 
       RowBox[{
       "n0List", ",", "eList", ",", "taudList", ",", "kList", ",", "bA", ",", 
        "bD", ",", "qMax", ",", "jMax"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", " ", 
        "mRate"}], "=", 
       RowBox[{"L", "+", "K", "-", "N"}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mRate", "]"}]}], ";", "\n", 
     RowBox[{"mT", "=", 
      RowBox[{"vecs", "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"invT", "=", 
      RowBox[{"Inverse", "[", "mT", "]"}]}], ";", 
     RowBox[{"(*", 
      SuperscriptBox["T", 
       RowBox[{"-", "1"}]], "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"matrix", " ", "M"}], " ", "*)"}], "\n", 
     RowBox[{"valsZero", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"vals", ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "zero"}], ",", "1"}], "]"}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"replace", " ", "eigenvalue"}], "=", 
       RowBox[{"0", " ", "by", " ", "zero"}]}], " ", "*)"}], "\n", 
     RowBox[{"valsOmega", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"vals", " ", "tTh"}], "]"}], "-", "1"}], ")"}], "/", 
         "valsZero"}], ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "tTh"}], ",", "1"}], "]"}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{
      "diagonal", " ", "elements", " ", "of", " ", "matrix", " ", 
       "\[CapitalOmega]"}], "*)"}], "\n", 
     RowBox[{"mM", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mNA", "+", "mND"}], ")"}], ".", "mT", ".", 
       RowBox[{"DiagonalMatrix", "[", "valsOmega", "]"}], ".", "invT"}]}], 
     ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", " ", 
       "matrix", " ", "M"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valsM", ",", "vecsM"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mM", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"initial", " ", "and", " ", "final", " ", "vectors"}], "*)"}], 
     "\n", 
     RowBox[{"pin", "=", 
      RowBox[{"mT", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", "invT", ".", 
       "peq"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"vector", " ", 
       SubscriptBox["p", "in"]}], " ", "*)"}], "\n", 
     RowBox[{"pf", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"2", " ", "jMax"}]}], "]"}], ".", "mT", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", "invT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"final", " ", "vector", " ", 
        SuperscriptBox[
         SubscriptBox["p", "f"], "T"]}], " ", ";", " ", 
       RowBox[{"dimension", " ", "of", " ", 
        SuperscriptBox["1", "T"], " ", "is", " ", "2", "*", "jMax"}]}], " ", 
      "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"normalization", " ", "factor", " ", "Z"}], "*)"}], "\n", 
     RowBox[{"norm", "=", 
      RowBox[{"pf", ".", 
       RowBox[{"vecsM", "\[Transpose]"}], ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"valsM", "^", 
          RowBox[{"(", 
           RowBox[{"nTh", "-", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "valsM"}], ")"}]}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"vecsM", "\[Transpose]"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"mNA", "+", "mND"}], ")"}], ".", "pin"}]}], ";", "\n", 
     RowBox[{"logNorm", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MachineNumberQ", "[", "norm", "]"}], "&&", 
         RowBox[{"norm", ">", "0"}]}], ",", 
        RowBox[{"Log", "[", "norm", "]"}], ",", "0"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"add", " ", "check", " ", "04.13", ".22"}], " ", "*)"}], "\n", 
     "\n", 
     RowBox[{"mNATr", "=", 
      RowBox[{"invT", ".", "mNA", ".", "mT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"transformed", " ", "count", " ", "rate", " ", "matrix"}], 
      "*)"}], "\n", 
     RowBox[{"mNDTr", "=", 
      RowBox[{"invT", ".", "mND", ".", "mT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"transformed", " ", "count", " ", "rate", " ", "matrix"}], 
      "*)"}], "\n", "\n", 
     RowBox[{"p0", "=", 
      RowBox[{"invT", ".", "pin"}]}], ";", "\n", 
     RowBox[{"px", "=", 
      RowBox[{"pf", ".", "mT"}]}], ";", "\n", "\n", 
     RowBox[{"nBursts", "=", 
      RowBox[{"Length", "[", "bursts", "]"}]}], ";", "\n", 
     RowBox[{"logLb", "=", "0"}], ";", "\n", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{"(*", 
       RowBox[{"cycle", " ", "over", " ", "bursts"}], "*)"}], "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "log", " ", "likelihood", " ", "function", " ", "for", " ", "one", " ",
         "burst"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"photonList", "=", 
         RowBox[{"bursts", "[", 
          RowBox[{"[", "ib", "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "list", " ", "of", " ", "photons", " ", "in", " ", "burst", " ", 
          "ib"}], "*)"}], "\n", 
        RowBox[{"nPh", "=", 
         RowBox[{"Length", "[", "photonList", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "number", " ", "of", " ", "photons", " ", "in", " ", "a", " ", 
          "burst"}], "*)"}], "\n", "\n", 
        RowBox[{"phCountRate", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"photonList", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "==", "\"\<a\>\""}], ",",
            "mNATr", ",", "mNDTr"}], "]"}]}], ";", "\n", 
        RowBox[{"f", "=", 
         RowBox[{"phCountRate", ".", "p0"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"initial", " ", "vector", " ", 
          SuperscriptBox["\[CapitalPhi]T", 
           RowBox[{"-", "1"}]], 
          SubscriptBox["p", "in"]}], "  ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sumLogScale", "=", "0"}], ";", "\n", 
        RowBox[{"logL1", "=", "0"}], ";", "\n", "\t", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", " ", 
          RowBox[{"cycle", " ", "over", " ", "photons"}], " ", "*)"}], "\n", 
         "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"phCountRate", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"photonList", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "==", 
               "\"\<a\>\""}], ",", "mNATr", ",", "mNDTr"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"f", "=", 
            RowBox[{"phCountRate", ".", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"Exp", "[", 
               RowBox[{"vals", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"photonList", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"photonList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], " ", 
               "]"}], "]"}], ".", "f"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"scale", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"px", ".", "f"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"scaling", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"scale", "!=", "0"}], ",", 
             RowBox[{
              RowBox[{"f", "=", 
               RowBox[{"f", "/", "scale"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{
               "divide", " ", "by", " ", "the", " ", "scaling", " ", 
                "factor"}], "*)"}], "\n", "\t\t\t", 
              RowBox[{"sumLogScale", "=", 
               RowBox[{"sumLogScale", "+", 
                RowBox[{"Log", "[", "scale", "]"}]}]}]}]}], 
            RowBox[{"(*", 
             RowBox[{
             "collect", " ", "Log", " ", "of", " ", "the", " ", "scaling", 
              " ", "factor"}], "*)"}], "\n", "\t\t\t", "]"}]}], ",", "\n", 
          "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nPh", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        "\n", "\t", 
        RowBox[{"logL1", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"px", ".", "f"}], "==", "0"}], ",", 
           RowBox[{"-", "100000"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"px", ".", "f"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"logL", " ", "for", " ", "1", " ", "burst"}], "*)"}], "\n", 
        "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "correction", " ", "for", " ", "scaling", " ", "factor", " ", "and", 
          " ", 
          RowBox[{"normalization", ":", "  ", 
           RowBox[{
            RowBox[{"log", 
             RowBox[{"(", "L", ")"}]}], "+", 
            RowBox[{"log", 
             RowBox[{"(", 
              RowBox[{"scaling", " ", "factor"}], ")"}]}], "-", 
            RowBox[{"log", 
             RowBox[{"(", "Z", ")"}]}]}]}]}], "*)"}], "\n", "\t", 
        RowBox[{"logLb", "=", 
         RowBox[{
         "logLb", "+", "logL1", "+", "sumLogScale", "-", "logNorm"}]}]}], ",",
        "\n", "\n", 
       RowBox[{"{", 
        RowBox[{"ib", ",", "nBursts"}], "}"}]}], "]"}], ";", "\n", 
     "\[IndentingNewLine]", "logLb"}]}], "\n", "\n", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.832865111168004*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.8817536609745293`*^9, 3.881753665884922*^9}, {3.881754111701235*^9, 
   3.881754114606411*^9}, {3.881754158274505*^9, 3.881754246371973*^9}, 
   3.881754282931633*^9, 3.881754435531208*^9, 3.881755060054158*^9, {
   3.88175510950613*^9, 3.88175511092774*^9}, {3.881755188831781*^9, 
   3.881755189987852*^9}, {3.891604924448641*^9, 3.891604963537817*^9}, {
   3.8916066427386713`*^9, 3.8916067613400383`*^9}, {3.891606802129243*^9, 
   3.891606831201118*^9}, {3.89160686303356*^9, 3.891606871984393*^9}, {
   3.8916069639905777`*^9, 3.891607015362647*^9}, {3.8916070534642363`*^9, 
   3.891607149655608*^9}, {3.891607300692747*^9, 3.891607496834026*^9}, {
   3.891607585977884*^9, 3.891607650439767*^9}, {3.891607861954728*^9, 
   3.891607922151191*^9}, {3.891608313798629*^9, 3.891608333001147*^9}, {
   3.891608411302081*^9, 3.891608456651452*^9}, {3.891608496399453*^9, 
   3.891608496981966*^9}, {3.891608574153823*^9, 3.891608620367091*^9}, {
   3.891608668913911*^9, 3.891608681468054*^9}, {3.8916087161310987`*^9, 
   3.891608716281272*^9}, {3.8916088337434*^9, 3.891608835065474*^9}, {
   3.891608897079547*^9, 3.891608917092875*^9}, {3.891608957405655*^9, 
   3.891608980597269*^9}, {3.891609449600166*^9, 3.8916094705229397`*^9}, {
   3.8916802083275*^9, 3.8916802144265113`*^9}, {3.891680288063319*^9, 
   3.8916803055762*^9}, {3.8916803483638935`*^9, 3.8916803872583227`*^9}, {
   3.891680421122983*^9, 3.8916804267809143`*^9}, {3.891680458439831*^9, 
   3.891680459188297*^9}, {3.891967957893177*^9, 3.891968014364689*^9}, {
   3.891968071661301*^9, 3.8919681177098*^9}, {3.891968199133696*^9, 
   3.891968220901428*^9}, {3.892034275190954*^9, 3.8920342841057577`*^9}, 
   3.892545439021497*^9, {3.892546957627385*^9, 3.892547111385839*^9}, {
   3.892547149346948*^9, 3.892547284099257*^9}, {3.892547318280584*^9, 
   3.892547403182469*^9}, 3.892551792732707*^9, {3.892552436559166*^9, 
   3.892552482740876*^9}, {3.8925525428088937`*^9, 3.89255254369983*^9}, {
   3.892552578024344*^9, 3.8925525829244585`*^9}, {3.892552674162599*^9, 
   3.892552678154328*^9}, {3.9030280735634303`*^9, 3.903028281545851*^9}, {
   3.903028312542508*^9, 3.903028330373417*^9}, {3.9030283709003057`*^9, 
   3.9030283872998714`*^9}, {3.903028424120635*^9, 3.9030284405146685`*^9}, {
   3.9030285477040615`*^9, 3.903028549152386*^9}, 3.903028650667278*^9, {
   3.903083716987355*^9, 3.903083728991003*^9}, {3.903083967585611*^9, 
   3.9030839983297024`*^9}, {3.903084058086784*^9, 3.9030842277961206`*^9}, {
   3.903084358295407*^9, 3.9030843953737097`*^9}, {3.903084576647337*^9, 
   3.903084607648675*^9}, {3.903084654231759*^9, 3.9030846655442*^9}, {
   3.90308479539712*^9, 3.903084835978813*^9}, {3.9030848737127275`*^9, 
   3.903084955892508*^9}, {3.903085027931687*^9, 3.9030850284062166`*^9}, {
   3.9030851118887997`*^9, 3.903085141003768*^9}, {3.903085184931961*^9, 
   3.9030852168289022`*^9}, {3.90308526114161*^9, 3.9030853063151765`*^9}, {
   3.903085382130137*^9, 3.903085449505763*^9}, 3.903092650241167*^9, {
   3.903093160591522*^9, 3.903093180490673*^9}, 3.903093508209564*^9, 
   3.903093538725197*^9, {3.903106270551739*^9, 3.903106295291989*^9}, {
   3.903106332332185*^9, 3.9031063737631044`*^9}, {3.903106497451285*^9, 
   3.903106541359148*^9}, {3.903106632600363*^9, 3.9031066824591417`*^9}, {
   3.90311072404474*^9, 3.903110755880736*^9}, {3.903110818356362*^9, 
   3.903110834016085*^9}, {3.903110865785652*^9, 3.903110890230331*^9}, {
   3.903110923477373*^9, 3.90311092408607*^9}, {3.903111033702235*^9, 
   3.903111048551852*^9}, {3.903111083439268*^9, 3.903111099802769*^9}, {
   3.903111176504059*^9, 3.903111192664581*^9}, {3.903111240826522*^9, 
   3.903111260192346*^9}, 3.903111294508422*^9, 3.903111328748782*^9, {
   3.90311136250304*^9, 3.903111661904165*^9}, {3.903111698791114*^9, 
   3.903111752440998*^9}, {3.903111818276016*^9, 3.903111825034886*^9}, {
   3.903111856913656*^9, 3.903111872724266*^9}, {3.903111917615101*^9, 
   3.903111933421941*^9}, {3.903112007425363*^9, 3.903112051620674*^9}, {
   3.9031121098998938`*^9, 3.903112116236845*^9}, {3.9031125928985586`*^9, 
   3.903112602221198*^9}, 3.90311263812506*^9, {3.903112693064061*^9, 
   3.903112750606581*^9}, {3.903112797434248*^9, 3.903112838936903*^9}, {
   3.903112913095911*^9, 3.903112945026767*^9}, 3.903113008636104*^9, {
   3.903113156052796*^9, 3.903113165091595*^9}, 3.903113202883348*^9, 
   3.903113241001408*^9, {3.903113313905912*^9, 3.903113317514427*^9}, {
   3.90311336540439*^9, 3.903113417881259*^9}, {3.903113451128827*^9, 
   3.9031136384351435`*^9}, {3.9031137352560472`*^9, 3.903113742614521*^9}, {
   3.9031138427934*^9, 3.903113940541367*^9}, {3.903114011662487*^9, 
   3.903114073463874*^9}, {3.903114106821878*^9, 3.903114109408348*^9}, {
   3.903114330604081*^9, 3.903114417006131*^9}, {3.903114459906883*^9, 
   3.903114460690933*^9}, {3.903114506008356*^9, 3.903114506694095*^9}, {
   3.903159054505543*^9, 3.903159096456961*^9}, {3.903159139299298*^9, 
   3.9031591454707284`*^9}, {3.903159189209704*^9, 3.903159192923818*^9}, {
   3.903159229493097*^9, 3.9031592545348873`*^9}, {3.903159334474206*^9, 
   3.903159373820154*^9}, {3.903159419768257*^9, 3.9031594598009415`*^9}, {
   3.903159510867168*^9, 3.903159528957415*^9}, {3.903159808251084*^9, 
   3.9031598103889017`*^9}, {3.903159933176066*^9, 3.903159935640829*^9}, {
   3.903160038084881*^9, 3.90316010679628*^9}, 3.903160445418431*^9, {
   3.903849848493254*^9, 3.903849854869611*^9}, {3.90384991264387*^9, 
   3.903849939416622*^9}, {3.903849993531925*^9, 3.903850002723717*^9}, {
   3.9038500754311743`*^9, 3.903850113234015*^9}, {3.90385033209863*^9, 
   3.903850334990127*^9}, {3.903850580250118*^9, 3.9038506088922453`*^9}, {
   3.903850669069582*^9, 3.903850811699582*^9}, {3.903850847517099*^9, 
   3.903850861127475*^9}, {3.903851263073879*^9, 3.903851294939004*^9}, {
   3.9038514600709095`*^9, 3.903851460749038*^9}, {3.9086919201272106`*^9, 
   3.908692058207471*^9}, {3.908692151312504*^9, 3.90869220227135*^9}, {
   3.908692719711443*^9, 3.908692735064868*^9}, {3.90869278818196*^9, 
   3.9086927909700203`*^9}, {3.908692824635268*^9, 3.9086929499449797`*^9}, {
   3.908692981235665*^9, 3.908693051405619*^9}, {3.9086930904578466`*^9, 
   3.9086931851733193`*^9}, {3.908693218440832*^9, 3.908693246788533*^9}, {
   3.9086932991079693`*^9, 3.908693314085763*^9}, {3.908693360998504*^9, 
   3.9086934044543715`*^9}, {3.908693895232538*^9, 3.90869390944502*^9}, {
   3.908693944925085*^9, 3.90869395849446*^9}, {3.908694034621347*^9, 
   3.908694042329752*^9}, {3.908694102916795*^9, 3.908694190366278*^9}, {
   3.9086942893885326`*^9, 3.90869443059972*^9}, {3.908695319628203*^9, 
   3.908695351308443*^9}, {3.908695449620698*^9, 3.908695468254731*^9}, {
   3.908695506607944*^9, 3.908695524089528*^9}, {3.908695567307827*^9, 
   3.908695603930901*^9}, {3.9086957141605525`*^9, 3.908695723026941*^9}, {
   3.908696077788667*^9, 3.908696119249095*^9}, {3.9086962218218975`*^9, 
   3.9086962228444915`*^9}, {3.9086964369425545`*^9, 3.908696437280325*^9}, {
   3.92796817406946*^9, 3.927968251897569*^9}, {3.927970761621937*^9, 
   3.927970763240974*^9}, {3.941541502546631*^9, 3.9415415494631176`*^9}, {
   3.9415416669701023`*^9, 3.9415416764635563`*^9}, {3.9415417132981663`*^9, 
   3.941541758265194*^9}, 3.9415432214744473`*^9},
 FontFamily->
  "Consolas",ExpressionUUID->"8935ffa4-a9c8-9b43-9fa8-7297fc43d643"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["findMaxLBurstML1Dyn2st",
  FontWeight->"Bold"],
 "[bursts_,{n0IniList_,eIniList_,taudIniList_,kIniList_},bA_,bD_,nTh_,tTh_,\
qMax_,jMax_] -- finds  burstML1 parameters \
{{n01,n02},{e1,e2},{taud1,taud2},{k1,k2}} starting  from the  initial values  \
",
 StyleBox[" ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["n0IniList",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["n01", "ini"], ",", 
       SubscriptBox["n02", "ini"]}], "}"}]}], ",", " ", 
    RowBox[{
     StyleBox["eIniList",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["e1", "ini"], ",", 
       SubscriptBox["e2", "ini"]}], "}"}]}], ",", 
    StyleBox[" ",
     FontSlant->"Italic"], 
    RowBox[{
     StyleBox["taudIniList",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["taud1", "ini"], ",", 
       SubscriptBox["taud2", "ini"]}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", 
      StyleBox["kIniList",
       FontSlant->"Italic"]}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["k1", "ini"], ",", 
        SubscriptBox["k2", "ini"]}], "}"}], "."}]}]}], TraditionalForm]],
  ExpressionUUID->"a09f1ad0-9708-e446-8edf-00e24cff0a12"]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.903085703052754*^9, 3.9030857039156075`*^9}, {
   3.903092367313337*^9, 3.90309237381822*^9}, {3.903106203921193*^9, 
   3.903106251551284*^9}, {3.9031605061767006`*^9, 3.903160509306374*^9}, {
   3.90316221172743*^9, 3.903162240477569*^9}, {3.9031746832821255`*^9, 
   3.903174691620724*^9}, {3.903431747146159*^9, 3.903431747650889*^9}, {
   3.908645229506664*^9, 3.908645231474288*^9}, 3.9086452626033115`*^9, {
   3.90864529963472*^9, 3.908645303757294*^9}, 3.908694608694626*^9, {
   3.90878150055*^9, 3.908781504303315*^9}, {3.908781580178921*^9, 
   3.908781580701618*^9}, {3.908782001124877*^9, 3.9087820017122498`*^9}, {
   3.919333292552164*^9, 3.9193332971294556`*^9}, 3.927968267839449*^9, 
   3.941218378575247*^9, {3.941219302136103*^9, 3.941219320551531*^9}, {
   3.9412783057590504`*^9, 3.941278306289005*^9}, {3.941280443121523*^9, 
   3.941280470651989*^9}, {3.9412805013522835`*^9, 3.9412805172878056`*^9}, {
   3.9412805868451805`*^9, 3.941280724313295*^9}, {3.941281595336441*^9, 
   3.9412816192560863`*^9}},
 FontSize->14,ExpressionUUID->"7dc6f988-afd2-bf40-9daa-8b00fd139e70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"findMaxL", 
     StyleBox["BurstML1Dyn2st",
      FontWeight->"Bold"]}]], "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{
     "n0IniList_", ",", "eIniList_", ",", "taudIniList_", ",", "kIniList_"}], 
     "}"}], ",", "bA_", ",", "bD_", ",", "nTh_", ",", "tTh_", ",", "qMax_", 
    ",", "jMax_"}], "]"}], ":=", "\n", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"June", " ", "21"}], ",", " ", 
    RowBox[{
     RowBox[{
     "2024", "\n", "finds", " ", "Max", " ", "Likelihood", " ", "parameters", 
      "  ", "from", " ", "photon", " ", "bursts", "  ", "emitted", " ", "by", 
      " ", "a", " ", "diffusing", " ", "molecule", " ", "undergoing", " ", 
      "2"}], "-", 
     RowBox[{
     "state", " ", "transitions", "\n", "isotropic", " ", "laser", " ", 
      "spot", " ", "approximation", "\n", "\n", "returns", " ", "ML", " ", 
      "parameters", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n01ML", ",", "n02ML"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"e1ML", ",", "e2ML"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"taud1ML", ",", "taud2ML"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1ML", ",", "k2ML"}], "}"}]}], "}"}], "\n", "\n", 
      "bursts"}], " ", "-", " ", 
     RowBox[{"list", " ", "of", " ", "bursts", " ", 
      RowBox[{"{", 
       RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}], ",", " ", 
    RowBox[{
    "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
     "arrival", " ", "times", " ", "and", " ", "colors", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "c0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
      "t"}], "=", 
     RowBox[{
      RowBox[{"0", "\n", "n0IniList"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["n01", "ini"], ",", 
          SubscriptBox["n02", "ini"]}], "}"}], " ", "-", " ", 
        RowBox[{
        "list", " ", "of", " ", "initial", " ", "photon", " ", "count", " ", 
         "rates", " ", "at", " ", "the", " ", "center", " ", "of", " ", "the",
          " ", "laser", " ", "spot", "\n", "eIniList"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["e1", "ini"], ",", 
           SubscriptBox["e2", "ini"]}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "initial", " ", "FRET", " ", "efficiencies", 
          " ", 
          RowBox[{"(", 
           RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["taud1", "ini"], ",", 
            SubscriptBox["taud2", "ini"]}], "}"}], " ", "-", " ", 
          RowBox[{
          "list", " ", "of", " ", "initial", " ", "difusion", " ", "times", 
           " ", 
           RowBox[{"(", 
            RowBox[{"a", " ", "-", " ", 
             RowBox[{
             "size", " ", "of", " ", "the", " ", "isotropic", " ", "spot"}]}],
             ")"}], "\n", "kIniList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["k1", "ini"], ",", 
             SubscriptBox["k2", "ini"]}], "}"}], " ", "-", " ", 
           RowBox[{
           "list", " ", "of", " ", "initial", " ", "transition", " ", "rates",
             " ", "1"}]}], "->", 
          RowBox[{
           RowBox[{"2", " ", "and", " ", "2"}], "->", 
           RowBox[{"1", "\n", "bA"}]}]}]}]}]}]}]}], ",", " ", 
    RowBox[{"bD", " ", "-", " ", 
     RowBox[{
     "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
      " ", "rates", "\n", "nTh"}], " ", "-", " ", 
     RowBox[{
     "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
      "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
    RowBox[{"N", ">=", 
     RowBox[{
      RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
      RowBox[{"threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}],
     ",", "  ", 
    RowBox[{
     RowBox[{"\[Tau]", "<", 
      RowBox[{"tTh", "\n", "qMax"}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
      RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], " ",
       "-", " ", 
      RowBox[{
      "max", " ", "number", " ", "of", " ", "discretized", " ", 
       "points"}]}]}]}], "\n", "*)"}], "\n", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iniGuess", ",", "pars", ",", "parsGuess", ",", "xn01", ",", "xn02", ",",
       "xe1", ",", "xe2", ",", "xtaud1", ",", "xtaud2", ",", "xk1", ",", 
      "xk2", ",", "sol", ",", "ff", ",", "result"}], "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"pars", "=", 
      RowBox[{"{", 
       RowBox[{
       "xn01", ",", "xn02", ",", "xe1", ",", "xe2", ",", "xtaud1", ",", 
        "xtaud2", ",", "xk1", ",", "xk2"}], "}"}]}], ";", 
     RowBox[{"(*", " ", "parameters", "*)"}], "\n", "\n", 
     RowBox[{"iniGuess", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"n0IniList", ",", 
          RowBox[{
           RowBox[{"1", "/", "eIniList"}], "-", "1"}], ",", "taudIniList", 
          ",", "kIniList"}], "}"}], "]"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"parsGuess", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pars", ",", "iniGuess"}], "}"}], "\[Transpose]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"list", " ", "of", " ", 
       RowBox[{"{", 
        RowBox[{"var_i", ",", "guess_i"}], "}"}]}], " ", "*)"}], "\n", "\n", 
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{
       "xn01_Real", ",", "xn02_Real", ",", "xe1_Real", ",", "xe2_Real", ",", 
        "xtaud1_Real", ",", "xtaud2_Real", ",", "xk1_Real", ",", "xk2_Real"}],
        "]"}], " ", ":=", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"it", "'"}], "s", " ", "important", " ", "to", " ", "have", 
        " ", "_Real", " ", "to", " ", "prevent", " ", "analytical", " ", 
        "evaluation"}], " ", "*)"}], "\n", 
      RowBox[{
       StyleBox["logLBurstML1Dyn2st",
        FontWeight->"Bold"], "[", 
       RowBox[{"bursts", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"xn01", ",", "xn02"}], "}"}], "]"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"{", 
               RowBox[{"xe1", ",", "xe2"}], "}"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], "]"}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"xk1", ",", "xk2"}], "}"}], "]"}]}], "}"}], ",", "bA", 
        ",", "bD", ",", "nTh", ",", "tTh", ",", "qMax", ",", "jMax"}], 
       "]"}]}], ";", "\n", " ", "\n", 
     RowBox[{"sol", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", "=", "0"}], "}"}], ",", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"FindMaximum", "[", 
           RowBox[{
            RowBox[{"ff", "@@", "pars"}], ",", "parsGuess", ",", 
            RowBox[{"AccuracyGoal", "->", "4"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "4"}], ",", "\n", "\t", 
            RowBox[{"StepMonitor", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"c", "++"}], 
              RowBox[{"(*", 
               RowBox[{";", "   ", 
                RowBox[{"Print", "[", 
                 RowBox[{"Now", ",", "\"\< c= \>\"", ",", "c"}], "]"}]}], 
               "*)"}], " ", ")"}]}]}], "\n", "\t       ", "]"}], ",", " ", 
          "c"}], "  ", "}"}]}], "]"}]}], ";", "\n", " ", "\n", " ", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"{", 
           RowBox[{"xn01", ",", "xn02"}], "}"}], "]"}], ",", " ", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"{", 
              RowBox[{"xe1", ",", "xe2"}], "}"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"{", 
           RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], "]"}], ",", " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"{", 
           RowBox[{"xk1", ",", "xk2"}], "}"}], "]"}]}], "}"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", "\n", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  LogLikelihood= \>\"", ",", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<   steps=\>\"", ",",
        " ", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<  (\!\(\*SubscriptBox[\(n\), \
\(0\)]\),e,\!\(\*SubscriptBox[\(\[Tau]\), \(d\)]\),k) = \>\"", ",", 
       "result"}], "]"}], ";", "\n", "result"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.433174731898714*^9, 3.4331748017758*^9}, 
   3.4331748502146606`*^9, {3.4331752268899417`*^9, 3.433175389285827*^9}, {
   3.433175426750022*^9, 3.433175578497192*^9}, {3.433175613711659*^9, 
   3.43317563175634*^9}, {3.433175985641314*^9, 3.433175989453423*^9}, {
   3.433176065773733*^9, 3.4331760725542884`*^9}, {3.433177858350347*^9, 
   3.4331779858693542`*^9}, 3.4331781434792223`*^9, {3.433178191037156*^9, 
   3.433178203457838*^9}, 3.433178378175439*^9, 3.433179517687674*^9, 
   3.4331824504290185`*^9, 3.4331824898319902`*^9, {3.4331827796672487`*^9, 
   3.433182785229286*^9}, 3.433182912437452*^9, {3.433182971729393*^9, 
   3.433182994985692*^9}, {3.4331831912347164`*^9, 3.4331831926726675`*^9}, {
   3.433183363438343*^9, 3.433183366532291*^9}, {3.433243912803263*^9, 
   3.4332439185223074`*^9}, {3.433243956664883*^9, 3.43324402112131*^9}, {
   3.433244061467126*^9, 3.433244222938886*^9}, {3.433247903739778*^9, 
   3.4332484822113533`*^9}, {3.4332485763323245`*^9, 3.433248646912972*^9}, {
   3.433248734209266*^9, 3.433248784340585*^9}, {3.433248860844732*^9, 
   3.433248994562719*^9}, {3.4332490745311947`*^9, 3.433249075765807*^9}, 
   3.4332495161464424`*^9, {3.433250184167661*^9, 3.4332502012153006`*^9}, {
   3.433250233201108*^9, 3.433250263420065*^9}, {3.4332509179493504`*^9, 
   3.4332509873507137`*^9}, {3.433251027667939*^9, 3.433251033277996*^9}, {
   3.433251152620631*^9, 3.433251153245707*^9}, {3.4332512183317456`*^9, 
   3.4332512702443075`*^9}, {3.433251641590469*^9, 3.433251665870942*^9}, {
   3.4332519264556203`*^9, 3.4332519287055054`*^9}, {3.433252491669583*^9, 
   3.4332525428261604`*^9}, {3.433259474469654*^9, 3.4332594779070663`*^9}, {
   3.4332596962921*^9, 3.433259700073253*^9}, {3.433259758899873*^9, 
   3.433259762102916*^9}, {3.433259851163135*^9, 3.433259863069081*^9}, {
   3.433259988565868*^9, 3.433260104078536*^9}, {3.4332604765415144`*^9, 
   3.433260479385537*^9}, {3.433260513043297*^9, 3.433260516184004*^9}, {
   3.433260623983638*^9, 3.433260627343099*^9}, 3.4332606819851227`*^9, 
   3.4332607192985783`*^9, {3.433260896549661*^9, 3.433260900893384*^9}, {
   3.433260958236767*^9, 3.433260965814843*^9}, {3.4332609985333843`*^9, 
   3.43326100072087*^9}, {3.43326110907942*^9, 3.433261114876221*^9}, 
   3.4332612352028065`*^9, {3.433261368763597*^9, 3.4332613876071053`*^9}, {
   3.4332616536505747`*^9, 3.433261721446372*^9}, {3.4332619185050883`*^9, 
   3.433261942738998*^9}, {3.433262015768846*^9, 3.4332620808925953`*^9}, {
   3.4332621422039185`*^9, 3.4332621449069915`*^9}, {3.4332622016715264`*^9, 
   3.433262209499501*^9}, {3.433262528868369*^9, 3.433262546164912*^9}, {
   3.433262599429514*^9, 3.433262615101088*^9}, 3.4332626591939917`*^9, {
   3.433265210083069*^9, 3.433265212489319*^9}, {3.433413659175805*^9, 
   3.433413718971788*^9}, {3.433413767781973*^9, 3.433413773289893*^9}, {
   3.4334139217033*^9, 3.43341393064616*^9}, {3.433413993927153*^9, 
   3.433414001447968*^9}, {3.43341407794797*^9, 3.433414111085619*^9}, {
   3.443003228231954*^9, 3.443003232488072*^9}, {3.443003263252309*^9, 
   3.443003357147323*^9}, {3.443003400599805*^9, 3.443003433036446*^9}, {
   3.44300348111558*^9, 3.443003538177635*^9}, {3.4430036156991024`*^9, 
   3.4430037081520452`*^9}, {3.443003741960658*^9, 3.443003894179538*^9}, 
   3.443003968816861*^9, {3.443004013320854*^9, 3.4430040565930786`*^9}, {
   3.4430041005763216`*^9, 3.443004355733219*^9}, {3.44300439620141*^9, 
   3.443004418773867*^9}, {3.443006271347739*^9, 3.443006281292037*^9}, {
   3.44303528461677*^9, 3.443035372032467*^9}, {3.4430354113089437`*^9, 
   3.4430354869076495`*^9}, {3.443035824032411*^9, 3.443035862247364*^9}, {
   3.443203204508971*^9, 3.4432032234916453`*^9}, {3.443203265066045*^9, 
   3.443203276002565*^9}, {3.443203311858727*^9, 3.443203317061386*^9}, {
   3.443267775018227*^9, 3.443267868873184*^9}, {3.4432683246485567`*^9, 
   3.443268449407953*^9}, {3.443268483667214*^9, 3.443268639481264*^9}, {
   3.443268698986829*^9, 3.443268846528984*^9}, {3.4432688814592113`*^9, 
   3.443268909599675*^9}, {3.443269020669386*^9, 3.443269032356191*^9}, {
   3.44326918958227*^9, 3.443269223601187*^9}, 3.443269264329752*^9, {
   3.443269299530368*^9, 3.4432692997106276`*^9}, {3.4432695569405055`*^9, 
   3.4432697116930285`*^9}, {3.443269768034044*^9, 3.443270100742455*^9}, {
   3.443270130995957*^9, 3.4432701374452305`*^9}, {3.443270425219028*^9, 
   3.443270438007418*^9}, {3.4432711692088337`*^9, 3.443271172743917*^9}, {
   3.443271357149079*^9, 3.443271360644104*^9}, {3.443271473977069*^9, 
   3.443271483781166*^9}, {3.443271547853299*^9, 3.443271550016408*^9}, {
   3.443271607218661*^9, 3.443271607589194*^9}, 3.4432716662235055`*^9, {
   3.4432717842632384`*^9, 3.4432718136054306`*^9}, {3.44327185209077*^9, 
   3.443271938044365*^9}, {3.443272011039327*^9, 3.443272012841919*^9}, {
   3.443273603318912*^9, 3.443273618801174*^9}, {3.44327459219084*^9, 
   3.4432745923711*^9}, {3.443306840428389*^9, 3.443306840859008*^9}, {
   3.4433069377883854`*^9, 3.443306940281971*^9}, {3.443310493971927*^9, 
   3.443310507972062*^9}, {3.443371422729501*^9, 3.443371427401286*^9}, {
   3.4433786470688753`*^9, 3.443378704739643*^9}, {3.443379063123388*^9, 
   3.4433791199347963`*^9}, {3.443448210761333*^9, 3.443448213084674*^9}, {
   3.4437852250745025`*^9, 3.4437852607157516`*^9}, {3.444009842443077*^9, 
   3.444010181791035*^9}, {3.444010527608296*^9, 3.444010536200651*^9}, {
   3.444010656022948*^9, 3.444010658997224*^9}, 3.444010946009928*^9, {
   3.444036149040715*^9, 3.444036362848155*^9}, 3.4440364509548464`*^9, {
   3.4440364964102077`*^9, 3.4440365268840275`*^9}, {3.444036597395419*^9, 
   3.444036597675821*^9}, {3.4440366811057873`*^9, 3.4440366847410145`*^9}, 
   3.444037233650307*^9, {3.444037698388568*^9, 3.444037771083098*^9}, {
   3.444037978851855*^9, 3.4440380538897533`*^9}, 3.444038240818544*^9, {
   3.44424034572138*^9, 3.444240451613644*^9}, {3.4442404848514385`*^9, 
   3.4442405194211473`*^9}, {3.444240571516056*^9, 3.4442406467842865`*^9}, {
   3.444240687623009*^9, 3.44424075155494*^9}, 3.4442408256915426`*^9, 
   3.444242353608579*^9, {3.4442423869164734`*^9, 3.444242388568847*^9}, {
   3.444242926372173*^9, 3.444242964517022*^9}, {3.444243792006894*^9, 
   3.444243793599184*^9}, {3.4442438650919857`*^9, 3.444243865282259*^9}, {
   3.444245668495152*^9, 3.444245685159114*^9}, {3.4442469111520047`*^9, 
   3.444246913936008*^9}, {3.4442509469752336`*^9, 3.444250995905592*^9}, {
   3.444253554434576*^9, 3.4442536269288177`*^9}, {3.4442536680379295`*^9, 
   3.444253907181802*^9}, {3.444254454088214*^9, 3.444254474006856*^9}, {
   3.44425460654744*^9, 3.4442546346378317`*^9}, {3.444254790201522*^9, 
   3.4442548194635983`*^9}, {3.444254868474072*^9, 3.444254941849581*^9}, {
   3.4443051139888*^9, 3.4443053107827997`*^9}, {3.4443053411247997`*^9, 
   3.444305341312001*^9}, {3.4443053795164003`*^9, 3.444305431792*^9}, 
   3.4443056166208*^9, {3.4443058145536003`*^9, 3.4443058420408*^9}, {
   3.4443200034812*^9, 3.4443200739308*^9}, {3.4443206560448*^9, 
   3.444320747102*^9}, {3.444320818487602*^9, 3.4443208945688*^9}, {
   3.444320972912002*^9, 3.4443210547028*^9}, {3.444321099818*^9, 
   3.444321145182801*^9}, {3.4443212205152*^9, 3.4443212317940006`*^9}, {
   3.444321277782802*^9, 3.444321447682411*^9}, {3.44432149169*^9, 
   3.444321647846002*^9}, {3.4443216945056*^9, 3.444321721634*^9}, {
   3.4443221059712*^9, 3.4443221180144*^9}, {3.444322168964*^9, 
   3.444322187122401*^9}, {3.4443223214228*^9, 3.4443223381304*^9}, {
   3.4443223820132*^9, 3.4443224359736*^9}, {3.444322488374*^9, 
   3.444322525970001*^9}, {3.4443226381496*^9, 3.4443226502864*^9}, {
   3.444322681424*^9, 3.4443226830620003`*^9}, 3.444323302116801*^9, {
   3.444323715688401*^9, 3.4443238062308*^9}, {3.4443241067492*^9, 
   3.4443241129268*^9}, {3.4443241933136*^9, 3.4443241983992*^9}, {
   3.444324586714401*^9, 3.4443246188972*^9}, {3.4443249093068*^9, 
   3.44432491082*^9}, {3.444324984062001*^9, 3.4443249910352*^9}, {
   3.4443253174808*^9, 3.444325322254401*^9}, {3.4443255111704*^9, 
   3.4443255170672*^9}, {3.444325557736401*^9, 3.4443255889364*^9}, {
   3.4443256836596003`*^9, 3.4443256899932*^9}, {3.4443258190364*^9, 
   3.4443258382868*^9}, {3.4443261446396*^9, 3.4443261506924*^9}, {
   3.444326282075601*^9, 3.4443263072852*^9}, {3.44432640452*^9, 
   3.4443264047696*^9}, {3.4443264838304*^9, 3.4443264897584*^9}, {
   3.4443266688932*^9, 3.444326715974*^9}, {3.4443269305987997`*^9, 
   3.4443271358792*^9}, {3.4443271708388*^9, 3.4443272367488003`*^9}, {
   3.4443272804288*^9, 3.4443273091952*^9}, {3.4443276386984*^9, 
   3.444327657917601*^9}, {3.451073551880951*^9, 3.451074008025193*^9}, {
   3.45107412054484*^9, 3.451074153242594*^9}, {3.6495058503872595`*^9, 
   3.649505925854395*^9}, {3.649506089455983*^9, 3.6495061633358784`*^9}, {
   3.649506271556322*^9, 3.649506340933591*^9}, {3.6495063795022745`*^9, 
   3.649506402786371*^9}, {3.649506447395487*^9, 3.6495064545405617`*^9}, {
   3.64950648945411*^9, 3.64950659640064*^9}, {3.649506638519121*^9, 
   3.649506753689676*^9}, {3.649506797674204*^9, 3.649506842780961*^9}, {
   3.649510821495474*^9, 3.649510853199487*^9}, {3.649511010697929*^9, 
   3.649511090112966*^9}, 3.649517061579792*^9, {3.649519124582498*^9, 
   3.649519142913183*^9}, {3.649519197185988*^9, 3.649519197554199*^9}, {
   3.649519244013522*^9, 3.649519367843764*^9}, {3.649519404542986*^9, 
   3.649519441365047*^9}, {3.649519738090479*^9, 3.649519738668502*^9}, {
   3.649519888450616*^9, 3.64951989560342*^9}, {3.649519954337479*^9, 
   3.6495199548900976`*^9}, {3.649520020348387*^9, 3.6495200206814*^9}, {
   3.649520072007486*^9, 3.649520072389704*^9}, {3.649520201156981*^9, 
   3.649520202415618*^9}, {3.649522101137873*^9, 3.64952210920728*^9}, {
   3.649683199514022*^9, 3.649683199919643*^9}, {3.650199857770801*^9, 
   3.650199971132035*^9}, {3.832175269285937*^9, 3.83217540092506*^9}, {
   3.832175449107063*^9, 3.83217546894007*^9}, {3.832175508988351*^9, 
   3.832175510428855*^9}, {3.832175619604785*^9, 3.832175699090195*^9}, {
   3.8321757467902584`*^9, 3.832175878488613*^9}, {3.8321759452636333`*^9, 
   3.832175960176182*^9}, {3.832176009756401*^9, 3.832176101117436*^9}, {
   3.8321762129372463`*^9, 3.832176296725668*^9}, {3.832181582270059*^9, 
   3.8321815988445215`*^9}, {3.832182500533687*^9, 3.8321825210025043`*^9}, {
   3.832690691929723*^9, 3.832690713842759*^9}, {3.833375099369354*^9, 
   3.8333751581918583`*^9}, {3.833375769459081*^9, 3.833375824154202*^9}, {
   3.833375899366909*^9, 3.833375953098981*^9}, {3.8333775237998533`*^9, 
   3.8333775260094876`*^9}, {3.833378938207533*^9, 3.833378939536157*^9}, {
   3.8333824694568777`*^9, 3.833382471697551*^9}, {3.833475370136609*^9, 
   3.8334755480508423`*^9}, {3.833475578274836*^9, 3.833475583789635*^9}, {
   3.8334756216713505`*^9, 3.8334756227315364`*^9}, {3.833475880557568*^9, 
   3.8334760263169413`*^9}, {3.833476190801937*^9, 3.833476191496004*^9}, {
   3.833476747332479*^9, 3.8334767618430605`*^9}, {3.833520698294158*^9, 
   3.83352069902828*^9}, {3.835883765865997*^9, 3.835883817185582*^9}, {
   3.838199835313685*^9, 3.838199886176677*^9}, {3.838199919449819*^9, 
   3.838199926980713*^9}, {3.838199964013732*^9, 3.838200031196338*^9}, {
   3.838200071347412*^9, 3.83820009397417*^9}, {3.8382001739713154`*^9, 
   3.838200174289799*^9}, {3.838200229985332*^9, 3.838200273575391*^9}, {
   3.838200347250709*^9, 3.838200438723737*^9}, {3.838200573418236*^9, 
   3.8382006162643557`*^9}, {3.838200663218891*^9, 3.838200691741475*^9}, {
   3.8382007271328344`*^9, 3.8382007692241373`*^9}, {3.838200804252232*^9, 
   3.838200849893202*^9}, {3.838200905309663*^9, 3.8382009942563143`*^9}, {
   3.838202344233166*^9, 3.838202403466142*^9}, {3.83820243541568*^9, 
   3.838202455252605*^9}, {3.838225534215794*^9, 3.838225547608734*^9}, {
   3.838225584394644*^9, 3.8382255895813627`*^9}, {3.838225620402735*^9, 
   3.838225842256416*^9}, {3.8382258798199677`*^9, 3.838225884006722*^9}, 
   3.838233799260332*^9, 3.838233846575987*^9, {3.83849936612654*^9, 
   3.838499371516123*^9}, {3.8389888918785963`*^9, 3.838988938448218*^9}, {
   3.838989029161618*^9, 3.838989030516458*^9}, {3.8389892644627013`*^9, 
   3.838989268094435*^9}, {3.8389893583146906`*^9, 3.8389893636145535`*^9}, {
   3.8389893983952827`*^9, 3.8389894182164087`*^9}, {3.8389894718624887`*^9, 
   3.838989472866091*^9}, {3.8389903595411634`*^9, 3.838990375041841*^9}, {
   3.83899084864199*^9, 3.8389909015566683`*^9}, {3.838990945858148*^9, 
   3.838990990313569*^9}, {3.8389922381985703`*^9, 3.838992238700706*^9}, {
   3.838992274044245*^9, 3.838992291832813*^9}, 3.858825210051225*^9, 
   3.858825251162944*^9, {3.8595289906369977`*^9, 3.8595290257492743`*^9}, {
   3.8595290649068317`*^9, 3.859529092642331*^9}, {3.859529147131908*^9, 
   3.859529277063673*^9}, {3.859529318687151*^9, 3.859529395928039*^9}, {
   3.859529428133568*^9, 3.859529505337983*^9}, 3.8595295366557336`*^9, {
   3.8606036751707664`*^9, 3.860603751596614*^9}, {3.903160375152404*^9, 
   3.90316047051741*^9}, {3.903160543640393*^9, 3.903160697124632*^9}, {
   3.903160763456727*^9, 3.903160773185354*^9}, {3.903160810035997*^9, 
   3.903160831337974*^9}, {3.903161734151884*^9, 3.903161858402134*^9}, {
   3.903161939850464*^9, 3.903162006417585*^9}, {3.9031620960830317`*^9, 
   3.903162098154546*^9}, {3.903431851864744*^9, 3.903431863821458*^9}, 
   3.903431905816778*^9, {3.9034326605798807`*^9, 3.903432665224945*^9}, {
   3.908781391193486*^9, 3.908781622157108*^9}, {3.908781760834821*^9, 
   3.908781858164904*^9}, {3.908781892651852*^9, 3.908781987851135*^9}, {
   3.90878232362599*^9, 3.908782334609826*^9}, 3.908782435491313*^9, 
   3.908782472386099*^9, {3.908782519931404*^9, 3.9087825700883894`*^9}, {
   3.908782607730566*^9, 3.90878264391188*^9}, {3.908783471906368*^9, 
   3.908783477685111*^9}, {3.9087836764030313`*^9, 3.90878368557782*^9}, {
   3.908783997738772*^9, 3.908784142618742*^9}, {3.908785329298478*^9, 
   3.9087853387119246`*^9}, {3.9279682762552853`*^9, 3.927968299826439*^9}, {
   3.941541790158777*^9, 3.9415418291501007`*^9}, {3.9415418662184544`*^9, 
   3.9415420773778553`*^9}, {3.941542152204525*^9, 3.941542176861185*^9}, {
   3.941544112173588*^9, 3.9415441128225765`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"131cd7f8-ec67-2243-9c90-dd6d930c0ad0"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["stdBurstML1Dyn2stk1k2",
  FontWeight->"Bold"],
 "[bursts_,mlPar_,bA_,bD_,nTh_,tTh_,qMax_,jMax_]--  standard deviations of \
the burstML1 parameters {{n01,n02},{e1,e2},{taud1,taud2},{k1,k2}} estimated \
near the maximum  ",
 StyleBox["mlPar",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["n01", "ml"], ",", 
        SuperscriptBox["n02", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["e1", "ml"], ",", 
        SuperscriptBox["e2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["taud1", "ml"], ",", 
        SuperscriptBox["taud2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["k1", "ml"], ",", 
        SuperscriptBox["k2", "ml"]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "86e1ebe6-1e18-074a-ad9c-d519687d95fc"],
 "}}. "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.9030856804809084`*^9, 3.903085699630611*^9}, {
   3.903085776131449*^9, 3.903085832711562*^9}, {3.9030872060587616`*^9, 
   3.9030872336325216`*^9}, {3.903162267887575*^9, 3.903162290689946*^9}, {
   3.908983061214145*^9, 3.908983083743038*^9}, 3.9279698678378296`*^9, {
   3.927979153023943*^9, 3.927979153495913*^9}, {3.9279791867757587`*^9, 
   3.927979215663965*^9}, 3.941219333207142*^9, {3.9412807510385723`*^9, 
   3.9412808458335667`*^9}, 3.9412817068227425`*^9},
 FontSize->14,ExpressionUUID->"91860aa9-a8c2-4a4c-bb95-08bba1a15024"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"std", 
      StyleBox["BurstML1Dyn2stk1k2",
       FontWeight->"Bold"]}]], "[", 
    RowBox[{
    "bursts_", ",", "mlPar_", ",", "bA_", ",", "bD_", ",", "nTh_", ",", 
     "tTh_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"June", " ", "21"}], ",", " ", 
      RowBox[{
       RowBox[{
       "2024", "\n", "Standard", " ", "deviationd", " ", "of", " ", "the", 
        " ", "Max", " ", "Likelihood", " ", "parameters", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n01", ",", "n02"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"taud1", ",", "taud2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "}"}], "\n", "diffusing", " ", 
        "molecule", " ", "undergoing", " ", "2"}], "-", 
       RowBox[{
       "state", " ", "transitions", "\n", "isotropic", " ", "laser", " ", 
        "spot", " ", "approximation", "\n", "\n", 
        RowBox[{"return", ":", " ", 
         RowBox[{
          RowBox[{
          "standard", " ", "deviations", " ", "of", " ", "the", " ", "ML", 
           " ", "parameters", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"stdn01", ",", "stdn02"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"stde1", ",", "stde2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"sydtaud1", ",", "stdtaud2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"stdk1", ",", "stdk2"}], "}"}]}], "}"}], "\n", "\n", 
           "bursts"}], " ", "-", " ", 
          RowBox[{"list", " ", "of", " ", "bursts", " ", 
           RowBox[{"{", 
            RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}], ",", " ", 
      RowBox[{
      "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
       "arrival", " ", "times", " ", "and", " ", "colors", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "c0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
         "t"}], "=", 
        RowBox[{
         RowBox[{"0", "\n", "mlPar"}], " ", "-", " ", 
         RowBox[{"ML", " ", "parameters", "  ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n01ML", ",", " ", "n02ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"e1ML", ",", " ", "e2ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"td1ML", ",", " ", "td2ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k1ML", ",", " ", "k2ML"}], "}"}]}], "}"}]}]}]}], ";", 
       " ", 
       RowBox[{"taud", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "/", "D"}], " ", "-", " ", 
         RowBox[{
         "uncorrected", " ", "diffusion", " ", "time", " ", "in", " ", "the", 
          " ", "isotropic", " ", "laser", " ", 
          RowBox[{"spot", ".", "  ", "\n", "bA"}]}]}]}]}], ",", " ", 
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "nTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
        "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
      RowBox[{"N", ">=", 
       RowBox[{
        RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
      "  ", 
      RowBox[{
       RowBox[{"\[Tau]", "<", 
        RowBox[{"tTh", "\n", "qMax"}]}], "=", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
        RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
        " ", "-", " ", 
        RowBox[{
        "max", " ", "number", " ", "of", " ", "discretized", " ", 
         "points"}]}]}]}], "\n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "x", ",", "result0", ",", "f0", ",", "f0ML", ",", "mCoef", 
       ",", "table", ",", "temp", ",", "mCovariance", ",", "stdList", ",", 
       "mZ"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dim", "=", "8"}], ";", 
        RowBox[{"(*", 
         RowBox[{"the", " ", "number", " ", "of", " ", "parameters"}], "*)"}],
         "\n", 
        RowBox[{"result0", "=", 
         RowBox[{"mlPar", "//", "Flatten"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"list", " ", "of", " ", "ML", " ", "parameters"}], "*)"}], 
        "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "logL"}], 
           RowBox[{"(", 
            RowBox[{
            "n01", ",", "n02", ",", "e1", ",", "e2", ",", "taud1", ",", 
             "taud2", ",", "p1"}], ")"}]}], ",", " ", 
          RowBox[{
          "fitted", " ", "later", " ", "to", " ", "quadratic", " ", 
           "function"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"f0", "[", 
          RowBox[{
          "xn01_Real", ",", "xn02_Real", ",", "xe1_Real", ",", "xe2_Real", 
           ",", "xtaud1_Real", ",", "xtaud2_Real", ",", "xk1_Real", ",", 
           "xk2_Real"}], "]"}], ":=", 
         RowBox[{"-", 
          RowBox[{
           StyleBox["logLBurstML1Dyn2st",
            FontWeight->"Bold"], "[", 
           RowBox[{"bursts", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"xn01", ",", "xn02"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"xe1", ",", "xe2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"xk1", ",", "xk2"}], "}"}]}], "}"}], ",", " ", "bA", 
            ",", "bD", ",", " ", "nTh", ",", " ", "tTh", ",", " ", "qMax", 
            ",", " ", "jMax"}], "]"}]}]}], ";", "\n", 
        RowBox[{"f0ML", "=", 
         RowBox[{"f0", "@@", "result0"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"the", " ", "value", " ", "at", " ", "max"}], "*)"}], "\n", 
        "\n", 
        RowBox[{"mCoef", "=", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{"0", "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "matrix", " ", "of", " ", "coefficients", " ", "of", " ", 
          "quadratic", " ", "fitting", " ", "for", " ", "8", 
          RowBox[{"(", "dim", ")"}], " ", "parameters"}], "*)"}], "\n", "\n", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", 
          RowBox[{
          "calculate", " ", "diagonal", " ", "terms", " ", "of", " ", 
           "mCoef"}], "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"table", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{
                 RowBox[{"f0", "@@", 
                  RowBox[{"(", 
                   RowBox[{"result0", "/.", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}]}]}]}], ")"}]}], "-", 
                 "f0ML"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"1", "-", "0.05"}], ",", 
                RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
           ";", "\n", 
           RowBox[{
            RowBox[{"mCoef", "[", 
             RowBox[{"[", 
              RowBox[{"ipar", ",", "ipar"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"Coefficient", "[", 
              RowBox[{
               RowBox[{"Fit", "[", 
                RowBox[{"table", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "x", ",", 
                   RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
               "x", ",", "2"}], "]"}], "/", 
             RowBox[{
              RowBox[{"result0", "[", 
               RowBox[{"[", "ipar", "]"}], "]"}], "^", "2"}]}]}]}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ",
             "fitting", " ", "and", " ", "divide", " ", "by", " ", "the", " ",
             "ml", " ", "parameter", " ", "squared"}], " ", "*)"}], "\n", 
          RowBox[{"{", 
           RowBox[{"ipar", ",", "dim"}], "}"}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Calculate", " ", "off"}], "-", 
           RowBox[{"diagonal", " ", "terms", " ", "of", " ", "mCoef"}]}], " ",
           "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"table", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j", " ", ",", 
                RowBox[{
                 RowBox[{"f0", "@@", 
                  RowBox[{"(", 
                   RowBox[{"result0", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}]}]}]}], "}"}]}], ")"}]}], 
                 "-", "f0ML"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"1", "-", "0.05"}], ",", " ", 
                RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
           ";", " ", "\n", 
           RowBox[{"temp", "=", 
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{"Fit", "[", 
               RowBox[{"table", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "x", ",", 
                  RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
              "x", ",", "2"}], "]"}]}], ";", "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", 
             " ", "table", " ", "at", " ", 
             SuperscriptBox["j", "2"]}], "*)"}], "\n", "\n", 
           RowBox[{
            RowBox[{"mCoef", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"temp", "-", 
               RowBox[{
                RowBox[{"mCoef", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "i1"}], "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"result0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "^", "2"}]}], "-", 
               RowBox[{
                RowBox[{"mCoef", "[", 
                 RowBox[{"[", 
                  RowBox[{"i2", ",", "i2"}], "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"result0", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"result0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], " ", 
               RowBox[{"result0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recalculate", " ", "the", " ", "coefficient", " ", "to", " ", 
             "find", " ", 
             SubscriptBox["a", "ij"]}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"mCoef", "[", 
             RowBox[{"[", 
              RowBox[{"i2", ",", "i1"}], "]"}], "]"}], "=", " ", 
            RowBox[{"mCoef", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{
           "use", " ", "symmetry", "  ", "of", " ", "the", " ", "matrix", " ",
             "to", " ", "find", " ", "other", " ", "elements"}], " ", "*)"}], 
          "\n", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "dim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "find", " ", "the", " ", "covariance", " ", "matrix", " ", "by", " ",
           "inverting", " ", "coef"}], "*)"}], "\n", 
        RowBox[{"mCovariance", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{"2", " ", "mCoef"}], "]"}]}], ";", " ", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Standard", " ", "deviation", " ", "is", " ", "the", " ", "square", 
          " ", "root", " ", "of", " ", "the", " ", "corresponding", " ", 
          "diagonal", " ", "term", " ", "of", " ", "the", " ", "covariance", 
          " ", "matrix"}], "*)"}], "\n", 
        RowBox[{"stdList", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Diagonal", "[", "mCovariance", "]"}], "]"}]}], ";"}], "\n",
        "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<correlation= \>\"", ",", 
           RowBox[{"MatrixForm", "[", "mZ", "]"}]}], "]"}], ";"}], "*)"}], 
       "\n", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\< std: \
(\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]taud2,\
\[Delta]k1,\[Delta]k2) = \>\"", ",", "stdList"}], "]"}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\
\[Delta]taud1/taud1,\[Delta]taud2/taud2,\[Delta]k1/k1,\[Delta]k2/k2) = \
(%)\>\"", ",", 
        RowBox[{"100", " ", 
         RowBox[{"stdList", "/", "result0"}]}]}], "]"}], ";", "\n", " ", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"stdList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"stdList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"stdList", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"stdList", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"stdList", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"stdList", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"stdList", "[", 
           RowBox[{"[", "7", "]"}], "]"}], ",", 
          RowBox[{"stdList", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], "}"}]}], "}"}]}]}], "\n", 
    "]"}]}], "\[IndentingNewLine]"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.857828097559574*^9, 3.857828194007698*^9}, {
   3.85782841823205*^9, 3.857828418425572*^9}, 3.857828613163211*^9, {
   3.857828968759426*^9, 3.857828974544918*^9}, {3.8578290442417507`*^9, 
   3.857829044563747*^9}, {3.857829074631036*^9, 3.8578291042214565`*^9}, {
   3.8578291458878775`*^9, 3.857829238048008*^9}, 3.857829421021576*^9, {
   3.857829520693486*^9, 3.8578295286928062`*^9}, {3.857829563084128*^9, 
   3.857829594548587*^9}, {3.8578296304109344`*^9, 3.857829664883241*^9}, {
   3.8578297868778315`*^9, 3.8578298087658625`*^9}, {3.857830175070758*^9, 
   3.857830205766608*^9}, {3.857830720048303*^9, 3.857830786852687*^9}, {
   3.8578386206551743`*^9, 3.8578386328804483`*^9}, 3.8581603537255497`*^9, 
   3.8581720905819454`*^9, {3.858175465324697*^9, 3.858175467959547*^9}, {
   3.8585857128665075`*^9, 3.858585717890374*^9}, {3.858585751989633*^9, 
   3.8585860021440372`*^9}, {3.8585860486735444`*^9, 
   3.8585861719989986`*^9}, {3.858586449725343*^9, 3.858586517018188*^9}, 
   3.858586549105003*^9, {3.858586581820258*^9, 3.858586630889717*^9}, {
   3.858586669033432*^9, 3.8585866746724653`*^9}, {3.858586722426854*^9, 
   3.858586723089554*^9}, {3.858586758032625*^9, 3.85858675972492*^9}, {
   3.858586823654657*^9, 3.858586844767112*^9}, {3.858586895103148*^9, 
   3.858586901012944*^9}, {3.85858693634341*^9, 3.8585871919171376`*^9}, {
   3.858587228461443*^9, 3.858587232589292*^9}, {3.858587373100877*^9, 
   3.85858738170232*^9}, {3.8585876806145115`*^9, 3.858587732592875*^9}, {
   3.858587824703308*^9, 3.8585878371918306`*^9}, {3.8585892179398785`*^9, 
   3.858589244881795*^9}, {3.858589320719643*^9, 3.858589323557064*^9}, {
   3.858589748412521*^9, 3.858589750946574*^9}, {3.858603155890789*^9, 
   3.858603258196697*^9}, {3.859468026844148*^9, 3.859468027754753*^9}, {
   3.859468107077246*^9, 3.859468519814144*^9}, {3.859468550173286*^9, 
   3.859468670046273*^9}, {3.859468716586191*^9, 3.859468743555145*^9}, {
   3.859468811427297*^9, 3.859468844253744*^9}, {3.859468875861836*^9, 
   3.859469102224951*^9}, {3.85946921160175*^9, 3.859469234195001*^9}, {
   3.85946927540121*^9, 3.859469322502188*^9}, {3.85946937313416*^9, 
   3.859469661559002*^9}, {3.85946972416766*^9, 3.859469724333266*^9}, {
   3.859469814090324*^9, 3.859469856862876*^9}, {3.859471936627837*^9, 
   3.859472067184894*^9}, {3.859472260094407*^9, 3.859472517707792*^9}, {
   3.85947257722421*^9, 3.8594726646524353`*^9}, {3.859472715522278*^9, 
   3.8594727179784913`*^9}, {3.8594730588921638`*^9, 3.859473062595656*^9}, {
   3.859473285051643*^9, 3.859473443684016*^9}, {3.859473543611983*^9, 
   3.8594735472502794`*^9}, {3.859473583978324*^9, 3.859473603607573*^9}, {
   3.859473637250788*^9, 3.859473750318581*^9}, {3.859473790905247*^9, 
   3.859473873953479*^9}, {3.859473939689728*^9, 3.859473963060348*^9}, {
   3.859474584321315*^9, 3.859474596131372*^9}, {3.85947466564873*^9, 
   3.859474676880967*^9}, {3.859474876470188*^9, 3.8594751622805023`*^9}, 
   3.85947531806351*^9, {3.8594753529544077`*^9, 3.859475379054974*^9}, {
   3.859475451219303*^9, 3.859475532894684*^9}, {3.859529855676712*^9, 
   3.85952993864158*^9}, {3.859529979584072*^9, 3.859530013523413*^9}, {
   3.8595300902418933`*^9, 3.859530276660777*^9}, {3.859530310018196*^9, 
   3.859530319601689*^9}, {3.859530429560343*^9, 3.8595304796034713`*^9}, {
   3.8595305100817184`*^9, 3.8595305937094493`*^9}, {3.859530654067239*^9, 
   3.8595310997181144`*^9}, {3.859531161690531*^9, 3.859531480368295*^9}, {
   3.859531764486404*^9, 3.859531933899324*^9}, {3.859531968920547*^9, 
   3.859531969663051*^9}, {3.85953221363411*^9, 3.859532214363294*^9}, {
   3.859533074575778*^9, 3.85953307561753*^9}, {3.8595332711466036`*^9, 
   3.8595332940354557`*^9}, {3.85953334743785*^9, 3.859533351015493*^9}, {
   3.859628187721283*^9, 3.859628194827474*^9}, {3.8596282465606947`*^9, 
   3.859628297715685*^9}, {3.859628340261663*^9, 3.859628357784096*^9}, {
   3.903162298497164*^9, 3.9031623863186007`*^9}, {3.903162436358452*^9, 
   3.903162502382076*^9}, {3.903163622421395*^9, 3.903163706311583*^9}, {
   3.903163745536602*^9, 3.903163806016772*^9}, {3.903172508814447*^9, 
   3.903172508972825*^9}, {3.9089831017689915`*^9, 3.908983264975757*^9}, {
   3.908988065675268*^9, 3.9089880710890026`*^9}, {3.908988201585272*^9, 
   3.908988211242239*^9}, {3.908988276744255*^9, 3.908988288001436*^9}, {
   3.9279683266100464`*^9, 3.927968338558605*^9}, 3.9279698748055916`*^9, {
   3.927979160900456*^9, 3.927979161535829*^9}, {3.927979666798542*^9, 
   3.927979678919964*^9}, {3.9415423227985344`*^9, 3.941542457159649*^9}, {
   3.941542508685095*^9, 3.941542594085722*^9}, {3.941542644231903*^9, 
   3.9415426448211575`*^9}, {3.9415427187894726`*^9, 
   3.9415427260382423`*^9}, {3.941544397297695*^9, 3.94154441927314*^9}, {
   3.9415498907525616`*^9, 3.941549894581318*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"b7390fc1-9564-824e-b2de-e60eab9104d9"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["stdBurstML1Dyn2stkp",
  FontWeight->"Bold"],
 "[bursts_,mlPar_,bA_,bD_,nTh_,tTh_,qMax_,jMax_]--  standard deviations of \
the burstML1 parameters {{n01,n02},{e1,e2},{taud1,taud2},{k,p1}} estimated \
near the maximum  ",
 StyleBox["mlPar",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["n01", "ml"], ",", 
        SuperscriptBox["n02", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["e1", "ml"], ",", 
        SuperscriptBox["e2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["taud1", "ml"], ",", 
        SuperscriptBox["taud2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["k1", "ml"], ",", 
        SuperscriptBox["k2", "ml"]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1a111632-1510-0c4a-9db8-f985efe6b84d"],
 "}};  k=k1+k2; p1=k2/k "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.9030856804809084`*^9, 3.903085699630611*^9}, {
   3.903085776131449*^9, 3.903085832711562*^9}, {3.9030872060587616`*^9, 
   3.9030872336325216`*^9}, {3.903162267887575*^9, 3.903162290689946*^9}, {
   3.908983061214145*^9, 3.908983083743038*^9}, 3.9279698678378296`*^9, {
   3.927979153023943*^9, 3.927979177479763*^9}, {3.927979221952162*^9, 
   3.927979246681818*^9}, {3.941219342294245*^9, 3.941219343638073*^9}, {
   3.9412808693380356`*^9, 3.941280884152321*^9}, 3.9412816369947853`*^9, 
   3.941281705601385*^9},
 FontSize->14,ExpressionUUID->"9bf05d11-b44b-0a4a-b3a9-0e334549dfaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"std", 
      StyleBox["BurstML1Dyn2stkp",
       FontWeight->"Bold"]}]], "[", 
    RowBox[{
    "bursts_", ",", "mlPar_", ",", "bA_", ",", "bD_", ",", "nTh_", ",", 
     "tTh_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"July", " ", "18"}], ",", " ", 
      RowBox[{
       RowBox[{
       "2024", "\n", "Standard", " ", "deviationd", " ", "of", " ", "the", 
        " ", "Max", " ", "Likelihood", " ", "parameters", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n01", ",", "n02"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"taud1", ",", "taud2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "p1"}], "}"}]}], "}"}], "\n", "relaxation", " ", 
        "rate", " ", "k"}], "=", 
       RowBox[{
        RowBox[{"k1", "+", 
         RowBox[{"k2", " ", "and", " ", "population", " ", "p1"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"k2", "/", 
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}]}], "\n", "diffusing", " ", 
          "molecule", " ", "undergoing", " ", "2"}], "-", 
         RowBox[{
         "state", " ", "transitions", "\n", "isotropic", " ", "laser", " ", 
          "spot", " ", "approximation", "\n", "\n", "returns", " ", 
          "standard", " ", "deviations", " ", "of", " ", "the", " ", "ML", 
          " ", "parameters", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"stdn01", ",", "stdn02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"stde1", ",", "stde2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sydtaud1", ",", "stdtaud2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"stdk", ",", "stdp1"}], "}"}]}], "}"}], "\n", "\n", 
          "bursts"}], " ", "-", " ", 
         RowBox[{"list", " ", "of", " ", "bursts", " ", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}], ",", " ", 
      RowBox[{
      "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
       "arrival", " ", "times", " ", "and", " ", "colors", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "c0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
         "t"}], "=", 
        RowBox[{
         RowBox[{"0", "\n", "mlPar"}], " ", "-", " ", 
         RowBox[{"ML", " ", "parameters", "  ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n01ML", ",", " ", "n02ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"e1ML", ",", " ", "e2ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"td1ML", ",", " ", "td2ML"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k1ML", ",", " ", "k2ML"}], "}"}]}], "}"}]}]}]}], ";", 
       " ", 
       RowBox[{"taud", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "/", "D"}], " ", "-", " ", 
         RowBox[{
         "uncorrected", " ", "diffusion", " ", "time", " ", "in", " ", "the", 
          " ", "isotropic", " ", "laser", " ", 
          RowBox[{"spot", ".", "  ", "\n", "bA"}]}]}]}]}], ",", " ", 
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "nTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
        "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
      RowBox[{"N", ">=", 
       RowBox[{
        RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
      "  ", 
      RowBox[{
       RowBox[{"\[Tau]", "<", 
        RowBox[{"tTh", "\n", "qMax"}]}], "=", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
        RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
        " ", "-", " ", 
        RowBox[{
        "max", " ", "number", " ", "of", " ", "discretized", " ", 
         "points"}]}]}]}], "\n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "x", ",", "result0", ",", "f0", ",", "f0ML", ",", "mCoef", 
       ",", "table", ",", "temp", ",", "mCovariance", ",", "stdList", ",", 
       "mZ"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"dim", "=", "8"}], ";", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "number", " ", "of", " ", "parameters"}], "*)"}], 
      "\n", 
      RowBox[{"result0", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mlPar", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"mlPar", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"mlPar", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"Total", "[", 
           RowBox[{"mlPar", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"mlPar", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "2"}], "]"}], "]"}], "/", 
           RowBox[{"Total", "[", 
            RowBox[{"mlPar", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], "}"}], "//", 
        "Flatten"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", " ", "ML", " ", "parameters", " ", 
        RowBox[{"{", 
         RowBox[{
         "n01", ",", "n02", ",", "e1", ",", "e2", ",", "td1", ",", "td2", ",",
           "k", ",", "p1"}], "}"}]}], "*)"}], "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "logL"}], 
         RowBox[{"(", 
          RowBox[{
          "n01", ",", "n02", ",", "e1", ",", "e2", ",", "taud1", ",", "taud2",
            ",", "p1"}], ")"}]}], ",", " ", 
        RowBox[{
        "fitted", " ", "later", " ", "to", " ", "quadratic", " ", 
         "function"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"f0", "[", 
        RowBox[{
        "xn01_Real", ",", "xn02_Real", ",", "xe1_Real", ",", "xe2_Real", ",", 
         "xtaud1_Real", ",", "xtaud2_Real", ",", "xk_Real", ",", "xp1_Real"}],
         "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{
         StyleBox["logLBurstML1Dyn2st",
          FontWeight->"Bold"], "[", 
         RowBox[{"bursts", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xn01", ",", "xn02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xe1", ",", "xe2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xk", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "xp1"}], ")"}]}], ",", 
              RowBox[{"xk", " ", "xp1"}]}], "}"}]}], "}"}], ",", " ", "bA", 
          ",", "bD", ",", " ", "nTh", ",", " ", "tTh", ",", " ", "qMax", ",", 
          " ", "jMax"}], "]"}]}]}], ";", "\n", 
      RowBox[{"f0ML", "=", 
       RowBox[{"f0", "@@", "result0"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "value", " ", "at", " ", "max"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"mCoef", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "matrix", " ", "of", " ", "coefficients", " ", "of", " ", "quadratic", 
        " ", "fitting", " ", "for", " ", "8", 
        RowBox[{"(", "dim", ")"}], " ", "parameters"}], "*)"}], "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "calculate", " ", "diagonal", " ", "terms", " ", "of", " ", "mCoef"}],
         "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{
                   RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}], "->", 
                   RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}]}]}]}], ")"}]}], "-", 
               "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"ipar", ",", "ipar"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{"table", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "x", ",", 
                 RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
             "x", ",", "2"}], "]"}], "/", 
           RowBox[{
            RowBox[{"result0", "[", 
             RowBox[{"[", "ipar", "]"}], "]"}], "^", "2"}]}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
          "fitting", " ", "and", " ", "divide", " ", "by", " ", "the", " ", 
          "ml", " ", "parameter", " ", "squared"}], " ", "*)"}], "\n", 
        RowBox[{"{", 
         RowBox[{"ipar", ",", "dim"}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Calculate", " ", "off"}], "-", 
         RowBox[{"diagonal", " ", "terms", " ", "of", " ", "mCoef"}]}], " ", 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", " ", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}]}]}]}], "}"}]}], ")"}]}], 
               "-", "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", " ", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", " ", "\n", 
         RowBox[{"temp", "=", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"table", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", "x",
             ",", "2"}], "]"}]}], ";", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
           "table", " ", "at", " ", 
           SuperscriptBox["j", "2"]}], "*)"}], "\n", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"temp", "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "i1"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "i2"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "recalculate", " ", "the", " ", "coefficient", " ", "to", " ", 
           "find", " ", 
           SubscriptBox["a", "ij"]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i2", ",", "i1"}], "]"}], "]"}], "=", " ", 
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "use", " ", "symmetry", "  ", "of", " ", "the", " ", "matrix", " ", 
          "to", " ", "find", " ", "other", " ", "elements"}], " ", "*)"}], 
        "\n", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", 
          RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "find", " ", "the", " ", "covariance", " ", "matrix", " ", "by", " ", 
        "inverting", " ", "coef"}], "*)"}], "\n", 
      RowBox[{"mCovariance", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"2", " ", "mCoef"}], "]"}]}], ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Standard", " ", "deviation", " ", "is", " ", "the", " ", "square", 
        " ", "root", " ", "of", " ", "the", " ", "corresponding", " ", 
        "diagonal", " ", "term", " ", "of", " ", "the", " ", "covariance", 
        " ", "matrix"}], "*)"}], "\n", 
      RowBox[{"stdList", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Diagonal", "[", "mCovariance", "]"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< std: \
(\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]taud2,\
\[Delta]k,\[Delta]p1) = \>\"", ",", "stdList"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\
\[Delta]taud1/taud1,\[Delta]taud2/taud2,\[Delta]k/k,\[Delta]p1/p1) = (%)\>\"",
         ",", 
        RowBox[{"100", " ", 
         RowBox[{"stdList", "/", "result0"}]}]}], "]"}], ";", "\n", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "  ", 
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", "4"}], "]"}], "]"}], ",", " ", 
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"5", ";;", "6"}], "]"}], "]"}], ",", " ", 
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"7", ";;", "8"}], "]"}], "]"}]}], "}"}]}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.857828097559574*^9, 3.857828194007698*^9}, {
   3.85782841823205*^9, 3.857828418425572*^9}, 3.857828613163211*^9, {
   3.857828968759426*^9, 3.857828974544918*^9}, {3.8578290442417507`*^9, 
   3.857829044563747*^9}, {3.857829074631036*^9, 3.8578291042214565`*^9}, {
   3.8578291458878775`*^9, 3.857829238048008*^9}, 3.857829421021576*^9, {
   3.857829520693486*^9, 3.8578295286928062`*^9}, {3.857829563084128*^9, 
   3.857829594548587*^9}, {3.8578296304109344`*^9, 3.857829664883241*^9}, {
   3.8578297868778315`*^9, 3.8578298087658625`*^9}, {3.857830175070758*^9, 
   3.857830205766608*^9}, {3.857830720048303*^9, 3.857830786852687*^9}, {
   3.8578386206551743`*^9, 3.8578386328804483`*^9}, 3.8581603537255497`*^9, 
   3.8581720905819454`*^9, {3.858175465324697*^9, 3.858175467959547*^9}, {
   3.8585857128665075`*^9, 3.858585717890374*^9}, {3.858585751989633*^9, 
   3.8585860021440372`*^9}, {3.8585860486735444`*^9, 
   3.8585861719989986`*^9}, {3.858586449725343*^9, 3.858586517018188*^9}, 
   3.858586549105003*^9, {3.858586581820258*^9, 3.858586630889717*^9}, {
   3.858586669033432*^9, 3.8585866746724653`*^9}, {3.858586722426854*^9, 
   3.858586723089554*^9}, {3.858586758032625*^9, 3.85858675972492*^9}, {
   3.858586823654657*^9, 3.858586844767112*^9}, {3.858586895103148*^9, 
   3.858586901012944*^9}, {3.85858693634341*^9, 3.8585871919171376`*^9}, {
   3.858587228461443*^9, 3.858587232589292*^9}, {3.858587373100877*^9, 
   3.85858738170232*^9}, {3.8585876806145115`*^9, 3.858587732592875*^9}, {
   3.858587824703308*^9, 3.8585878371918306`*^9}, {3.8585892179398785`*^9, 
   3.858589244881795*^9}, {3.858589320719643*^9, 3.858589323557064*^9}, {
   3.858589748412521*^9, 3.858589750946574*^9}, {3.858603155890789*^9, 
   3.858603258196697*^9}, {3.859468026844148*^9, 3.859468027754753*^9}, {
   3.859468107077246*^9, 3.859468519814144*^9}, {3.859468550173286*^9, 
   3.859468670046273*^9}, {3.859468716586191*^9, 3.859468743555145*^9}, {
   3.859468811427297*^9, 3.859468844253744*^9}, {3.859468875861836*^9, 
   3.859469102224951*^9}, {3.85946921160175*^9, 3.859469234195001*^9}, {
   3.85946927540121*^9, 3.859469322502188*^9}, {3.85946937313416*^9, 
   3.859469661559002*^9}, {3.85946972416766*^9, 3.859469724333266*^9}, {
   3.859469814090324*^9, 3.859469856862876*^9}, {3.859471936627837*^9, 
   3.859472067184894*^9}, {3.859472260094407*^9, 3.859472517707792*^9}, {
   3.85947257722421*^9, 3.8594726646524353`*^9}, {3.859472715522278*^9, 
   3.8594727179784913`*^9}, {3.8594730588921638`*^9, 3.859473062595656*^9}, {
   3.859473285051643*^9, 3.859473443684016*^9}, {3.859473543611983*^9, 
   3.8594735472502794`*^9}, {3.859473583978324*^9, 3.859473603607573*^9}, {
   3.859473637250788*^9, 3.859473750318581*^9}, {3.859473790905247*^9, 
   3.859473873953479*^9}, {3.859473939689728*^9, 3.859473963060348*^9}, {
   3.859474584321315*^9, 3.859474596131372*^9}, {3.85947466564873*^9, 
   3.859474676880967*^9}, {3.859474876470188*^9, 3.8594751622805023`*^9}, 
   3.85947531806351*^9, {3.8594753529544077`*^9, 3.859475379054974*^9}, {
   3.859475451219303*^9, 3.859475532894684*^9}, {3.859529855676712*^9, 
   3.85952993864158*^9}, {3.859529979584072*^9, 3.859530013523413*^9}, {
   3.8595300902418933`*^9, 3.859530276660777*^9}, {3.859530310018196*^9, 
   3.859530319601689*^9}, {3.859530429560343*^9, 3.8595304796034713`*^9}, {
   3.8595305100817184`*^9, 3.8595305937094493`*^9}, {3.859530654067239*^9, 
   3.8595310997181144`*^9}, {3.859531161690531*^9, 3.859531480368295*^9}, {
   3.859531764486404*^9, 3.859531933899324*^9}, {3.859531968920547*^9, 
   3.859531969663051*^9}, {3.85953221363411*^9, 3.859532214363294*^9}, {
   3.859533074575778*^9, 3.85953307561753*^9}, {3.8595332711466036`*^9, 
   3.8595332940354557`*^9}, {3.85953334743785*^9, 3.859533351015493*^9}, {
   3.859628187721283*^9, 3.859628194827474*^9}, {3.8596282465606947`*^9, 
   3.859628297715685*^9}, {3.859628340261663*^9, 3.859628357784096*^9}, {
   3.903162298497164*^9, 3.9031623863186007`*^9}, {3.903162436358452*^9, 
   3.903162502382076*^9}, {3.903163622421395*^9, 3.903163706311583*^9}, {
   3.903163745536602*^9, 3.903163806016772*^9}, {3.903172508814447*^9, 
   3.903172508972825*^9}, {3.9089831017689915`*^9, 3.908983264975757*^9}, {
   3.908988065675268*^9, 3.9089880710890026`*^9}, {3.908988201585272*^9, 
   3.908988211242239*^9}, {3.908988276744255*^9, 3.908988288001436*^9}, {
   3.9279683266100464`*^9, 3.927968338558605*^9}, 3.9279698748055916`*^9, {
   3.927979160900456*^9, 3.927979161535829*^9}, {3.92797925551705*^9, 
   3.9279793691130543`*^9}, {3.9279794284728413`*^9, 3.927979551292875*^9}, {
   3.927979598318667*^9, 3.927979649377901*^9}, 3.92797969262912*^9, {
   3.930307831869184*^9, 3.9303078320803432`*^9}, {3.930307883480217*^9, 
   3.9303078873081226`*^9}, {3.94154268867198*^9, 3.9415427979110775`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[5]:=",ExpressionUUID->"e9c4e268-0ebb-1e43-b923-f7e3c530ec7c"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["corrPhi",
  FontWeight->"Bold"],
 "[w_]-- correction factor ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["a", "2"], "/", 
   SubscriptBox[
    SuperscriptBox["a", "2"], "xy"]}]], "Code",
  CellChangeTimes->{{3.882806807024146*^9, 3.882807122341483*^9}, {
   3.882807158736989*^9, 3.8828071594565754`*^9}, {3.8828072763054905`*^9, 
   3.8828072808589973`*^9}, {3.89161016983505*^9, 3.891610195347515*^9}, {
   3.891610464883167*^9, 3.891610645096068*^9}, {3.892547736566109*^9, 
   3.892547868837436*^9}, {3.892547898901249*^9, 3.892547899345888*^9}},
  ExpressionUUID->"ea243848-b487-064c-96c5-72487ebc11d9"],
 " to convert extracted diffusion time ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["a", "2"], "/", "D"}]], "Code",
  CellChangeTimes->{{3.882806807024146*^9, 3.882807122341483*^9}, {
   3.882807158736989*^9, 3.8828071594565754`*^9}, {3.8828072763054905`*^9, 
   3.8828072808589973`*^9}, {3.89161016983505*^9, 3.891610195347515*^9}, {
   3.891610464883167*^9, 3.891610645096068*^9}, {3.892547736566109*^9, 
   3.892547868837436*^9}, {3.892547898901249*^9, 3.892547899345888*^9}},
  ExpressionUUID->"4469a9b4-1a8f-e345-a4ad-e8b3e61722ba"],
 " in the isotropic laser spot to the diffusion time ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[Tau]", "d"], "=", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["a", "2"], "xy"], "/", "D"}]}]], "Code",
  CellChangeTimes->{{3.882806807024146*^9, 3.882807122341483*^9}, {
   3.882807158736989*^9, 3.8828071594565754`*^9}, {3.8828072763054905`*^9, 
   3.8828072808589973`*^9}, {3.89161016983505*^9, 3.891610195347515*^9}, {
   3.891610464883167*^9, 3.891610645096068*^9}, {3.892547736566109*^9, 
   3.892547868837436*^9}, {3.892547898901249*^9, 3.892547899345888*^9}},
  ExpressionUUID->"b306f496-86c1-dd44-96db-aeb3fca00155"],
 " in the elongated spot with the axial ratio ",
 StyleBox["w",
  FontSlant->"Italic"],
 "=az/axy ."
}], "Subtitle",
 CellChangeTimes->{{3.908896535923963*^9, 3.908896539157804*^9}, {
  3.9249596006645145`*^9, 3.924959640159149*^9}, {3.941219358247635*^9, 
  3.941219409182129*^9}, {3.941280910249588*^9, 3.941280969144987*^9}, {
  3.9415410366131153`*^9, 3.9415410769497128`*^9}},
 FontSize->14,
 FontWeight->"Normal",ExpressionUUID->"81745a67-9d3c-004b-be08-b0d3b5095d73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"corrPhi", "[", "w_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"May17", ",", " ", 
     RowBox[{
      RowBox[{"2024", "\n", "correction", " ", "coefficient", " ", 
       RowBox[{
        SuperscriptBox["a", "2"], "/", 
        SubscriptBox[
         SuperscriptBox["a", "2"], "xy"]}], " ", "\n", "\n", 
       RowBox[{"return", ":", " ", 
        RowBox[{"corrPhi", "[", "w", "]"}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], "/", 
         SubscriptBox[
          SuperscriptBox["a", "2"], "xy"]}], "\n", "w"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"az", "/", "axy"}], " ", "-", " ", 
         RowBox[{
         "axial", " ", "ratio", " ", "of", " ", "the", " ", "laser", " ", 
          "spot", "\n", "the", " ", "diffusion", " ", "time", " ", "in", " ", 
          "the", " ", "isotropic", " ", "spot", " ", "approximation", " ", 
          SubscriptBox["taud", "is"]}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "2"], "/", "D"}], " ", "is", " ", "corrected", 
          " ", "as", " ", "taud"}], "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["a", "xy"], "2"], "/", "D"}], "=", 
          RowBox[{
           SubscriptBox["taud", "is"], "/", 
           RowBox[{"corrPhi", "[", "w", "]"}]}]}]}]}]}]}]}], "\n", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "sqrt"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sqrt", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"w", "^", "2"}], "-", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"2", " ", "w", " ", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"w", "+", "sqrt"}], "]"}], "/", "sqrt"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"2", " ", "w", " ", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"w", "^", "2"}], "+", "x"}], "]"}], "+", "sqrt"}], 
           ")"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", "x"}], "]"}]}], "]"}], "/", "sqrt"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "y"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", 
         RowBox[{"3", "x"}], " ", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"9", " ", "x"}], "-", "y"}], ")"}]}], "]"}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{"8", " ", "y"}], ")"}]}]}]}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.882806807024146*^9, 3.882807122341483*^9}, {
  3.882807158736989*^9, 3.8828071594565754`*^9}, {3.8828072763054905`*^9, 
  3.8828072808589973`*^9}, {3.89161016983505*^9, 3.891610195347515*^9}, {
  3.891610464883167*^9, 3.891610645096068*^9}, {3.892547736566109*^9, 
  3.892547868837436*^9}, {3.892547898901249*^9, 3.892547899345888*^9}, {
  3.9250212401486435`*^9, 3.925021245286268*^9}, {3.941542863440134*^9, 
  3.9415429900165977`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ed9f8764-b4d6-ac44-8d98-d49c6f2a20d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"corrPhi", "[", "3.", "]"}]], "Input",
 CellChangeTimes->{{3.882807137068005*^9, 3.882807138303868*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"ff797d22-1932-d24d-b5ae-8db8858bbf83"],

Cell[BoxData["1.6083215359267813`"], "Output",
 CellChangeTimes->{3.882807139358083*^9, 3.88280718556964*^9, 
  3.882807283800836*^9, 3.9415430220784836`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"888acf0b-097e-fa4c-a864-1b1d3eab7a96"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BurstML2", "Subsubsection",
 CellChangeTimes->{{3.90878652974298*^9, 3.90878655082699*^9}, {
   3.90889565910878*^9, 3.908895665342058*^9}, 3.908981049571086*^9, 
   3.927967216982771*^9, {3.927969938751454*^9, 3.927969940902836*^9}, {
   3.941217776685467*^9, 
   3.9412177908298264`*^9}},ExpressionUUID->"1c55a70d-95de-0549-82f9-\
fac6acbd8d06"],

Cell[TextData[{
 "BurstML2 finds diffusion time in the elongated spot ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["\[Tau]", "d"], "=", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["a", "2"], "xy"], "/", "D"}]}]], "Code",
  CellChangeTimes->{{3.882806807024146*^9, 3.882807122341483*^9}, {
   3.882807158736989*^9, 3.8828071594565754`*^9}, {3.8828072763054905`*^9, 
   3.8828072808589973`*^9}, {3.89161016983505*^9, 3.891610195347515*^9}, {
   3.891610464883167*^9, 3.891610645096068*^9}, {3.892547736566109*^9, 
   3.892547868837436*^9}, {3.892547898901249*^9, 3.892547899345888*^9}},
  ExpressionUUID->"66d1d411-399c-a044-95b0-11418ead7e26"],
 " with the count rates, FRET efficiencies, and transition rates taken from \
burstML1. Aspect ratio ",
 StyleBox["w",
  FontSlant->"Italic"],
 "=az/axy."
}], "Text",
 CellChangeTimes->{{3.924956148433134*^9, 3.9249561766411743`*^9}, {
   3.924959164597851*^9, 3.924959174259962*^9}, 3.9250222431085224`*^9, {
   3.927966783247219*^9, 3.927966785271158*^9}, {3.927987493076542*^9, 
   3.9279874981092014`*^9}, {3.930223993860391*^9, 3.930223998968836*^9}, 
   3.9303073742052345`*^9, 3.9303899493667583`*^9, {3.930551479159078*^9, 
   3.930551479254263*^9}, 3.941216889099893*^9, {3.9412169535056744`*^9, 
   3.9412169651838846`*^9}, {3.941217171109112*^9, 3.941217306094869*^9}, {
   3.941217342022753*^9, 3.9412173857594376`*^9}, {3.941217959157961*^9, 
   3.941218293518112*^9}, {3.9412184460314236`*^9, 3.941218475495689*^9}, {
   3.9412185132558513`*^9, 3.941218617240122*^9}, {3.941218652263172*^9, 
   3.941218663784281*^9}, {3.9412187039599*^9, 3.941218796792137*^9}, {
   3.94128132142606*^9, 3.941281343817255*^9}, {3.9415411273809566`*^9, 
   3.941541171780901*^9}},ExpressionUUID->"d27a1358-15fc-de44-9ad5-\
eeab7536cb98"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["matrices2Dyn2st",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[n0List_,eList_,taudList_,kList_,w_,bA_,bD_,qMax_,jMax_] -- \
calculates matrices ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "A"], ",", " ", 
    SubscriptBox["N", "D"], ",", " ", 
    RowBox[{"L", "+", "K", "-", 
     SubscriptBox["N", "A"], "-", 
     SubscriptBox["N", "D"]}], ",", "  ", 
    RowBox[{"and", " ", "vector", " ", 
     SubscriptBox["p", "eq"]}]}], TraditionalForm]],
  FontColor->GrayLevel[0],ExpressionUUID->
  "46d6115e-d762-1848-8844-f84014c562d1"],
 StyleBox["; 2 discretized coordinates",
  FontColor->GrayLevel[0]]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.9083787536101203`*^9, 3.908378755424224*^9}, {3.908626297892875*^9, 
   3.908626299364454*^9}, {3.90863077927653*^9, 3.908630780006768*^9}, {
   3.908630821972411*^9, 3.908630831068453*^9}, {3.92796795345595*^9, 
   3.927967956103121*^9}, {3.927968114806801*^9, 3.9279681242387276`*^9}, {
   3.9279681554928093`*^9, 3.92796815630237*^9}, {3.9279707331635685`*^9, 
   3.9279707372248554`*^9}},
 FontSize->14,ExpressionUUID->"3dd99222-1377-2347-bb7b-eff7bf2f32c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrices2Dyn2st", "[", 
   RowBox[{
   "n0List_", ",", "eList_", ",", "taudList_", ",", "kList_", ",", "w_", ",", 
    "bA_", ",", "bD_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matricesColor2D", "[", 
     RowBox[{
     "n0", ",", "e", ",", "taud", ",", "w", ",", "bA", ",", "bD", ",", "qMax",
       ",", "jMax"}], "]"}], "="}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"June", " ", "21"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", 
      RowBox[{"matrices", " ", 
       SubscriptBox["N", "A"]}]}], ",", " ", 
     SubscriptBox["N", "D"], ",", " ", 
     RowBox[{"L", "+", "K", "-", "N"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "vector", " ", 
       SubscriptBox["p", "eq"], " ", "required", " ", "in", " ", "burstML2"}],
       ";", "\n", 
      RowBox[{
       RowBox[{"diffusing", " ", "molecule", " ", "undergoing", " ", "2"}], 
       "-", 
       RowBox[{
       "state", " ", "transitions", "\n", "2", " ", "discretized", " ", 
        "coordinates"}]}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"return", ":", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["N", "A"], ",", 
           SubscriptBox["N", "D"], ",", 
           RowBox[{"L", "+", "K", "-", "N"}], ",", "peq"}], "}"}], "\n", "\n",
          "n0List"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "photon", " ", "count", " ", "rates", " ", 
          "at", " ", "the", " ", "center", " ", "of", " ", "the", " ", 
          "laser", " ", "spot", "\n", "eList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
          RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
           RowBox[{"(", 
            RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"axy", "^", "2"}], "/", "d1"}], ",", 
             RowBox[{
              RowBox[{"axy", "^", "2"}], "/", "d2"}]}], "}"}], " ", "-", " ", 
           RowBox[{
           "difusion", " ", "times", " ", "in", " ", "the", " ", "elongated", 
            " ", "laser", " ", "spot", " ", 
            RowBox[{"(", 
             RowBox[{"axy", " ", "-", " ", 
              RowBox[{
              "lateral", " ", "size", " ", "of", " ", "the", " ", "spot"}]}], 
             ")"}], "\n", "kList"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
            RowBox[{
            "list", " ", "of", " ", "transition", " ", "rates", " ", "1"}]}], 
           "->", 
           RowBox[{
            RowBox[{"2", " ", "and", " ", "2"}], "->", 
            RowBox[{
             RowBox[{"1", "\n", "w"}], " ", "-", "  ", 
             RowBox[{"axial", " ", "ratio", " ", 
              RowBox[{"az", "/", "axy"}], " ", "\n", "bA"}]}]}]}]}]}]}]}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", 
        SubscriptBox["a", "xy"]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["z", "max"], "/", 
          SubscriptBox["a", "z"]}], " ", "-", " ", 
         RowBox[{"max", " ", "value", " ", "of", "  ", 
          SubscriptBox["q", "r"]}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "/", 
           SubscriptBox["a", "xy"]}], " ", "and", " ", 
          SubscriptBox["q", "z"]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "/", 
             SubscriptBox["a", "z"]}], "\n", "jMax"}], " ", "-", " ", 
           RowBox[{
           "max", " ", "number", " ", "of", " ", "discret", " ", "points", 
            " ", "of", " ", 
            SubscriptBox["q", "r"]}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "/", 
             SubscriptBox["a", "xy"]}], " ", "and", " ", 
            SubscriptBox["q", "z"]}], "=", 
           RowBox[{"z", "/", 
            SubscriptBox["a", "z"]}]}]}]}]}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k1", ",", "k2", ",", "p1", ",", "mK2", ",", "mK", ",", "delta", ",", 
      "q", ",", "lrp", ",", "lrm", ",", "lzp", ",", "lzm", ",", "j", ",", 
      "jr", ",", "mLr0", ",", "mLz0", ",", "mL0", ",", "mL", ",", "mP", ",", 
      "mP2", ",", "mNA", ",", "mND", ",", "preq", ",", "peq"}], "}"}], ",", 
    "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "=", "kList"}], ";", "\n", 
     RowBox[{"p1", "=", 
      RowBox[{"k2", "/", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}]}]}], ";", "\n", 
     RowBox[{"mK2", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "k1"}], ",", "k2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"-", "k2"}]}], "}"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"matrix", " ", "of", " ", "2"}], "-", 
       RowBox[{"state", " ", "transitions"}]}], "*)"}], "\n", "\n", 
     RowBox[{"mK", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"mK2", ",", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"jMax", "^", "2"}], "]"}]}], "]"}]}], ";", "\n", "\n", "\n", 
     RowBox[{"delta", "=", 
      RowBox[{"qMax", "/", "jMax"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"q", "[", "j_", "]"}], "=", 
      RowBox[{"delta", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", 
         RowBox[{"1", "/", "2"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"dimensionless", "  ", "coordinate"}], "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"r", " ", "discretization"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{"lrp", "[", "jr_", "]"}], "=", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"jr", "+", 
         RowBox[{"1", "/", "2"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{"q", "[", "jr", "]"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"matrix", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lrm", "[", "jr_", "]"}], "=", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"jr", "-", 
         RowBox[{"1", "/", "2"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{"q", "[", "jr", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lrm", "[", "1", "]"}], "=", "0"}], ";", "\n", 
     RowBox[{
      RowBox[{"lrp", "[", "jMax", "]"}], "=", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"reflecting", " ", "bc"}], " ", "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"z", " ", "discretization"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{"lzp", "[", "jz_", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w", " ", "delta"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"matrix", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lzm", "[", "jz_", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w", " ", "delta"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lzm", "[", "1", "]"}], "=", "0"}], ";", "\n", 
     RowBox[{
      RowBox[{"lzp", "[", "jMax", "]"}], "=", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"reflecting", " ", "bc"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\n", 
     RowBox[{"(*", " ", 
      RowBox[{"diffusion", " ", "matrix", " ", "in", " ", "r"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mLr0", "=", 
      RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "->", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lrp", "[", "i", "]"}], "+", 
                RowBox[{"lrm", "[", "i", "]"}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lrp", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"jMax", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lrm", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "jMax"}], "}"}]}], "]"}]}], "}"}], "//",
         "Flatten"}], "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"diffusion", " ", "matrix", " ", "in", " ", "z"}], "*)"}], "\n", 
     RowBox[{"mLz0", "=", 
      RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "->", 
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lzp", "[", "i", "]"}], "+", 
                RowBox[{"lzm", "[", "i", "]"}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lzp", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"jMax", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "i"}], "}"}], "->", 
             RowBox[{"lzm", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "jMax"}], "}"}]}], "]"}]}], "}"}], "//",
         "Flatten"}], "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"diffusion", " ", "matrix", " ", "L"}], ";", " ", 
        RowBox[{"add", " ", "SparseArray", " ", "Nov", " ", "7"}]}], ",", " ",
        "2023"}], "*)"}], "\n", 
     RowBox[{"mL0", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"jMax", ",", "SparseArray"}], "]"}], ",", "mLr0"}], "]"}], 
       "+", "\[IndentingNewLine]", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"mLz0", ",", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"jMax", ",", "SparseArray"}], "]"}]}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"mL0", " ", "-", " ", 
       RowBox[{"without", " ", "taud", " ", "factor"}]}], "*)"}], "\n", "\n", 
     RowBox[{"mL", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"1", "/", "taudList"}], "]"}], ",", "mL0"}], "]"}]}], ";", 
     "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"matrices", " ", "NA"}], ",", " ", "ND"}], "*)"}], "\n", 
     RowBox[{"mP", "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}], "->", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], "^", "2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"discretized", " ", "point", " ", "spread", " ", "function"}], 
      "*)"}], "\n", 
     RowBox[{"mP2", "=", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"mP", ",", "mP"}], "]"}]}], ";", "\n", 
     RowBox[{"mNA", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"n0List", " ", "eList"}], "]"}], ",", "mP2"}], "]"}], "+", 
       RowBox[{"bA", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"jMax", "^", "2"}]}], ",", "SparseArray"}], "]"}]}]}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{"diagonal", " ", "matrix", " ", "NA"}], "*)"}], "\n", 
     RowBox[{"mND", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"n0List", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "eList"}], ")"}]}], "]"}], ",", " ", "mP2"}], 
        "]"}], "+", 
       RowBox[{"bD", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"jMax", "^", "2"}]}], ",", "SparseArray"}], "]"}]}]}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{"diagonal", " ", "matrix", " ", "ND"}], "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"equilibrium", " ", "vector"}], " ", "*)"}], "\n", 
     RowBox[{"preq", "=", 
      RowBox[{"2", " ", "Pi", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"q", "[", "jr", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"jr", ",", "jMax"}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", "[", "jr", "]"}], "}"}], " ", "makes", " ", "a", " ", 
       "column", " ", "vector"}], " ", "*)"}], "\n", 
     RowBox[{"peq", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p1", ",", 
           RowBox[{"1", "-", "p1"}]}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", "jMax"}], "]"}], ",", "preq"}], "]"}], "//", 
       "Flatten"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "...", "}"}], " ", "makes", " ", "a", " ", "column", " ",
         "vector"}], ";", " ", 
       RowBox[{
        RowBox[{"peq", " ", "is", " ", "a", " ", "column", " ", "vector"}], 
        " ", "=", " ", 
        RowBox[{"matrix", " ", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"jMax", "^", "2"}], " ", "x", " ", "1"}], ")"}]}]}], ";", 
       "\n", 
       RowBox[{
       "Flatten", " ", "to", " ", "make", " ", "it", " ", "a", " ", "row", 
        " ", "vector"}]}], " ", "*)"}], "\n", "\n", 
     RowBox[{"{", 
      RowBox[{"mNA", ",", "mND", ",", 
       RowBox[{"mL", "+", "mK", "-", "mNA", "-", "mND"}], ",", "peq"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.832865111168004*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.867242428034723*^9, 3.867242492515263*^9}, {3.867242529268175*^9, 
   3.867242560990389*^9}, 3.867242621479858*^9, {3.867242653420859*^9, 
   3.867242669582061*^9}, 3.867243147705471*^9, {3.867243368583119*^9, 
   3.867243383499181*^9}, {3.8672434472304697`*^9, 3.867243447507744*^9}, {
   3.867243495845126*^9, 3.8672435394414787`*^9}, {3.8672437597197824`*^9, 
   3.86724389989441*^9}, {3.867244111226159*^9, 3.867244152016118*^9}, {
   3.867244186852701*^9, 3.86724425254836*^9}, {3.8672443127818813`*^9, 
   3.867244326587611*^9}, {3.8672443689238586`*^9, 3.867244392771106*^9}, 
   3.867244511004591*^9, 3.867249228010229*^9, {3.877246168411735*^9, 
   3.8772461980951667`*^9}, {3.877246237795952*^9, 3.8772462493205957`*^9}, {
   3.877246279618569*^9, 3.877246403202505*^9}, {3.877246699063492*^9, 
   3.877246780071143*^9}, {3.87724868510625*^9, 3.877248695655263*^9}, {
   3.8830720288248477`*^9, 3.883072032743606*^9}, {3.891601220320761*^9, 
   3.8916012873921824`*^9}, 3.8916013282122965`*^9, {3.8916017148379993`*^9, 
   3.891601793043271*^9}, {3.891609436287856*^9, 3.891609437434782*^9}, 
   3.8920293504712133`*^9, {3.892033872076573*^9, 3.8920338933001127`*^9}, 
   3.892546744840179*^9, {3.8925467852493925`*^9, 3.892546817380274*^9}, {
   3.892546853996863*^9, 3.892546929527864*^9}, {3.903027585599848*^9, 
   3.90302767939599*^9}, {3.903027717664448*^9, 3.903027910514491*^9}, {
   3.9083763296014876`*^9, 3.908376386630449*^9}, {3.908376468207678*^9, 
   3.908376588621616*^9}, {3.9083766846282797`*^9, 3.908376804975918*^9}, {
   3.908376991448261*^9, 3.908376992011876*^9}, 3.908377126988201*^9, {
   3.908377231869909*^9, 3.908377251577132*^9}, {3.908377518760578*^9, 
   3.908377543805554*^9}, {3.908377849266677*^9, 3.908377852113125*^9}, 
   3.9083783369391747`*^9, {3.908378739288039*^9, 3.908378743101377*^9}, {
   3.908630838640737*^9, 3.90863093428128*^9}, {3.908631003557649*^9, 
   3.9086310256292186`*^9}, {3.9086310643010254`*^9, 3.908631194052777*^9}, 
   3.908631269440956*^9, {3.908631310508127*^9, 3.908631377343811*^9}, {
   3.9086314177066216`*^9, 3.90863145453288*^9}, {3.908631510162591*^9, 
   3.908631626324953*^9}, {3.908631707188032*^9, 3.908631736232418*^9}, {
   3.908631867810258*^9, 3.908631868438751*^9}, {3.908631949871619*^9, 
   3.908631982627248*^9}, {3.908638164487213*^9, 3.908638177750186*^9}, {
   3.908638227538191*^9, 3.908638384379753*^9}, {3.908638441723038*^9, 
   3.908638526888799*^9}, {3.9086386874552507`*^9, 3.908638688151074*^9}, {
   3.908639111979926*^9, 3.908639123485223*^9}, {3.908639158003254*^9, 
   3.908639158497987*^9}, {3.9086394059773436`*^9, 3.908639416521107*^9}, {
   3.908639490525764*^9, 3.90863949347208*^9}, {3.908642575487412*^9, 
   3.9086425782244906`*^9}, {3.908642615133384*^9, 3.908642636366833*^9}, {
   3.908642917043962*^9, 3.908642937785918*^9}, {3.927967962869543*^9, 
   3.927967976236616*^9}, {3.9279790313785667`*^9, 3.927979034802761*^9}, {
   3.941543075144451*^9, 3.9415431730528946`*^9}, 3.941543262581682*^9, {
   3.9415433344300594`*^9, 3.9415433364764824`*^9}, {3.9415435152563705`*^9, 
   3.9415435749229965`*^9}, {3.941544004308359*^9, 
   3.941544004647169*^9}},ExpressionUUID->"7e4f6ee4-65c5-2e4c-84a6-\
1f21c3247141"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["logLBurstML2Dyn2st",
  FontWeight->"Bold"],
 "[bursts_,{n0List_,eList_,taudList_,kList_},w_,bA_,bD_,nTh_,tTh_,qMax_,jMax_]\
 --  log-likelihood of several bursts for given values of photon count rates ",
 StyleBox["n0List",
  FontSlant->"Italic"],
 "={n01,n02}, FRET efficiencies ",
 StyleBox["eList",
  FontSlant->"Italic"],
 "={e1,e2}, diffusion times ",
 StyleBox["taudList",
  FontSlant->"Italic"],
 "={taud1, taud2}, and transition rates ",
 StyleBox["kList",
  FontSlant->"Italic"],
 "={k1,k2} ",
 StyleBox["; 2 discretized coordinates",
  FontColor->GrayLevel[0]],
 " "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.903085703052754*^9, 3.9030857039156075`*^9}, {
   3.903092367313337*^9, 3.90309237381822*^9}, {3.903106203921193*^9, 
   3.903106251551284*^9}, {3.905855738942542*^9, 3.905855745830375*^9}, {
   3.905855813128307*^9, 3.9058558270471163`*^9}, {3.90585635306526*^9, 
   3.9058563536015935`*^9}, {3.908981061518978*^9, 3.908981105259076*^9}, {
   3.908981251670562*^9, 3.908981252127372*^9}, {3.927969973040149*^9, 
   3.927969990064247*^9}, {3.941219481976158*^9, 3.941219495190841*^9}, {
   3.941220998752455*^9, 3.9412210055257893`*^9}, {3.9415411887032146`*^9, 
   3.9415412309216843`*^9}},
 FontSize->14,ExpressionUUID->"a668da2e-b7e3-9c46-84dc-15f3c887e55c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"logLBurstML2Dyn2st", "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{"n0List_", ",", "eList_", ",", "taudList_", ",", "kList_"}], 
     "}"}], ",", "w_", ",", "bA_", ",", "bD_", ",", "nTh_", ",", "tTh_", ",", 
    "qMax_", ",", "jMax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"June", " ", "21"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", "\n", 
      RowBox[{"log", "-", 
       RowBox[{
       "likelihood", " ", "of", " ", "many", " ", "bursts", " ", "\n", 
        "diffusing", " ", "molecule", " ", "undergoing", " ", "2"}], "-", 
       RowBox[{
       "state", " ", "transitions", "\n", "2", " ", "discretized", " ", 
        "coordinates", "\n", "\n", 
        RowBox[{"return", ":", " ", 
         RowBox[{
          RowBox[{"sum", " ", "of", " ", "log", 
           RowBox[{"(", 
            SubscriptBox["L", "i"], ")"}], " ", "\n", "\n", "bursts"}], " ", 
          "-", " ", 
          RowBox[{"list", " ", "of", " ", "bursts", " ", 
           RowBox[{"{", 
            RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}]}], ",", 
     " ", 
     RowBox[{
     "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
      "arrival", " ", "times", " ", "and", " ", "colors", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "c0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
       "t"}], "=", 
      RowBox[{
       RowBox[{"0", "\n", "n0List"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "photon", " ", "count", " ", "rates", " ", 
          "at", " ", "the", " ", "center", " ", "of", " ", "the", " ", 
          "laser", " ", "spot", "\n", "eList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
          RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
           RowBox[{"(", 
            RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"axy", "^", "2"}], "/", "d1"}], ",", 
             RowBox[{
              RowBox[{"axy", "^", "2"}], "/", "d2"}]}], "}"}], " ", "-", " ", 
           RowBox[{
           "difusion", " ", "times", " ", "in", " ", "the", " ", "elongated", 
            " ", "laser", " ", "spot", " ", 
            RowBox[{"(", 
             RowBox[{"axy", " ", "-", " ", 
              RowBox[{
              "lateral", " ", "size", " ", "of", " ", "the", " ", "spot"}]}], 
             ")"}], "\n", "kList"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
            RowBox[{
            "list", " ", "of", " ", "transition", " ", "rates", " ", "1"}]}], 
           "->", 
           RowBox[{
            RowBox[{"2", " ", "and", " ", "2"}], "->", 
            RowBox[{
             RowBox[{"1", "\n", "w"}], " ", "-", "  ", 
             RowBox[{"axial", " ", "ratio", " ", 
              RowBox[{"az", "/", "axy"}], " ", "\n", "bA"}]}]}]}]}]}]}]}]}], 
     ",", " ", 
     RowBox[{"bD", " ", "-", " ", 
      RowBox[{
      "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
       " ", "rates", "\n", "nTh"}], " ", "-", " ", 
      RowBox[{
      "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
       "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
     RowBox[{"N", ">=", 
      RowBox[{
       RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
     "  ", 
     RowBox[{
      RowBox[{"\[Tau]", "<", 
       RowBox[{"tTh", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", 
        SubscriptBox["a", "xy"]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["z", "max"], "/", 
          SubscriptBox["a", "z"]}], " ", "-", " ", 
         RowBox[{"max", " ", "value", " ", "of", "  ", 
          SubscriptBox["q", "r"]}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "/", 
           SubscriptBox["a", "xy"]}], " ", "and", " ", 
          SubscriptBox["q", "z"]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "/", 
             SubscriptBox["a", "z"]}], "\n", "jMax"}], " ", "-", " ", 
           RowBox[{
           "max", " ", "number", " ", "of", " ", "discret", " ", "points", 
            " ", "of", " ", 
            SubscriptBox["q", "r"]}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "/", 
             SubscriptBox["a", "xy"]}], " ", "and", " ", 
            SubscriptBox["q", "z"]}], "=", 
           RowBox[{"z", "/", 
            SubscriptBox["a", "z"]}]}]}]}]}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mNA", ",", "mND", ",", "mNATr", ",", "mNDTr", ",", "mRate", ",", "peq", 
      ",", "vals", ",", "vecs", ",", "mT", ",", "invT", ",", "valsZero", ",", 
      "zero", ",", "valsOmega", ",", "mM", ",", "valsM", ",", "vecsM", ",", 
      "pin", ",", "pf", ",", "norm", ",", "\n", "logNorm", ",", "p0", ",", 
      "px", ",", "nBursts", ",", "logLb", ",", "photonList", ",", "nPh", ",", 
      "f", ",", "phCountRate", ",", "sumLogScale", ",", "scale", ",", 
      "logL1"}], "\n", "}"}], ",", "\[IndentingNewLine]", "\n", 
    RowBox[{"(*", 
     RowBox[{"matrices", ";", " ", 
      RowBox[{"mRate", "=", 
       RowBox[{"L", "+", "K", "-", "NA", "-", "ND"}]}]}], "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mNA", ",", "mND", ",", "mRate", ",", "peq"}], "}"}], "=", 
      RowBox[{"matrices2Dyn2st", "[", 
       RowBox[{
       "n0List", ",", "eList", ",", "taudList", ",", "kList", ",", "w", ",", 
        "bA", ",", "bD", ",", "qMax", ",", "jMax"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", " ", 
        "mRate"}], "=", 
       RowBox[{"L", "+", "K", "-", "N"}]}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mRate", "]"}]}], ";", "\n", 
     RowBox[{"mT", "=", 
      RowBox[{"vecs", "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"invT", "=", 
      RowBox[{"Inverse", "[", "mT", "]"}]}], ";", 
     RowBox[{"(*", 
      SuperscriptBox["T", 
       RowBox[{"-", "1"}]], "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"matrix", " ", "M"}], " ", "*)"}], "\n", 
     RowBox[{"valsZero", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"vals", ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "zero"}], ",", "1"}], "]"}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"replace", " ", "eigenvalue"}], "=", 
       RowBox[{"0", " ", "by", " ", "zero"}]}], " ", "*)"}], "\n", 
     RowBox[{"valsOmega", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"vals", " ", "tTh"}], "]"}], "-", "1"}], ")"}], "/", 
         "valsZero"}], ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "tTh"}], ",", "1"}], "]"}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{
      "diagonal", " ", "elements", " ", "of", " ", "matrix", " ", 
       "\[CapitalOmega]"}], "*)"}], "\n", 
     RowBox[{"mM", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mNA", "+", "mND"}], ")"}], ".", "mT", ".", 
       RowBox[{"DiagonalMatrix", "[", "valsOmega", "]"}], ".", "invT"}]}], 
     ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "eigenvalues", " ", "and", " ", "eigenvectors", " ", "of", " ", 
       "matrix", " ", "M"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"valsM", ",", "vecsM"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mM", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"initial", " ", "and", " ", "final", " ", "vectors"}], "*)"}], 
     "\n", 
     RowBox[{"pin", "=", 
      RowBox[{"mT", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", "invT", ".", 
       "peq"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"vector", " ", 
       SubscriptBox["p", "in"]}], " ", "*)"}], "\n", 
     RowBox[{"pf", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"2", " ", 
          RowBox[{"jMax", "^", "2"}]}]}], "]"}], ".", "mT", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", "invT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"final", " ", "vector", " ", 
        SuperscriptBox[
         SubscriptBox["p", "f"], "T"]}], " ", ";", " ", 
       RowBox[{"dimension", " ", "of", " ", 
        SuperscriptBox["1", "T"], " ", "is", " ", "2", "*", 
        RowBox[{"jMax", "^", "2"}]}]}], " ", "*)"}], "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"normalization", " ", "factor", " ", "Z"}], "*)"}], "\n", 
     RowBox[{"norm", "=", 
      RowBox[{"pf", ".", 
       RowBox[{"vecsM", "\[Transpose]"}], ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"valsM", "^", 
          RowBox[{"(", 
           RowBox[{"nTh", "-", "1"}], ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "valsM"}], ")"}]}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"vecsM", "\[Transpose]"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"mNA", "+", "mND"}], ")"}], ".", "pin"}]}], ";", "\n", 
     RowBox[{"logNorm", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MachineNumberQ", "[", "norm", "]"}], "&&", 
         RowBox[{"norm", ">", "0"}]}], ",", 
        RowBox[{"Log", "[", "norm", "]"}], ",", "0"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"add", " ", "check", " ", "04.13", ".22"}], " ", "*)"}], "\n", 
     "\n", 
     RowBox[{"mNATr", "=", 
      RowBox[{"invT", ".", "mNA", ".", "mT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"transformed", " ", "count", " ", "rate", " ", "matrix"}], 
      "*)"}], "\n", 
     RowBox[{"mNDTr", "=", 
      RowBox[{"invT", ".", "mND", ".", "mT"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"transformed", " ", "count", " ", "rate", " ", "matrix"}], 
      "*)"}], "\n", "\n", 
     RowBox[{"p0", "=", 
      RowBox[{"invT", ".", "pin"}]}], ";", "\n", 
     RowBox[{"px", "=", 
      RowBox[{"pf", ".", "mT"}]}], ";", "\n", "\n", 
     RowBox[{"nBursts", "=", 
      RowBox[{"Length", "[", "bursts", "]"}]}], ";", "\n", 
     RowBox[{"logLb", "=", "0"}], ";", "\n", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{"(*", 
       RowBox[{"cycle", " ", "over", " ", "bursts"}], "*)"}], "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "log", " ", "likelihood", " ", "function", " ", "for", " ", "one", " ",
         "burst"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"photonList", "=", 
         RowBox[{"bursts", "[", 
          RowBox[{"[", "ib", "]"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "list", " ", "of", " ", "photons", " ", "in", " ", "burst", " ", 
          "ib"}], "*)"}], "\n", 
        RowBox[{"nPh", "=", 
         RowBox[{"Length", "[", "photonList", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "number", " ", "of", " ", "photons", " ", "in", " ", "a", " ", 
          "burst"}], "*)"}], "\n", "\n", 
        RowBox[{"phCountRate", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"photonList", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "==", "\"\<a\>\""}], ",",
            "mNATr", ",", "mNDTr"}], "]"}]}], ";", "\n", 
        RowBox[{"f", "=", 
         RowBox[{"phCountRate", ".", "p0"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"initial", " ", "vector", " ", 
          SuperscriptBox["\[CapitalPhi]T", 
           RowBox[{"-", "1"}]], 
          SubscriptBox["p", "in"]}], "  ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"sumLogScale", "=", "0"}], ";", "\n", 
        RowBox[{"logL1", "=", "0"}], ";", "\n", "\t", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", " ", 
          RowBox[{"cycle", " ", "over", " ", "photons"}], " ", "*)"}], "\n", 
         "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"phCountRate", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"photonList", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "==", 
               "\"\<a\>\""}], ",", "mNATr", ",", "mNDTr"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"f", "=", 
            RowBox[{"phCountRate", ".", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"Exp", "[", 
               RowBox[{"vals", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"photonList", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"photonList", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ")"}]}], " ", 
               "]"}], "]"}], ".", "f"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"scale", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"px", ".", "f"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"scaling", " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"scale", "!=", "0"}], ",", 
             RowBox[{
              RowBox[{"f", "=", 
               RowBox[{"f", "/", "scale"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{
               "divide", " ", "by", " ", "the", " ", "scaling", " ", 
                "factor"}], "*)"}], "\n", "\t\t\t", 
              RowBox[{"sumLogScale", "=", 
               RowBox[{"sumLogScale", "+", 
                RowBox[{"Log", "[", "scale", "]"}]}]}]}]}], 
            RowBox[{"(*", 
             RowBox[{
             "collect", " ", "Log", " ", "of", " ", "the", " ", "scaling", 
              " ", "factor"}], "*)"}], "\n", "\t\t\t", "]"}]}], ",", "\n", 
          "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nPh", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        "\n", "\t", 
        RowBox[{"logL1", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"px", ".", "f"}], "==", "0"}], ",", 
           RowBox[{"-", "100000"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"px", ".", "f"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"logL", " ", "for", " ", "1", " ", "burst"}], "*)"}], "\n", 
        "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "correction", " ", "for", " ", "scaling", " ", "factor", " ", "and", 
          " ", 
          RowBox[{"normalization", ":", "  ", 
           RowBox[{
            RowBox[{"log", 
             RowBox[{"(", "L", ")"}]}], "+", 
            RowBox[{"log", 
             RowBox[{"(", 
              RowBox[{"scaling", " ", "factor"}], ")"}]}], "-", 
            RowBox[{"log", 
             RowBox[{"(", "Z", ")"}]}]}]}]}], "*)"}], "\n", "\t", 
        RowBox[{"logLb", "=", 
         RowBox[{
         "logLb", "+", "logL1", "+", "sumLogScale", "-", "logNorm"}]}]}], ",",
        "\n", "\n", 
       RowBox[{"{", 
        RowBox[{"ib", ",", "nBursts"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\n", "logLb"}]}], "\n", "\n", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.832865111168004*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.8817536609745293`*^9, 3.881753665884922*^9}, {3.881754111701235*^9, 
   3.881754114606411*^9}, {3.881754158274505*^9, 3.881754246371973*^9}, 
   3.881754282931633*^9, 3.881754435531208*^9, 3.881755060054158*^9, {
   3.88175510950613*^9, 3.88175511092774*^9}, {3.881755188831781*^9, 
   3.881755189987852*^9}, {3.891604924448641*^9, 3.891604963537817*^9}, {
   3.8916066427386713`*^9, 3.8916067613400383`*^9}, {3.891606802129243*^9, 
   3.891606831201118*^9}, {3.89160686303356*^9, 3.891606871984393*^9}, {
   3.8916069639905777`*^9, 3.891607015362647*^9}, {3.8916070534642363`*^9, 
   3.891607149655608*^9}, {3.891607300692747*^9, 3.891607496834026*^9}, {
   3.891607585977884*^9, 3.891607650439767*^9}, {3.891607861954728*^9, 
   3.891607922151191*^9}, {3.891608313798629*^9, 3.891608333001147*^9}, {
   3.891608411302081*^9, 3.891608456651452*^9}, {3.891608496399453*^9, 
   3.891608496981966*^9}, {3.891608574153823*^9, 3.891608620367091*^9}, {
   3.891608668913911*^9, 3.891608681468054*^9}, {3.8916087161310987`*^9, 
   3.891608716281272*^9}, {3.8916088337434*^9, 3.891608835065474*^9}, {
   3.891608897079547*^9, 3.891608917092875*^9}, {3.891608957405655*^9, 
   3.891608980597269*^9}, {3.891609449600166*^9, 3.8916094705229397`*^9}, {
   3.8916802083275*^9, 3.8916802144265113`*^9}, {3.891680288063319*^9, 
   3.8916803055762*^9}, {3.8916803483638935`*^9, 3.8916803872583227`*^9}, {
   3.891680421122983*^9, 3.8916804267809143`*^9}, {3.891680458439831*^9, 
   3.891680459188297*^9}, {3.891967957893177*^9, 3.891968014364689*^9}, {
   3.891968071661301*^9, 3.8919681177098*^9}, {3.891968199133696*^9, 
   3.891968220901428*^9}, {3.892034275190954*^9, 3.8920342841057577`*^9}, 
   3.892545439021497*^9, {3.892546957627385*^9, 3.892547111385839*^9}, {
   3.892547149346948*^9, 3.892547284099257*^9}, {3.892547318280584*^9, 
   3.892547403182469*^9}, 3.892551792732707*^9, {3.892552436559166*^9, 
   3.892552482740876*^9}, {3.8925525428088937`*^9, 3.89255254369983*^9}, {
   3.892552578024344*^9, 3.8925525829244585`*^9}, {3.892552674162599*^9, 
   3.892552678154328*^9}, {3.9030280735634303`*^9, 3.903028281545851*^9}, {
   3.903028312542508*^9, 3.903028330373417*^9}, {3.9030283709003057`*^9, 
   3.9030283872998714`*^9}, {3.903028424120635*^9, 3.9030284405146685`*^9}, {
   3.9030285477040615`*^9, 3.903028549152386*^9}, 3.903028650667278*^9, {
   3.903083716987355*^9, 3.903083728991003*^9}, {3.903083967585611*^9, 
   3.9030839983297024`*^9}, {3.903084058086784*^9, 3.9030842277961206`*^9}, {
   3.903084358295407*^9, 3.9030843953737097`*^9}, {3.903084576647337*^9, 
   3.903084607648675*^9}, {3.903084654231759*^9, 3.9030846655442*^9}, {
   3.90308479539712*^9, 3.903084835978813*^9}, {3.9030848737127275`*^9, 
   3.903084955892508*^9}, {3.903085027931687*^9, 3.9030850284062166`*^9}, {
   3.9030851118887997`*^9, 3.903085141003768*^9}, {3.903085184931961*^9, 
   3.9030852168289022`*^9}, {3.90308526114161*^9, 3.9030853063151765`*^9}, {
   3.903085382130137*^9, 3.903085449505763*^9}, 3.903092650241167*^9, {
   3.903093160591522*^9, 3.903093180490673*^9}, 3.903093508209564*^9, 
   3.903093538725197*^9, {3.903106270551739*^9, 3.903106295291989*^9}, {
   3.903106332332185*^9, 3.9031063737631044`*^9}, {3.903106497451285*^9, 
   3.903106541359148*^9}, {3.903106632600363*^9, 3.9031066824591417`*^9}, {
   3.90311072404474*^9, 3.903110755880736*^9}, {3.903110818356362*^9, 
   3.903110834016085*^9}, {3.903110865785652*^9, 3.903110890230331*^9}, {
   3.903110923477373*^9, 3.90311092408607*^9}, {3.903111033702235*^9, 
   3.903111048551852*^9}, {3.903111083439268*^9, 3.903111099802769*^9}, {
   3.903111176504059*^9, 3.903111192664581*^9}, {3.903111240826522*^9, 
   3.903111260192346*^9}, 3.903111294508422*^9, 3.903111328748782*^9, {
   3.90311136250304*^9, 3.903111661904165*^9}, {3.903111698791114*^9, 
   3.903111752440998*^9}, {3.903111818276016*^9, 3.903111825034886*^9}, {
   3.903111856913656*^9, 3.903111872724266*^9}, {3.903111917615101*^9, 
   3.903111933421941*^9}, {3.903112007425363*^9, 3.903112051620674*^9}, {
   3.9031121098998938`*^9, 3.903112116236845*^9}, {3.9031125928985586`*^9, 
   3.903112602221198*^9}, 3.90311263812506*^9, {3.903112693064061*^9, 
   3.903112750606581*^9}, {3.903112797434248*^9, 3.903112838936903*^9}, {
   3.903112913095911*^9, 3.903112945026767*^9}, 3.903113008636104*^9, {
   3.903113156052796*^9, 3.903113165091595*^9}, 3.903113202883348*^9, 
   3.903113241001408*^9, {3.903113313905912*^9, 3.903113317514427*^9}, {
   3.90311336540439*^9, 3.903113417881259*^9}, {3.903113451128827*^9, 
   3.9031136384351435`*^9}, {3.9031137352560472`*^9, 3.903113742614521*^9}, {
   3.9031138427934*^9, 3.903113940541367*^9}, {3.903114011662487*^9, 
   3.903114073463874*^9}, {3.903114106821878*^9, 3.903114109408348*^9}, {
   3.903114330604081*^9, 3.903114417006131*^9}, {3.903114459906883*^9, 
   3.903114460690933*^9}, {3.903114506008356*^9, 3.903114506694095*^9}, {
   3.903159054505543*^9, 3.903159096456961*^9}, {3.903159139299298*^9, 
   3.9031591454707284`*^9}, {3.903159189209704*^9, 3.903159192923818*^9}, {
   3.903159229493097*^9, 3.9031592545348873`*^9}, {3.903159334474206*^9, 
   3.903159373820154*^9}, {3.903159419768257*^9, 3.9031594598009415`*^9}, {
   3.903159510867168*^9, 3.903159528957415*^9}, {3.903159808251084*^9, 
   3.9031598103889017`*^9}, {3.903159933176066*^9, 3.903159935640829*^9}, {
   3.903160038084881*^9, 3.90316010679628*^9}, 3.903160445418431*^9, {
   3.903849848493254*^9, 3.903849854869611*^9}, {3.90384991264387*^9, 
   3.903849939416622*^9}, {3.903849993531925*^9, 3.903850002723717*^9}, {
   3.9038500754311743`*^9, 3.903850113234015*^9}, {3.90385033209863*^9, 
   3.903850334990127*^9}, {3.903850580250118*^9, 3.9038506088922453`*^9}, {
   3.903850669069582*^9, 3.903850811699582*^9}, {3.903850847517099*^9, 
   3.903850861127475*^9}, {3.903851263073879*^9, 3.903851294939004*^9}, {
   3.9038514600709095`*^9, 3.903851460749038*^9}, {3.90585578988949*^9, 
   3.905855790403692*^9}, {3.9058558378271947`*^9, 3.905855959332815*^9}, {
   3.905856143468712*^9, 3.905856213372802*^9}, 3.905856670337045*^9, {
   3.9058586030653563`*^9, 3.905858603402552*^9}, {3.908981122593052*^9, 
   3.908981218625626*^9}, 3.90898133455*^9, {3.908981466235215*^9, 
   3.9089815056048603`*^9}, {3.908981554681784*^9, 3.908981566877445*^9}, {
   3.908981654985049*^9, 3.908981670069099*^9}, {3.908981701944557*^9, 
   3.908981902372363*^9}, {3.9089829271347165`*^9, 3.9089829308466687`*^9}, {
   3.908982976848345*^9, 3.908982977437548*^9}, {3.908990271456729*^9, 
   3.9089903217716875`*^9}, {3.908990649433656*^9, 3.908990673652654*^9}, {
   3.927970117270211*^9, 3.927970168728943*^9}, {3.9279707755784*^9, 
   3.927970777254999*^9}, {3.941543205178055*^9, 3.9415432065336*^9}, {
   3.9415432399590263`*^9, 3.9415433224663525`*^9}, {3.941543366609991*^9, 
   3.9415434509134483`*^9}, {3.9415434988864613`*^9, 
   3.9415434992723064`*^9}, {3.941543954657898*^9, 3.941543954880743*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"ff5ea0f9-b4d3-5d4b-bd9f-ac613105da59"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["findMaxLDBurstML2Dyn2st",
  FontWeight->"Bold"],
 "[bursts_,{n0List_,eList_,taudIniList_,kList_},w_,bA_,bD_,nTh_,tTh_,qMax_,\
jMax_] -- finds  burstML2 diffusion times  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"taud1", ",", "taud2"}], "}"}], " "}], TraditionalForm]],
  ExpressionUUID->"9e3b4a70-8a9f-ff48-baa8-095e745a76d4"],
 " in the elongated laser spot   starting  from the  initial values ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox[" ",
     FontSlant->"Italic"], 
    RowBox[{
     StyleBox["taudIniList",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["taud1", "ini"], ",", 
       SubscriptBox["taud2", "ini"]}], "}"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f538237e-f32a-2e4a-8f67-6473f87bb7de"],
 " with other parameters fixed to previously found values  ",
 StyleBox[" ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["n0List",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{"n01", ",", "n02"}], "}"}]}], ",", " ", 
    RowBox[{
     StyleBox["eList",
      FontSlant->"Italic"], "=", 
     RowBox[{"{", 
      RowBox[{"e1", ",", "e2"}], "}"}]}], ",", 
    StyleBox[
     RowBox[{
      StyleBox[" ",
       FontSlant->"Italic"], " "}]], 
    RowBox[{
     RowBox[{"and", " ", 
      StyleBox["kList",
       FontSlant->"Italic"]}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "."}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6e575e53-5f28-864d-a821-9239f3d9d597"]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.903085703052754*^9, 3.9030857039156075`*^9}, {
   3.903092367313337*^9, 3.90309237381822*^9}, {3.903106203921193*^9, 
   3.903106251551284*^9}, {3.9031605061767006`*^9, 3.903160509306374*^9}, {
   3.90316221172743*^9, 3.903162240477569*^9}, {3.9031746832821255`*^9, 
   3.903174691620724*^9}, {3.903431747146159*^9, 3.903431747650889*^9}, {
   3.905856374201981*^9, 3.905856388888581*^9}, {3.905856451347069*^9, 
   3.905856484393965*^9}, 3.905856996954687*^9, {3.905857267506431*^9, 
   3.905857313982065*^9}, 3.908895287990032*^9, 3.908981063158039*^9, {
   3.908981932152182*^9, 3.908981940331438*^9}, {3.908982031732468*^9, 
   3.908982062340473*^9}, 3.9089821909024954`*^9, {3.927970008157543*^9, 
   3.9279700351841755`*^9}, 3.927970087759335*^9, {3.9302201163359013`*^9, 
   3.9302201167420807`*^9}, 3.93022023662294*^9, {3.930222218289812*^9, 
   3.930222228440857*^9}, {3.9303082680107822`*^9, 3.930308269363457*^9}, {
   3.941219506191166*^9, 3.9412195340312805`*^9}, {3.941281113977583*^9, 
   3.941281306617441*^9}, {3.9412813808095646`*^9, 3.9412814267947655`*^9}},
 FontSize->14,ExpressionUUID->"d0a4e92f-02c8-ba44-af5a-dc4f0b8f56b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findMaxLDBurstML2Dyn2st", "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{"n0List_", ",", "eList_", ",", "taudIniList_", ",", "kList_"}], 
     "}"}], ",", "w_", ",", "bA_", ",", "bD_", ",", "nTh_", ",", "tTh_", ",", 
    "qMax_", ",", "jMax_"}], "]"}], ":=", "\n", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"November", " ", "14"}], ",", " ", 
    RowBox[{
     RowBox[{
     "2023", "\n", "\n", "find", " ", "Maximum", " ", "Likelihood", " ", 
      "DIFFUSION", " ", "TIMES", "  ", "\n", "diffusing", " ", "molecule", 
      " ", "undergoing", " ", "2"}], "-", 
     RowBox[{
     "state", " ", "transitions", "\n", "2", " ", "discretized", " ", 
      "coordinates", "\n", "\n", 
      RowBox[{"return", ":", " ", 
       RowBox[{
        RowBox[{"diffusion", " ", "times", " ", 
         RowBox[{"{", 
          RowBox[{"taud1ML", ",", "taud2ML"}], "}"}], " ", "in", " ", "the", 
         " ", "elongated", " ", "laser", " ", "spot", " ", 
         RowBox[{
          RowBox[{"axy", "^", "2"}], "/", "d1"}], " ", 
         RowBox[{"(", 
          RowBox[{"axy", " ", "-", " ", 
           RowBox[{
           "lateral", " ", "size", " ", "of", " ", "the", " ", "spot"}]}], 
          ")"}], "\n", "\n", "bursts"}], " ", "-", " ", 
        RowBox[{"list", " ", "of", " ", "bursts", " ", 
         RowBox[{"{", 
          RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}], ",", " ", 
    RowBox[{
    "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
     "arrival", " ", "times", " ", "and", " ", "colors", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "c0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
      "t"}], "=", 
     RowBox[{
      RowBox[{"0", "\n", "n0List"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
        RowBox[{
        "list", " ", "of", " ", "photon", " ", "count", " ", "rates", " ", 
         "at", " ", "the", " ", "center", " ", "of", " ", "the", " ", "laser",
          " ", "spot", "\n", "eList"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
         RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
          RowBox[{"(", 
           RowBox[{"without", " ", "BN"}], ")"}], "\n", "taudIniList"}]}], 
        "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"axy", "^", "2"}], "/", "d1"}], ",", 
            RowBox[{
             RowBox[{"axy", "^", "2"}], "/", "d2"}]}], "}"}], " ", "-", " ", 
          RowBox[{
          "initial", " ", "guess", " ", "for", " ", "the", " ", "difusion", 
           " ", "times", " ", "\n", "kList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
           RowBox[{
           "list", " ", "of", " ", "transition", " ", "rates", " ", "1"}]}], "->", 
          RowBox[{
           RowBox[{"2", " ", "and", " ", "2"}], "->", 
           RowBox[{
            RowBox[{"1", "\n", "w"}], " ", "-", "  ", 
            RowBox[{"axial", " ", "ratio", " ", 
             RowBox[{"az", "/", "axy"}], " ", "\n", "bA"}]}]}]}]}]}]}]}]}], 
    ",", " ", 
    RowBox[{"bD", " ", "-", " ", 
     RowBox[{
     "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
      " ", "rates", "\n", "nTh"}], " ", "-", " ", 
     RowBox[{
     "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
      "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
    RowBox[{"N", ">=", 
     RowBox[{
      RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
      RowBox[{"threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}],
     ",", "  ", 
    RowBox[{
     RowBox[{"\[Tau]", "<", 
      RowBox[{"tTh", "\n", "qMax"}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["r", "max"], "/", 
       SubscriptBox["a", "xy"]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["z", "max"], "/", 
         SubscriptBox["a", "z"]}], " ", "-", " ", 
        RowBox[{"max", " ", "value", " ", "of", "  ", 
         SubscriptBox["q", "r"]}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "/", 
          SubscriptBox["a", "xy"]}], " ", "and", " ", 
         SubscriptBox["q", "z"]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"z", "/", 
            SubscriptBox["a", "z"]}], "\n", "jMax"}], " ", "-", " ", 
          RowBox[{
          "max", " ", "number", " ", "of", " ", "discret", " ", "points", " ",
            "of", " ", 
           SubscriptBox["q", "r"]}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "/", 
            SubscriptBox["a", "xy"]}], " ", "and", " ", 
           SubscriptBox["q", "z"]}], "=", 
          RowBox[{"z", "/", 
           SubscriptBox["a", "z"]}]}]}]}]}]}]}]}], "\n", "*)"}], "\n", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iniGuess", ",", "pars", ",", "parsGuess", ",", "xn01", ",", "xn02", ",",
       "xe1", ",", "xe2", ",", "xtaud1", ",", "xtaud2", ",", "xk1", ",", 
      "xk2", ",", "sol", ",", "ff", ",", "result"}], "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"pars", "=", 
      RowBox[{"{", 
       RowBox[{"xtaud1", ",", "xtaud2"}], "}"}]}], ";", 
     RowBox[{"(*", " ", "parameters", "*)"}], "\n", "\n", 
     RowBox[{"iniGuess", "=", 
      RowBox[{"Log", "[", "taudIniList", "]"}]}], ";", "\n", "\n", 
     RowBox[{"parsGuess", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pars", ",", "iniGuess"}], "}"}], "\[Transpose]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"list", " ", "of", " ", 
       RowBox[{"{", 
        RowBox[{"var_i", ",", "guess_i"}], "}"}]}], " ", "*)"}], "\n", "\n", 
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{"xtaud1_Real", ",", "xtaud2_Real"}], "]"}], " ", ":=", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"it", "'"}], "s", " ", "important", " ", "to", " ", "have", 
        " ", "_Real", " ", "to", " ", "prevent", " ", "analytical", " ", 
        "evaluation"}], " ", "*)"}], "\n", 
      RowBox[{
       StyleBox["logLBurstML2Dyn2st",
        FontWeight->"Bold"], "[", 
       RowBox[{"bursts", ",", 
        RowBox[{"{", 
         RowBox[{"n0List", ",", "eList", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", "xtaud1", "]"}], ",", 
            RowBox[{"Exp", "[", "xtaud2", "]"}]}], "}"}], ",", "kList"}], 
         "}"}], ",", "w", ",", "bA", ",", "bD", ",", "nTh", ",", "tTh", ",", 
        "qMax", ",", "jMax"}], "]"}]}], ";", "\n", " ", "\n", "\n", 
     RowBox[{"sol", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", "=", "0"}], "}"}], ",", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"FindMaximum", "[", 
           RowBox[{
            RowBox[{"ff", "@@", "pars"}], ",", "parsGuess", ",", 
            RowBox[{"AccuracyGoal", "->", "4"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "4"}], ",", "\n", "\t", 
            RowBox[{"StepMonitor", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"c", "++"}], 
              RowBox[{"(*", 
               RowBox[{";", "\n", "\t\t", 
                RowBox[{"Print", "[", 
                 RowBox[{"Now", ",", "\"\< c= \>\"", ",", "c"}], "]"}]}], " ",
                "*)"}], " ", ")"}]}]}], "\n", "\t\t   ", "]"}], ",", " ", 
          "c"}], "   ", "}"}]}], "]"}]}], ";", "\n", " ", "\n", " ", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"{", 
         RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], "]"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", "\n", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  LogLikelihood= \>\"", ",", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<   steps=\>\"", ",",
        " ", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<  (\!\(\*SubscriptBox[\(\[Tau]\), \(d1\)]\),\!\(\*SubscriptBox[\(\
\[Tau]\), \(d2\)]\)) = \>\"", ",", "result"}], "]"}], ";", "\n", "result"}]}],
    "\n", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.433174731898714*^9, 3.4331748017758*^9}, 
   3.4331748502146606`*^9, {3.4331752268899417`*^9, 3.433175389285827*^9}, {
   3.433175426750022*^9, 3.433175578497192*^9}, {3.433175613711659*^9, 
   3.43317563175634*^9}, {3.433175985641314*^9, 3.433175989453423*^9}, {
   3.433176065773733*^9, 3.4331760725542884`*^9}, {3.433177858350347*^9, 
   3.4331779858693542`*^9}, 3.4331781434792223`*^9, {3.433178191037156*^9, 
   3.433178203457838*^9}, 3.433178378175439*^9, 3.433179517687674*^9, 
   3.4331824504290185`*^9, 3.4331824898319902`*^9, {3.4331827796672487`*^9, 
   3.433182785229286*^9}, 3.433182912437452*^9, {3.433182971729393*^9, 
   3.433182994985692*^9}, {3.4331831912347164`*^9, 3.4331831926726675`*^9}, {
   3.433183363438343*^9, 3.433183366532291*^9}, {3.433243912803263*^9, 
   3.4332439185223074`*^9}, {3.433243956664883*^9, 3.43324402112131*^9}, {
   3.433244061467126*^9, 3.433244222938886*^9}, {3.433247903739778*^9, 
   3.4332484822113533`*^9}, {3.4332485763323245`*^9, 3.433248646912972*^9}, {
   3.433248734209266*^9, 3.433248784340585*^9}, {3.433248860844732*^9, 
   3.433248994562719*^9}, {3.4332490745311947`*^9, 3.433249075765807*^9}, 
   3.4332495161464424`*^9, {3.433250184167661*^9, 3.4332502012153006`*^9}, {
   3.433250233201108*^9, 3.433250263420065*^9}, {3.4332509179493504`*^9, 
   3.4332509873507137`*^9}, {3.433251027667939*^9, 3.433251033277996*^9}, {
   3.433251152620631*^9, 3.433251153245707*^9}, {3.4332512183317456`*^9, 
   3.4332512702443075`*^9}, {3.433251641590469*^9, 3.433251665870942*^9}, {
   3.4332519264556203`*^9, 3.4332519287055054`*^9}, {3.433252491669583*^9, 
   3.4332525428261604`*^9}, {3.433259474469654*^9, 3.4332594779070663`*^9}, {
   3.4332596962921*^9, 3.433259700073253*^9}, {3.433259758899873*^9, 
   3.433259762102916*^9}, {3.433259851163135*^9, 3.433259863069081*^9}, {
   3.433259988565868*^9, 3.433260104078536*^9}, {3.4332604765415144`*^9, 
   3.433260479385537*^9}, {3.433260513043297*^9, 3.433260516184004*^9}, {
   3.433260623983638*^9, 3.433260627343099*^9}, 3.4332606819851227`*^9, 
   3.4332607192985783`*^9, {3.433260896549661*^9, 3.433260900893384*^9}, {
   3.433260958236767*^9, 3.433260965814843*^9}, {3.4332609985333843`*^9, 
   3.43326100072087*^9}, {3.43326110907942*^9, 3.433261114876221*^9}, 
   3.4332612352028065`*^9, {3.433261368763597*^9, 3.4332613876071053`*^9}, {
   3.4332616536505747`*^9, 3.433261721446372*^9}, {3.4332619185050883`*^9, 
   3.433261942738998*^9}, {3.433262015768846*^9, 3.4332620808925953`*^9}, {
   3.4332621422039185`*^9, 3.4332621449069915`*^9}, {3.4332622016715264`*^9, 
   3.433262209499501*^9}, {3.433262528868369*^9, 3.433262546164912*^9}, {
   3.433262599429514*^9, 3.433262615101088*^9}, 3.4332626591939917`*^9, {
   3.433265210083069*^9, 3.433265212489319*^9}, {3.433413659175805*^9, 
   3.433413718971788*^9}, {3.433413767781973*^9, 3.433413773289893*^9}, {
   3.4334139217033*^9, 3.43341393064616*^9}, {3.433413993927153*^9, 
   3.433414001447968*^9}, {3.43341407794797*^9, 3.433414111085619*^9}, {
   3.443003228231954*^9, 3.443003232488072*^9}, {3.443003263252309*^9, 
   3.443003357147323*^9}, {3.443003400599805*^9, 3.443003433036446*^9}, {
   3.44300348111558*^9, 3.443003538177635*^9}, {3.4430036156991024`*^9, 
   3.4430037081520452`*^9}, {3.443003741960658*^9, 3.443003894179538*^9}, 
   3.443003968816861*^9, {3.443004013320854*^9, 3.4430040565930786`*^9}, {
   3.4430041005763216`*^9, 3.443004355733219*^9}, {3.44300439620141*^9, 
   3.443004418773867*^9}, {3.443006271347739*^9, 3.443006281292037*^9}, {
   3.44303528461677*^9, 3.443035372032467*^9}, {3.4430354113089437`*^9, 
   3.4430354869076495`*^9}, {3.443035824032411*^9, 3.443035862247364*^9}, {
   3.443203204508971*^9, 3.4432032234916453`*^9}, {3.443203265066045*^9, 
   3.443203276002565*^9}, {3.443203311858727*^9, 3.443203317061386*^9}, {
   3.443267775018227*^9, 3.443267868873184*^9}, {3.4432683246485567`*^9, 
   3.443268449407953*^9}, {3.443268483667214*^9, 3.443268639481264*^9}, {
   3.443268698986829*^9, 3.443268846528984*^9}, {3.4432688814592113`*^9, 
   3.443268909599675*^9}, {3.443269020669386*^9, 3.443269032356191*^9}, {
   3.44326918958227*^9, 3.443269223601187*^9}, 3.443269264329752*^9, {
   3.443269299530368*^9, 3.4432692997106276`*^9}, {3.4432695569405055`*^9, 
   3.4432697116930285`*^9}, {3.443269768034044*^9, 3.443270100742455*^9}, {
   3.443270130995957*^9, 3.4432701374452305`*^9}, {3.443270425219028*^9, 
   3.443270438007418*^9}, {3.4432711692088337`*^9, 3.443271172743917*^9}, {
   3.443271357149079*^9, 3.443271360644104*^9}, {3.443271473977069*^9, 
   3.443271483781166*^9}, {3.443271547853299*^9, 3.443271550016408*^9}, {
   3.443271607218661*^9, 3.443271607589194*^9}, 3.4432716662235055`*^9, {
   3.4432717842632384`*^9, 3.4432718136054306`*^9}, {3.44327185209077*^9, 
   3.443271938044365*^9}, {3.443272011039327*^9, 3.443272012841919*^9}, {
   3.443273603318912*^9, 3.443273618801174*^9}, {3.44327459219084*^9, 
   3.4432745923711*^9}, {3.443306840428389*^9, 3.443306840859008*^9}, {
   3.4433069377883854`*^9, 3.443306940281971*^9}, {3.443310493971927*^9, 
   3.443310507972062*^9}, {3.443371422729501*^9, 3.443371427401286*^9}, {
   3.4433786470688753`*^9, 3.443378704739643*^9}, {3.443379063123388*^9, 
   3.4433791199347963`*^9}, {3.443448210761333*^9, 3.443448213084674*^9}, {
   3.4437852250745025`*^9, 3.4437852607157516`*^9}, {3.444009842443077*^9, 
   3.444010181791035*^9}, {3.444010527608296*^9, 3.444010536200651*^9}, {
   3.444010656022948*^9, 3.444010658997224*^9}, 3.444010946009928*^9, {
   3.444036149040715*^9, 3.444036362848155*^9}, 3.4440364509548464`*^9, {
   3.4440364964102077`*^9, 3.4440365268840275`*^9}, {3.444036597395419*^9, 
   3.444036597675821*^9}, {3.4440366811057873`*^9, 3.4440366847410145`*^9}, 
   3.444037233650307*^9, {3.444037698388568*^9, 3.444037771083098*^9}, {
   3.444037978851855*^9, 3.4440380538897533`*^9}, 3.444038240818544*^9, {
   3.44424034572138*^9, 3.444240451613644*^9}, {3.4442404848514385`*^9, 
   3.4442405194211473`*^9}, {3.444240571516056*^9, 3.4442406467842865`*^9}, {
   3.444240687623009*^9, 3.44424075155494*^9}, 3.4442408256915426`*^9, 
   3.444242353608579*^9, {3.4442423869164734`*^9, 3.444242388568847*^9}, {
   3.444242926372173*^9, 3.444242964517022*^9}, {3.444243792006894*^9, 
   3.444243793599184*^9}, {3.4442438650919857`*^9, 3.444243865282259*^9}, {
   3.444245668495152*^9, 3.444245685159114*^9}, {3.4442469111520047`*^9, 
   3.444246913936008*^9}, {3.4442509469752336`*^9, 3.444250995905592*^9}, {
   3.444253554434576*^9, 3.4442536269288177`*^9}, {3.4442536680379295`*^9, 
   3.444253907181802*^9}, {3.444254454088214*^9, 3.444254474006856*^9}, {
   3.44425460654744*^9, 3.4442546346378317`*^9}, {3.444254790201522*^9, 
   3.4442548194635983`*^9}, {3.444254868474072*^9, 3.444254941849581*^9}, {
   3.4443051139888*^9, 3.4443053107827997`*^9}, {3.4443053411247997`*^9, 
   3.444305341312001*^9}, {3.4443053795164003`*^9, 3.444305431792*^9}, 
   3.4443056166208*^9, {3.4443058145536003`*^9, 3.4443058420408*^9}, {
   3.4443200034812*^9, 3.4443200739308*^9}, {3.4443206560448*^9, 
   3.444320747102*^9}, {3.444320818487602*^9, 3.4443208945688*^9}, {
   3.444320972912002*^9, 3.4443210547028*^9}, {3.444321099818*^9, 
   3.444321145182801*^9}, {3.4443212205152*^9, 3.4443212317940006`*^9}, {
   3.444321277782802*^9, 3.444321447682411*^9}, {3.44432149169*^9, 
   3.444321647846002*^9}, {3.4443216945056*^9, 3.444321721634*^9}, {
   3.4443221059712*^9, 3.4443221180144*^9}, {3.444322168964*^9, 
   3.444322187122401*^9}, {3.4443223214228*^9, 3.4443223381304*^9}, {
   3.4443223820132*^9, 3.4443224359736*^9}, {3.444322488374*^9, 
   3.444322525970001*^9}, {3.4443226381496*^9, 3.4443226502864*^9}, {
   3.444322681424*^9, 3.4443226830620003`*^9}, 3.444323302116801*^9, {
   3.444323715688401*^9, 3.4443238062308*^9}, {3.4443241067492*^9, 
   3.4443241129268*^9}, {3.4443241933136*^9, 3.4443241983992*^9}, {
   3.444324586714401*^9, 3.4443246188972*^9}, {3.4443249093068*^9, 
   3.44432491082*^9}, {3.444324984062001*^9, 3.4443249910352*^9}, {
   3.4443253174808*^9, 3.444325322254401*^9}, {3.4443255111704*^9, 
   3.4443255170672*^9}, {3.444325557736401*^9, 3.4443255889364*^9}, {
   3.4443256836596003`*^9, 3.4443256899932*^9}, {3.4443258190364*^9, 
   3.4443258382868*^9}, {3.4443261446396*^9, 3.4443261506924*^9}, {
   3.444326282075601*^9, 3.4443263072852*^9}, {3.44432640452*^9, 
   3.4443264047696*^9}, {3.4443264838304*^9, 3.4443264897584*^9}, {
   3.4443266688932*^9, 3.444326715974*^9}, {3.4443269305987997`*^9, 
   3.4443271358792*^9}, {3.4443271708388*^9, 3.4443272367488003`*^9}, {
   3.4443272804288*^9, 3.4443273091952*^9}, {3.4443276386984*^9, 
   3.444327657917601*^9}, {3.451073551880951*^9, 3.451074008025193*^9}, {
   3.45107412054484*^9, 3.451074153242594*^9}, {3.6495058503872595`*^9, 
   3.649505925854395*^9}, {3.649506089455983*^9, 3.6495061633358784`*^9}, {
   3.649506271556322*^9, 3.649506340933591*^9}, {3.6495063795022745`*^9, 
   3.649506402786371*^9}, {3.649506447395487*^9, 3.6495064545405617`*^9}, {
   3.64950648945411*^9, 3.64950659640064*^9}, {3.649506638519121*^9, 
   3.649506753689676*^9}, {3.649506797674204*^9, 3.649506842780961*^9}, {
   3.649510821495474*^9, 3.649510853199487*^9}, {3.649511010697929*^9, 
   3.649511090112966*^9}, 3.649517061579792*^9, {3.649519124582498*^9, 
   3.649519142913183*^9}, {3.649519197185988*^9, 3.649519197554199*^9}, {
   3.649519244013522*^9, 3.649519367843764*^9}, {3.649519404542986*^9, 
   3.649519441365047*^9}, {3.649519738090479*^9, 3.649519738668502*^9}, {
   3.649519888450616*^9, 3.64951989560342*^9}, {3.649519954337479*^9, 
   3.6495199548900976`*^9}, {3.649520020348387*^9, 3.6495200206814*^9}, {
   3.649520072007486*^9, 3.649520072389704*^9}, {3.649520201156981*^9, 
   3.649520202415618*^9}, {3.649522101137873*^9, 3.64952210920728*^9}, {
   3.649683199514022*^9, 3.649683199919643*^9}, {3.650199857770801*^9, 
   3.650199971132035*^9}, {3.832175269285937*^9, 3.83217540092506*^9}, {
   3.832175449107063*^9, 3.83217546894007*^9}, {3.832175508988351*^9, 
   3.832175510428855*^9}, {3.832175619604785*^9, 3.832175699090195*^9}, {
   3.8321757467902584`*^9, 3.832175878488613*^9}, {3.8321759452636333`*^9, 
   3.832175960176182*^9}, {3.832176009756401*^9, 3.832176101117436*^9}, {
   3.8321762129372463`*^9, 3.832176296725668*^9}, {3.832181582270059*^9, 
   3.8321815988445215`*^9}, {3.832182500533687*^9, 3.8321825210025043`*^9}, {
   3.832690691929723*^9, 3.832690713842759*^9}, {3.833375099369354*^9, 
   3.8333751581918583`*^9}, {3.833375769459081*^9, 3.833375824154202*^9}, {
   3.833375899366909*^9, 3.833375953098981*^9}, {3.8333775237998533`*^9, 
   3.8333775260094876`*^9}, {3.833378938207533*^9, 3.833378939536157*^9}, {
   3.8333824694568777`*^9, 3.833382471697551*^9}, {3.833475370136609*^9, 
   3.8334755480508423`*^9}, {3.833475578274836*^9, 3.833475583789635*^9}, {
   3.8334756216713505`*^9, 3.8334756227315364`*^9}, {3.833475880557568*^9, 
   3.8334760263169413`*^9}, {3.833476190801937*^9, 3.833476191496004*^9}, {
   3.833476747332479*^9, 3.8334767618430605`*^9}, {3.833520698294158*^9, 
   3.83352069902828*^9}, {3.835883765865997*^9, 3.835883817185582*^9}, {
   3.838199835313685*^9, 3.838199886176677*^9}, {3.838199919449819*^9, 
   3.838199926980713*^9}, {3.838199964013732*^9, 3.838200031196338*^9}, {
   3.838200071347412*^9, 3.83820009397417*^9}, {3.8382001739713154`*^9, 
   3.838200174289799*^9}, {3.838200229985332*^9, 3.838200273575391*^9}, {
   3.838200347250709*^9, 3.838200438723737*^9}, {3.838200573418236*^9, 
   3.8382006162643557`*^9}, {3.838200663218891*^9, 3.838200691741475*^9}, {
   3.8382007271328344`*^9, 3.8382007692241373`*^9}, {3.838200804252232*^9, 
   3.838200849893202*^9}, {3.838200905309663*^9, 3.8382009942563143`*^9}, {
   3.838202344233166*^9, 3.838202403466142*^9}, {3.83820243541568*^9, 
   3.838202455252605*^9}, {3.838225534215794*^9, 3.838225547608734*^9}, {
   3.838225584394644*^9, 3.8382255895813627`*^9}, {3.838225620402735*^9, 
   3.838225842256416*^9}, {3.8382258798199677`*^9, 3.838225884006722*^9}, 
   3.838233799260332*^9, 3.838233846575987*^9, {3.83849936612654*^9, 
   3.838499371516123*^9}, {3.8389888918785963`*^9, 3.838988938448218*^9}, {
   3.838989029161618*^9, 3.838989030516458*^9}, {3.8389892644627013`*^9, 
   3.838989268094435*^9}, {3.8389893583146906`*^9, 3.8389893636145535`*^9}, {
   3.8389893983952827`*^9, 3.8389894182164087`*^9}, {3.8389894718624887`*^9, 
   3.838989472866091*^9}, {3.8389903595411634`*^9, 3.838990375041841*^9}, {
   3.83899084864199*^9, 3.8389909015566683`*^9}, {3.838990945858148*^9, 
   3.838990990313569*^9}, {3.8389922381985703`*^9, 3.838992238700706*^9}, {
   3.838992274044245*^9, 3.838992291832813*^9}, 3.858825210051225*^9, 
   3.858825251162944*^9, {3.8595289906369977`*^9, 3.8595290257492743`*^9}, {
   3.8595290649068317`*^9, 3.859529092642331*^9}, {3.859529147131908*^9, 
   3.859529277063673*^9}, {3.859529318687151*^9, 3.859529395928039*^9}, {
   3.859529428133568*^9, 3.859529505337983*^9}, 3.8595295366557336`*^9, {
   3.8606036751707664`*^9, 3.860603751596614*^9}, {3.903160375152404*^9, 
   3.90316047051741*^9}, {3.903160543640393*^9, 3.903160697124632*^9}, {
   3.903160763456727*^9, 3.903160773185354*^9}, {3.903160810035997*^9, 
   3.903160831337974*^9}, {3.903161734151884*^9, 3.903161858402134*^9}, {
   3.903161939850464*^9, 3.903162006417585*^9}, {3.9031620960830317`*^9, 
   3.903162098154546*^9}, {3.903431851864744*^9, 3.903431863821458*^9}, 
   3.903431905816778*^9, {3.9034326605798807`*^9, 3.903432665224945*^9}, {
   3.90585639558867*^9, 3.905856421043781*^9}, {3.905856489492818*^9, 
   3.9058566618214903`*^9}, {3.905856703725966*^9, 3.905856813238196*^9}, {
   3.905856846474496*^9, 3.905856890574945*^9}, {3.905857150423545*^9, 
   3.905857151265284*^9}, {3.905857229663474*^9, 3.905857253880565*^9}, {
   3.905857354817851*^9, 3.905857385057984*^9}, 3.906049573322347*^9, {
   3.9061275002439218`*^9, 3.9061275363125806`*^9}, 3.90612770669826*^9, {
   3.906128011473704*^9, 3.9061280170017834`*^9}, {3.908982199152936*^9, 
   3.9089823764847507`*^9}, {3.9089824488001986`*^9, 3.908982501881609*^9}, {
   3.908982954416481*^9, 3.908982956299775*^9}, {3.90899102811498*^9, 
   3.908991036705425*^9}, {3.927970193062292*^9, 3.927970215877844*^9}, {
   3.930308276059147*^9, 3.9303082772612743`*^9}, {3.9415434813738804`*^9, 
   3.941543482013958*^9}, {3.941544032653019*^9, 3.94154406189657*^9}, {
   3.941544136951502*^9, 3.9415442645037746`*^9}, {3.941544314533972*^9, 
   3.941544319589382*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"e70c34f4-b0ad-cf4e-a88a-d3bc185ce3c7"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["stdDBurstML2Dyn2st",
  FontWeight->"Bold"],
 "[bursts_,mlPar_,w_,bA_,bD_,nTh_,tTh_,qMax_,jMax_]--  standard deviations of \
the burstML2 diffusion times {taud1,taud2} estimated near the maximum  ",
 StyleBox["mlPar",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["n01", "ml"], ",", 
        SuperscriptBox["n02", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["e1", "ml"], ",", 
        SuperscriptBox["e2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["taud1", "ml"], ",", 
        SuperscriptBox["taud2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["k1", "ml"], ",", 
        SuperscriptBox["k2", "ml"]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bd90e609-8a8a-5c41-850e-14c84a9ccbcf"],
 "}}."
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.9030856804809084`*^9, 3.903085699630611*^9}, {
   3.903085776131449*^9, 3.903085832711562*^9}, {3.9030872060587616`*^9, 
   3.9030872336325216`*^9}, {3.903162267887575*^9, 3.903162290689946*^9}, {
   3.90585693918111*^9, 3.905856992613795*^9}, {3.905857402671895*^9, 
   3.905857405390843*^9}, 3.908981066134163*^9, 3.908982533096601*^9, {
   3.927970054724997*^9, 3.927970068192058*^9}, 3.92797010189592*^9, 
   3.9302202139240627`*^9, 3.941219541463663*^9, {3.9412814855937996`*^9, 
   3.941281505353588*^9}, 3.941281698691414*^9},
 FontSize->14,ExpressionUUID->"a93004d3-e42a-904a-8ed9-10d9b4d9d5c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox[
     RowBox[{"stdD", 
      StyleBox["BurstML2Dyn2st",
       FontWeight->"Bold"]}]], "[", 
    RowBox[{
    "bursts_", ",", "mlPar_", ",", "w_", ",", "bA_", ",", "bD_", ",", "nTh_", 
     ",", "tTh_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{" ", 
         RowBox[{
          RowBox[{"June", " ", "21"}], ",", " ", 
          RowBox[{
           RowBox[{
           "2024", "\n", "Standard", " ", "deviation", " ", "of", " ", "the", 
            " ", "DIFFUSION", " ", "TIMES", " ", 
            RowBox[{"{", 
             RowBox[{"taud1", ",", "taud2"}], "}"}], " ", "in", " ", 
            "burstML2", "\n", "diffusing", " ", "molecule", " ", "undergoing",
             " ", "2"}], "-", 
           RowBox[{
           "state", " ", "transitions", "\n", "2", " ", "discretized", " ", 
            "coordinates", "\n", "\[IndentingNewLine]", 
            RowBox[{"return", ":", " ", 
             RowBox[{
              RowBox[{
              "standard", " ", "deviations", " ", "of", " ", "the", " ", 
               "burstML2", " ", "diffusion", " ", "times", " ", 
               RowBox[{"{", 
                RowBox[{"sydtaud1", ",", "stdtaud2"}], "}"}], "\n", "\n", 
               "bursts"}], " ", "-", " ", 
              RowBox[{"list", " ", "of", " ", "bursts", " ", 
               RowBox[{"{", 
                RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}], ",", 
          " ", 
          RowBox[{
          "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", 
           " ", "arrival", " ", "times", " ", "and", " ", "colors", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "c0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", 
             " ", "t"}], "=", 
            RowBox[{
             RowBox[{"0", "\n", "mlPar"}], " ", "-", " ", 
             RowBox[{"ML", " ", "parameters", "  ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n01ML", ",", " ", "n02ML"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"e1ML", ",", " ", "e2ML"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"td1ML", ",", " ", "td2ML"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"k1ML", ",", " ", "k2ML"}], "}"}]}], "}"}]}]}]}], 
           ";", " ", 
           RowBox[{"{", 
            RowBox[{"n01ML", ",", " ", "n02ML"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"e1ML", ",", " ", "e2ML"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k1ML", ",", " ", "k2ML"}], "}"}]}], "}"}], " ", "are", 
        " ", "found", " ", "using", " ", "burstML1", " ", "and", " ", 
        RowBox[{"{", 
         RowBox[{"td1ML", ",", " ", "td2ML"}], "}"}], " ", "using", " ", 
        RowBox[{"burstML2", ".", "\n", "w"}]}], " ", "-", "  ", 
       RowBox[{"axial", " ", "ratio", " ", 
        RowBox[{"az", "/", "axy"}], " ", "\n", "bA"}]}], ",", " ", 
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "nTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
        "photons", " ", "in", " ", "a", " ", "burst"}]}], ",", " ", 
      RowBox[{"N", ">=", 
       RowBox[{
        RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
      "  ", 
      RowBox[{
       RowBox[{"\[Tau]", "<", 
        RowBox[{"tTh", "\n", "qMax"}]}], "=", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "max"], "/", 
         SubscriptBox["a", "xy"]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["z", "max"], "/", 
           SubscriptBox["a", "z"]}], " ", "-", " ", 
          RowBox[{"max", " ", "value", " ", "of", "  ", 
           SubscriptBox["q", "r"]}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "/", 
            SubscriptBox["a", "xy"]}], " ", "and", " ", 
           SubscriptBox["q", "z"]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"z", "/", 
              SubscriptBox["a", "z"]}], "\n", "jMax"}], " ", "-", " ", 
            RowBox[{
            "max", " ", "number", " ", "of", " ", "discret", " ", "points", 
             " ", "of", " ", 
             SubscriptBox["q", "r"]}]}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "/", 
              SubscriptBox["a", "xy"]}], " ", "and", " ", 
             SubscriptBox["q", "z"]}], "=", 
            RowBox[{"z", "/", 
             SubscriptBox["a", "z"]}]}]}]}]}]}]}]}], "\n", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "x", ",", "result0", ",", "f0", ",", "f0ML", ",", "mCoef", 
       ",", "table", ",", "temp", ",", "mCovariance", ",", "stdList", ",", 
       "mZ"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"dim", "=", "2"}], ";", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "number", " ", "of", " ", "parameters"}], "*)"}], 
      "\n", 
      RowBox[{"result0", "=", 
       RowBox[{"mlPar", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", "  ", "ML", " ", "parameters", " ", 
        RowBox[{"{", 
         RowBox[{"taudML1", ",", "taudML2"}], "}"}]}], "*)"}], "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "logL"}], 
         RowBox[{"(", 
          RowBox[{
          "n01", ",", "n02", ",", "e1", ",", "e2", ",", "taud1", ",", "taud2",
            ",", "k1", ",", "k2"}], ")"}]}], ",", " ", 
        RowBox[{
        "fitted", " ", "later", " ", "to", " ", "quadratic", " ", 
         "function"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"f0", "[", 
        RowBox[{"xtaud1_Real", ",", "xtaud2_Real"}], "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{
         StyleBox["logLBurstML2Dyn2st",
          FontWeight->"Bold"], "[", 
         RowBox[{"bursts", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mlPar", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"mlPar", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"xtaud1", ",", "xtaud2"}], "}"}], ",", 
            RowBox[{"mlPar", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "w", ",", " ", 
          "bA", ",", "bD", ",", " ", "nTh", ",", " ", "tTh", ",", " ", "qMax",
           ",", " ", "jMax"}], "]"}]}]}], ";", "\n", 
      RowBox[{"f0ML", "=", 
       RowBox[{"f0", "@@", "result0"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "value", " ", "at", " ", "max"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"mCoef", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "matrix", " ", "of", " ", "coefficients", " ", "of", " ", "quadratic", 
        " ", "fitting", " ", "for", " ", "2", 
        RowBox[{"(", "dim", ")"}], " ", "parameters"}], "*)"}], "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "calculate", " ", "diagonal", " ", "terms", " ", "of", " ", "mCoef"}],
         "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{
                   RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}], "->", 
                   RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}]}]}]}], ")"}]}], "-", 
               "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"ipar", ",", "ipar"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{"table", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "x", ",", 
                 RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
             "x", ",", "2"}], "]"}], "/", 
           RowBox[{
            RowBox[{"result0", "[", 
             RowBox[{"[", "ipar", "]"}], "]"}], "^", "2"}]}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
          "fitting", " ", "and", " ", "divide", " ", "by", " ", "the", " ", 
          "ml", " ", "parameter", " ", "squared"}], " ", "*)"}], "\n", 
        RowBox[{"{", 
         RowBox[{"ipar", ",", "dim"}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Calculate", " ", "off"}], "-", 
         RowBox[{"diagonal", " ", "terms", " ", "of", " ", "mCoef"}]}], " ", 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", " ", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}]}]}]}], "}"}]}], ")"}]}], 
               "-", "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", " ", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", " ", "\n", 
         RowBox[{"temp", "=", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"table", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", "x",
             ",", "2"}], "]"}]}], ";", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
           "table", " ", "at", " ", 
           SuperscriptBox["j", "2"]}], "*)"}], "\n", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"temp", "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "i1"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "i2"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "recalculate", " ", "the", " ", "coefficient", " ", "to", " ", 
           "find", " ", 
           SubscriptBox["a", "ij"]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i2", ",", "i1"}], "]"}], "]"}], "=", " ", 
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "use", " ", "symmetry", "  ", "of", " ", "the", " ", "matrix", " ", 
          "to", " ", "find", " ", "other", " ", "elements"}], " ", "*)"}], 
        "\n", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", 
          RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "find", " ", "the", " ", "covariance", " ", "matrix", " ", "by", " ", 
        "inverting", " ", "coef"}], "*)"}], "\n", 
      RowBox[{"mCovariance", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"2", " ", "mCoef"}], "]"}]}], ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Standard", " ", "deviation", " ", "is", " ", "the", " ", "square", 
        " ", "root", " ", "of", " ", "the", " ", "corresponding", " ", 
        "diagonal", " ", "term", " ", "of", " ", "the", " ", "covariance", 
        " ", "matrix"}], "*)"}], "\n", 
      RowBox[{"stdList", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Diagonal", "[", "mCovariance", "]"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"correlation", "=", 
        RowBox[{
         RowBox[{"cov", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"std", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"std", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]}], "*)"}], "\n", 
      RowBox[{"mZ", "=", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"1", "/", "stdList"}], "]"}], ".", "mCovariance", ".", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"1", "/", "stdList"}], "]"}]}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<correlation= \>\"", ",", 
          RowBox[{"MatrixForm", "[", "mZ", "]"}]}], "]"}], ";"}], "*)"}], 
      "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< std: (\[Delta]taud1,\[Delta]taud2) = \>\"", ",", "stdList"}], 
       "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< (\[Delta]taud1/taud1,\[Delta]taud2/taud2) = (%)\>\"", ",", 
        RowBox[{"100", " ", 
         RowBox[{"stdList", "/", "result0"}]}]}], "]"}], ";", "\n", 
      "stdList"}]}], "\n", "]"}]}], "\[IndentingNewLine]"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.857828097559574*^9, 3.857828194007698*^9}, {
   3.85782841823205*^9, 3.857828418425572*^9}, 3.857828613163211*^9, {
   3.857828968759426*^9, 3.857828974544918*^9}, {3.8578290442417507`*^9, 
   3.857829044563747*^9}, {3.857829074631036*^9, 3.8578291042214565`*^9}, {
   3.8578291458878775`*^9, 3.857829238048008*^9}, 3.857829421021576*^9, {
   3.857829520693486*^9, 3.8578295286928062`*^9}, {3.857829563084128*^9, 
   3.857829594548587*^9}, {3.8578296304109344`*^9, 3.857829664883241*^9}, {
   3.8578297868778315`*^9, 3.8578298087658625`*^9}, {3.857830175070758*^9, 
   3.857830205766608*^9}, {3.857830720048303*^9, 3.857830786852687*^9}, {
   3.8578386206551743`*^9, 3.8578386328804483`*^9}, 3.8581603537255497`*^9, 
   3.8581720905819454`*^9, {3.858175465324697*^9, 3.858175467959547*^9}, {
   3.8585857128665075`*^9, 3.858585717890374*^9}, {3.858585751989633*^9, 
   3.8585860021440372`*^9}, {3.8585860486735444`*^9, 
   3.8585861719989986`*^9}, {3.858586449725343*^9, 3.858586517018188*^9}, 
   3.858586549105003*^9, {3.858586581820258*^9, 3.858586630889717*^9}, {
   3.858586669033432*^9, 3.8585866746724653`*^9}, {3.858586722426854*^9, 
   3.858586723089554*^9}, {3.858586758032625*^9, 3.85858675972492*^9}, {
   3.858586823654657*^9, 3.858586844767112*^9}, {3.858586895103148*^9, 
   3.858586901012944*^9}, {3.85858693634341*^9, 3.8585871919171376`*^9}, {
   3.858587228461443*^9, 3.858587232589292*^9}, {3.858587373100877*^9, 
   3.85858738170232*^9}, {3.8585876806145115`*^9, 3.858587732592875*^9}, {
   3.858587824703308*^9, 3.8585878371918306`*^9}, {3.8585892179398785`*^9, 
   3.858589244881795*^9}, {3.858589320719643*^9, 3.858589323557064*^9}, {
   3.858589748412521*^9, 3.858589750946574*^9}, {3.858603155890789*^9, 
   3.858603258196697*^9}, {3.859468026844148*^9, 3.859468027754753*^9}, {
   3.859468107077246*^9, 3.859468519814144*^9}, {3.859468550173286*^9, 
   3.859468670046273*^9}, {3.859468716586191*^9, 3.859468743555145*^9}, {
   3.859468811427297*^9, 3.859468844253744*^9}, {3.859468875861836*^9, 
   3.859469102224951*^9}, {3.85946921160175*^9, 3.859469234195001*^9}, {
   3.85946927540121*^9, 3.859469322502188*^9}, {3.85946937313416*^9, 
   3.859469661559002*^9}, {3.85946972416766*^9, 3.859469724333266*^9}, {
   3.859469814090324*^9, 3.859469856862876*^9}, {3.859471936627837*^9, 
   3.859472067184894*^9}, {3.859472260094407*^9, 3.859472517707792*^9}, {
   3.85947257722421*^9, 3.8594726646524353`*^9}, {3.859472715522278*^9, 
   3.8594727179784913`*^9}, {3.8594730588921638`*^9, 3.859473062595656*^9}, {
   3.859473285051643*^9, 3.859473443684016*^9}, {3.859473543611983*^9, 
   3.8594735472502794`*^9}, {3.859473583978324*^9, 3.859473603607573*^9}, {
   3.859473637250788*^9, 3.859473750318581*^9}, {3.859473790905247*^9, 
   3.859473873953479*^9}, {3.859473939689728*^9, 3.859473963060348*^9}, {
   3.859474584321315*^9, 3.859474596131372*^9}, {3.85947466564873*^9, 
   3.859474676880967*^9}, {3.859474876470188*^9, 3.8594751622805023`*^9}, 
   3.85947531806351*^9, {3.8594753529544077`*^9, 3.859475379054974*^9}, {
   3.859475451219303*^9, 3.859475532894684*^9}, {3.859529855676712*^9, 
   3.85952993864158*^9}, {3.859529979584072*^9, 3.859530013523413*^9}, {
   3.8595300902418933`*^9, 3.859530276660777*^9}, {3.859530310018196*^9, 
   3.859530319601689*^9}, {3.859530429560343*^9, 3.8595304796034713`*^9}, {
   3.8595305100817184`*^9, 3.8595305937094493`*^9}, {3.859530654067239*^9, 
   3.8595310997181144`*^9}, {3.859531161690531*^9, 3.859531480368295*^9}, {
   3.859531764486404*^9, 3.859531933899324*^9}, {3.859531968920547*^9, 
   3.859531969663051*^9}, {3.85953221363411*^9, 3.859532214363294*^9}, {
   3.859533074575778*^9, 3.85953307561753*^9}, {3.8595332711466036`*^9, 
   3.8595332940354557`*^9}, {3.85953334743785*^9, 3.859533351015493*^9}, {
   3.859628187721283*^9, 3.859628194827474*^9}, {3.8596282465606947`*^9, 
   3.859628297715685*^9}, {3.859628340261663*^9, 3.859628357784096*^9}, {
   3.903162298497164*^9, 3.9031623863186007`*^9}, {3.903162436358452*^9, 
   3.903162502382076*^9}, {3.903163622421395*^9, 3.903163706311583*^9}, {
   3.903163745536602*^9, 3.903163806016772*^9}, {3.903172508814447*^9, 
   3.903172508972825*^9}, {3.9058570023679085`*^9, 3.905857218368884*^9}, {
   3.905857413337536*^9, 3.905857440370837*^9}, {3.905857484469467*^9, 
   3.905857624858189*^9}, {3.9058576548923674`*^9, 3.9058577098106575`*^9}, {
   3.905857773027028*^9, 3.9058578005009613`*^9}, {3.906128472090975*^9, 
   3.906128479605669*^9}, 3.9061286601140594`*^9, {3.9089825384406247`*^9, 
   3.908982600807757*^9}, {3.908982664414437*^9, 3.9089826707746305`*^9}, {
   3.90898271575958*^9, 3.908982719985839*^9}, {3.90898277537726*^9, 
   3.908982801535159*^9}, {3.927970226343487*^9, 3.927970242245994*^9}, {
   3.930389356320389*^9, 3.930389383840561*^9}, {3.9415443699384136`*^9, 
   3.94154437107382*^9}, {3.9415444073368454`*^9, 3.9415446991860924`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"a95373dd-71bf-2648-994b-52e4c75341f4"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ColorML", "Section",
 CellChangeTimes->{{3.9412174042452183`*^9, 3.9412174176937943`*^9}, {
  3.941217499047447*^9, 
  3.9412175037407513`*^9}},ExpressionUUID->"c1098daf-fd9c-3540-9ddf-\
3d3df5cc22c5"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["logLColorMLDyn2st",
  FontWeight->"Bold"],
 "[bursts_,{e_List,k_List}] --   log-likelihood of several ",
 StyleBox["bursts",
  FontSlant->"Italic"],
 " for given values of FRET efficiencies ",
 StyleBox["e_List",
  FontSlant->"Italic"],
 "={e1,e2} and transition rates ",
 StyleBox["k_List",
  FontSlant->"Italic"],
 "={k1,k2} "
}], "Subtitle",
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.6476953123538957`*^9, 
   3.647695375088311*^9}, {3.647703953536258*^9, 3.6477040722763085`*^9}, {
   3.6477079040602946`*^9, 3.647707918044254*^9}, {3.6477079890972786`*^9, 
   3.647708060051299*^9}, {3.647708194747961*^9, 3.647708226178168*^9}, {
   3.915540085814072*^9, 3.915540150836214*^9}, {3.9155409553917165`*^9, 
   3.915540984529545*^9}, {3.91554102599069*^9, 3.915541028787137*^9}, {
   3.9155413896791325`*^9, 3.9155413984743876`*^9}, {3.9155419640885973`*^9, 
   3.9155419680879245`*^9}, {3.915542754124607*^9, 3.91554275774899*^9}, {
   3.9155460827663403`*^9, 3.915546088937054*^9}, 3.915548467811706*^9, {
   3.9279703156715*^9, 3.9279703248552322`*^9}, {3.941219558167919*^9, 
   3.941219579601528*^9}, {3.94127835483192*^9, 3.9412783552880726`*^9}, {
   3.941278475753551*^9, 3.9412784799268446`*^9}, {3.9412785418012714`*^9, 
   3.9412785523203173`*^9}, {3.941278621183609*^9, 3.941278662800699*^9}, {
   3.9412794426479206`*^9, 3.9412794567048073`*^9}, {3.941280185959125*^9, 
   3.941280190208669*^9}},
 FontSize->14,ExpressionUUID->"71ae0eb7-031f-5048-9473-ad454e758b86"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["logLColorMLDyn2st",
    FontWeight->"Bold"], "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{"eList_", ",", "kList_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\n", 
   RowBox[{
    RowBox[{"log", "-", 
     RowBox[{
     "likelihood", " ", "of", " ", "many", " ", "bursts", " ", "\n", "a", " ",
       "molecule", " ", "with", " ", "2"}], "-", 
     RowBox[{
     "state", " ", "transitions", "\n", "REDUCED", " ", "likelihood", " ", 
      "function", "\n", "\n", 
      RowBox[{"return", ":", " ", 
       RowBox[{
        RowBox[{"sum", " ", "of", " ", "log", 
         RowBox[{"(", "Li", ")"}], "\n", "\n", "bursts"}], " ", "-", " ", 
        RowBox[{"list", " ", "of", " ", "bursts", " ", 
         RowBox[{"{", 
          RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}], ",", " ", 
    RowBox[{
    "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
     "arrival", " ", "times", " ", "and", " ", "colors", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "c0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
       "t"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "\n", "eList"}], " ", "-", " ", 
        RowBox[{"list", " ", "of", " ", "FRET", " ", "efficiencies", " ", 
         RowBox[{"{", 
          RowBox[{"e1", ",", "e2"}], "}"}], "\n", "kList"}], " ", "-", " ", 
        RowBox[{"list", " ", "of", " ", "transition", " ", "rates", " ", 
         RowBox[{"{", 
          RowBox[{"k1", ",", " ", "k2"}], "}"}], " ", 
         RowBox[{"k1", ":", "1"}]}]}], "->", "2"}]}], ";", " ", 
     RowBox[{
      RowBox[{"k2", ":", "2"}], "->", "1"}]}]}], "\n", "*)"}], "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "e1", ",", "e2", ",", "k1", ",", "k2", ",", "p1", ",", "p2", ",", 
      "acceptorM", ",", "donorM", ",", "p0", ",", "mEff", ",", "color", ",", 
      "vector", ",", "sumLogScale", ",", "vals", ",", "nBursts", ",", "sum", 
      ",", "photonList", ",", "nPh", ",", "scale"}], "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}], "=", "eList"}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "=", "kList"}], ";", "\n", 
     RowBox[{"p1", "=", 
      RowBox[{"k2", "/", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}]}]}], ";", "\n", 
     RowBox[{"p2", "=", 
      RowBox[{"1", "-", "p1"}]}], ";", "\n", 
     RowBox[{"vals", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}]}]}], "}"}]}], ";", "\n", 
     RowBox[{"acceptorM", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"e1", " ", "p1"}], "+", 
           RowBox[{"e2", " ", "p2"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e2", "-", "e1"}], ")"}], " ", "p2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e2", "-", "e1"}], ")"}], " ", "p1"}], ",", 
          RowBox[{
           RowBox[{"e1", " ", "p2"}], "+", 
           RowBox[{"e2", " ", "p1"}]}]}], "}"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"see", " ", "Decoding", " ", "paper", " ", "2009"}], "*)"}], 
     "\n", 
     RowBox[{"donorM", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", "acceptorM"}]}], ";", 
     "\n", 
     RowBox[{"p0", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"mEff", "[", "color_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"color", "\[Equal]", "\"\<a\>\""}], ",", "acceptorM", ",", 
        "donorM"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"sum", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{"(*", 
       RowBox[{"cycle", " ", "over", " ", "bursts"}], "*)"}], "\n", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"photonList", "=", 
         RowBox[{"bursts", "[", 
          RowBox[{"[", "ib", "]"}], "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "list", " ", "of", " ", "photons", " ", "in", " ", "burst", " ", 
          "ib"}], "*)"}], "\n", 
        RowBox[{"nPh", "=", 
         RowBox[{"Length", "[", "photonList", "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "number", " ", "of", " ", "photons", " ", "in", " ", "burst", " ", 
          "ib"}], "*)"}], "\n", "\n", 
        RowBox[{"vector", "=", " ", 
         RowBox[{
          RowBox[{"mEff", "[", 
           RowBox[{"bursts", "[", 
            RowBox[{"[", 
             RowBox[{"ib", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], ".", 
          "p0"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"initial", " ", "vector"}], "*)"}], "\n", 
        RowBox[{"sumLogScale", "=", "0"}], ";", "\n", "\n", "  ", 
        RowBox[{"Do", "[", 
         RowBox[{"(*", 
          RowBox[{"cycle", " ", "over", " ", "photons"}], "*)"}], "\n", " ", 
         "\n", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"vector", "=", 
            RowBox[{
             RowBox[{"mEff", "[", 
              RowBox[{"photonList", "[", 
               RowBox[{"[", 
                RowBox[{"iPh", ",", "2"}], "]"}], "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"vals", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"photonList", "[", 
                    RowBox[{"[", 
                    RowBox[{"iPh", ",", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"photonList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"iPh", "-", "1"}], ",", "1"}], "]"}], "]"}]}], 
                  ")"}]}], "]"}], " ", "vector"}], ")"}]}]}], ";", "\n", "\n", 
           RowBox[{"scale", "=", 
            RowBox[{"Abs", "[", 
             RowBox[{"vector", "//", "Total"}], "]"}]}], ";", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"scale", ">", "0"}], ",", "\n", 
             RowBox[{
              RowBox[{"vector", "=", 
               RowBox[{"vector", "/", "scale"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "divide", " ", "by", " ", "the", " ", "scaling", " ", 
                "factor"}], "*)"}], "\n", 
              RowBox[{"sumLogScale", "=", 
               RowBox[{"sumLogScale", "+", 
                RowBox[{"Log", "[", "scale", "]"}]}]}]}]}], "]"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
           "collect", " ", "Log", " ", "of", " ", "the", " ", "scaling", " ", 
            "factor"}], "*)"}], "\[IndentingNewLine]", "\n", 
          RowBox[{"{", 
           RowBox[{"iPh", ",", "2", ",", "nPh"}], "}"}]}], "\n", "  ", "]"}], 
        ";", "\n", "\n", 
        RowBox[{"sum", "=", 
         RowBox[{"sum", "+", 
          RowBox[{"Log", "[", 
           RowBox[{"p0", ".", "vector"}], "]"}], "+", "sumLogScale"}]}]}], 
       ",", "\n", 
       RowBox[{"{", 
        RowBox[{"ib", ",", "1", ",", 
         RowBox[{"Length", "[", "bursts", "]"}]}], "}"}]}], "\n", "  ", "]"}],
      ";", "\n", "sum"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.421593539203154*^9, 3.4215940520548086`*^9}, {
   3.421594196846124*^9, 3.421594275296675*^9}, {3.421594349544298*^9, 
   3.421594369903022*^9}, {3.4215944231825666`*^9, 3.421594549131662*^9}, {
   3.421594582599341*^9, 3.42159459856758*^9}, 3.421594773499481*^9, {
   3.421594854184399*^9, 3.421594854934376*^9}, {3.421595015163623*^9, 
   3.421595018444768*^9}, {3.421595065271395*^9, 3.421595079724057*^9}, {
   3.422194619997494*^9, 3.422194623825495*^9}, {3.4221946798080783`*^9, 
   3.422194702166738*^9}, {3.422194766914666*^9, 3.422194769508335*^9}, {
   3.422195058037059*^9, 3.422195061349346*^9}, 3.4221951671695747`*^9, {
   3.422211429269672*^9, 3.422211439128479*^9}, 3.422212331514575*^9, {
   3.422287458631485*^9, 3.42228748962831*^9}, {3.422360840886375*^9, 
   3.422360874041352*^9}, {3.422360908915013*^9, 3.422360916820959*^9}, 
   3.422360965537838*^9, {3.426259666147798*^9, 3.426259667928958*^9}, {
   3.426345758213121*^9, 3.426345760447368*^9}, {3.427117879595936*^9, 
   3.427117880861529*^9}, {3.427120060407412*^9, 3.427120088522019*^9}, {
   3.427120187654543*^9, 3.427120239961904*^9}, {3.427120287411819*^9, 
   3.427120345654324*^9}, {3.427120420028728*^9, 3.427120428746028*^9}, 
   3.427120469926674*^9, {3.427120826662236*^9, 3.427121104689623*^9}, {
   3.427121391737246*^9, 3.427121398127586*^9}, {3.42712161021214*^9, 
   3.427121637211103*^9}, {3.427126678171276*^9, 3.427126706029405*^9}, {
   3.427126837570385*^9, 3.4271269154731445`*^9}, {3.427127001281801*^9, 
   3.427127006078461*^9}, {3.427127065497679*^9, 3.427127076075325*^9}, {
   3.4271271785238595`*^9, 3.427127227974769*^9}, {3.4271272635513*^9, 
   3.427127455011475*^9}, {3.42713106086687*^9, 3.427131096990252*^9}, {
   3.427131127535758*^9, 3.42713122223464*^9}, {3.427131552251109*^9, 
   3.427131561563187*^9}, {3.427131599561485*^9, 3.427131635747364*^9}, {
   3.427131665933512*^9, 3.427131695150958*^9}, {3.427131769788237*^9, 
   3.427131799083796*^9}, {3.427131831707338*^9, 3.427131860893527*^9}, {
   3.4272083294084077`*^9, 3.427208344730353*^9}, {3.434469490977413*^9, 
   3.4344695247775326`*^9}, 3.434469566765939*^9, {3.4344696010036*^9, 
   3.434469608160537*^9}, {3.434470449954852*^9, 3.4344704655941763`*^9}, {
   3.434470496185381*^9, 3.434470636829928*^9}, {3.434471474674193*^9, 
   3.434471501707394*^9}, {3.4347570367583375`*^9, 3.434757039141763*^9}, {
   3.434788238092368*^9, 3.434788248337099*^9}, {3.434789147219629*^9, 
   3.434789165375736*^9}, {3.434789197171457*^9, 3.434789222177413*^9}, {
   3.434789257768591*^9, 3.434789383249022*^9}, {3.434789426270883*^9, 
   3.434789451857677*^9}, {3.4347895242417603`*^9, 3.4347895976172686`*^9}, {
   3.43478964992248*^9, 3.434789761873458*^9}, {3.4347897929180975`*^9, 
   3.434789806177163*^9}, {3.434789878691434*^9, 3.434789936103988*^9}, {
   3.434790025262192*^9, 3.434790032542661*^9}, {3.4347900729107075`*^9, 
   3.434790103184238*^9}, {3.434790193333867*^9, 3.434790242404428*^9}, {
   3.434790321938792*^9, 3.434790377488669*^9}, {3.4347904855039873`*^9, 
   3.434790706872299*^9}, {3.434790744947048*^9, 3.434790752307632*^9}, {
   3.434790787528277*^9, 3.434790895072919*^9}, {3.434790929963088*^9, 
   3.434790952205071*^9}, {3.434791001505962*^9, 3.434791008706315*^9}, {
   3.43479118087388*^9, 3.434791273987771*^9}, {3.434791438163845*^9, 
   3.434791465322898*^9}, {3.43479176746736*^9, 3.434791773015338*^9}, 
   3.4347918297368994`*^9, {3.434792538315785*^9, 3.4347925407292557`*^9}, {
   3.434795294739328*^9, 3.4347953006177807`*^9}, {3.434795535665763*^9, 
   3.434795559189588*^9}, {3.4428257676580915`*^9, 3.442825769911331*^9}, {
   3.442826578904607*^9, 3.442826643868019*^9}, {3.442826744753085*^9, 
   3.4428267852012463`*^9}, {3.4428268519772654`*^9, 
   3.4428268883495665`*^9}, {3.443005720435565*^9, 3.443005726073673*^9}, {
   3.4432718371292562`*^9, 3.443271840944742*^9}, {3.4433068991227875`*^9, 
   3.4433068995834494`*^9}, {3.44588571240549*^9, 3.445885728858299*^9}, 
   3.445885787654045*^9, {3.445886743098367*^9, 3.445886746207762*^9}, {
   3.592595525641447*^9, 3.5925955626551766`*^9}, {3.592595649275741*^9, 
   3.592595718944049*^9}, 3.592595755051576*^9, {3.592595814689147*^9, 
   3.592595817782739*^9}, {3.781531906012748*^9, 3.781531925578704*^9}, {
   3.781624020393295*^9, 3.7816241316484194`*^9}, {3.781624231189372*^9, 
   3.7816242314634*^9}, {3.78196542355558*^9, 3.781965427696996*^9}, 
   3.915540081549214*^9, {3.915540246616626*^9, 3.915540248007053*^9}, {
   3.9155411133096123`*^9, 3.915541120808246*^9}, 3.91554122348313*^9, {
   3.9155414440756717`*^9, 3.915541444638068*^9}, {3.915541518415824*^9, 
   3.915541519556242*^9}, {3.9155419885685234`*^9, 3.9155420694575973`*^9}, {
   3.915542221438385*^9, 3.91554239458888*^9}, {3.91554264086058*^9, 
   3.9155426448970137`*^9}, 3.915545814183057*^9, {3.915545848098548*^9, 
   3.915546169097792*^9}, {3.915546434699647*^9, 3.915546440386073*^9}, {
   3.915547070428641*^9, 3.91554708075476*^9}, {3.91554711626375*^9, 
   3.91554721352781*^9}, {3.915547252801631*^9, 3.9155472532859106`*^9}, {
   3.9155472859359875`*^9, 3.915547392136134*^9}, {3.915547429785248*^9, 
   3.9155475111694627`*^9}, 3.9155475415542693`*^9, {3.915547580765679*^9, 
   3.915547610228837*^9}, {3.915547649268287*^9, 3.915547658110378*^9}, {
   3.915547707339219*^9, 3.915547867173927*^9}, {3.9155479181330147`*^9, 
   3.915547921523029*^9}, {3.915548025035892*^9, 3.915548306984667*^9}, {
   3.915548345285716*^9, 3.915548382280658*^9}, {3.915548977192615*^9, 
   3.915548977739384*^9}, {3.919172683066986*^9, 3.919172703578728*^9}, {
   3.919173072095536*^9, 3.919173077375782*^9}, {3.9191736140999737`*^9, 
   3.9191737213871403`*^9}, {3.9191738646016273`*^9, 3.919173969802933*^9}, 
   3.919174052802962*^9, {3.919174275685463*^9, 3.919174278091242*^9}, {
   3.9191745244333477`*^9, 3.919174525073015*^9}, {3.919174960197201*^9, 
   3.919174979076029*^9}, {3.927970434807587*^9, 3.9279704628876686`*^9}, {
   3.9415447538962173`*^9, 
   3.941544837069704*^9}},ExpressionUUID->"b35b4623-f513-b34c-840c-\
e4b9978991ee"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["findMaxLColorMLDyn2st",
  FontWeight->"Bold"],
 "[bursts_,{eIniList_,kIniList_}] --  finds  colorML parameters \
{{e1,e2},{k1,k2}}  starting from the initial values  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["eIniList",
     FontSlant->"Italic"], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["e1", "ini"], ",", 
      SubscriptBox["e2", "ini"]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "53a03679-5dca-e44d-ad90-6b9cdd45bf93"],
 StyleBox[" ",
  FontSlant->"Italic"],
 "and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["kIniList",
     FontSlant->"Italic"], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["k1", "ini"], ",", 
      SubscriptBox["k2", "ini"]}], "}"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "618db09c-15db-1b49-9f42-34386d927dff"],
 " "
}], "Subtitle",
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.6476953123538957`*^9, 
   3.647695375088311*^9}, {3.647703953536258*^9, 3.6477040722763085`*^9}, {
   3.6477079040602946`*^9, 3.647707918044254*^9}, {3.6477079890972786`*^9, 
   3.647708060051299*^9}, {3.647708194747961*^9, 3.647708226178168*^9}, {
   3.915540085814072*^9, 3.915540150836214*^9}, {3.915541073018776*^9, 
   3.915541088859638*^9}, 3.927970334721398*^9, {3.927975174054737*^9, 
   3.927975174655712*^9}, {3.927975233759771*^9, 3.9279752357036*^9}, {
   3.927975287158762*^9, 3.927975322278805*^9}, {3.9279753838956833`*^9, 
   3.927975413646818*^9}, {3.927975507310431*^9, 3.927975507990795*^9}, {
   3.941219589909996*^9, 3.941219606265085*^9}, {3.941274766532503*^9, 
   3.9412748017019367`*^9}, 3.9412784866024303`*^9, {3.941278687496748*^9, 
   3.941278767072569*^9}, {3.941278846714819*^9, 3.941278853153364*^9}, {
   3.9412793100163765`*^9, 3.9412794233205566`*^9}, {3.9412805347875423`*^9, 
   3.9412805398670406`*^9}},
 FontSize->14,ExpressionUUID->"5bcb6269-9976-924c-b25d-f162cb06564d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"findMaxLColor", 
     StyleBox["MLDyn2st",
      FontWeight->"Bold"]}]], "[", 
   RowBox[{"bursts_", ",", 
    RowBox[{"{", 
     RowBox[{"eIniList_", ",", "kIniList_"}], "}"}]}], "]"}], ":=", "\n", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"June", " ", "21"}], ",", " ", 
    RowBox[{
     RowBox[{
     "2024", "\n", "Maximum", " ", "Likelihood", " ", "parameters", "  ", 
      "in", " ", "colorML", "\n", "a", " ", "molecule", " ", "with", " ", 
      "2"}], "-", 
     RowBox[{"state", " ", "transitions", "\n", "\n", 
      RowBox[{"return", ":", " ", 
       RowBox[{
        RowBox[{"ML", " ", "parameters", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e1ML", ",", "e2ML"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1ML", ",", "k2ML"}], "}"}]}], "}"}], "\n", "\n", 
         "bursts"}], " ", "-", " ", 
        RowBox[{"list", " ", "of", " ", "bursts", " ", 
         RowBox[{"{", 
          RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}], ",", " ", 
    RowBox[{
    "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
     "arrival", " ", "times", " ", "and", " ", "colors", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "c0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
      "t"}], "=", 
     RowBox[{
      RowBox[{"0", "\n", "eIniList"}], " ", "-", " ", 
      RowBox[{
      "initial", " ", "guess", " ", "for", " ", "FRET", " ", "efficiencies", 
       " ", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}], "\n", "kIniList"}], " ", "-", " ", 
      RowBox[{
      "initial", " ", "guess", " ", "for", " ", "transition", " ", "rates", 
       " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", " ", "k2"}], "}"}]}]}]}]}], " ", "\n", "*)"}], 
  "\n", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\n", 
     RowBox[{
     "iniGuess", ",", "pars", ",", "parsGuess", ",", "xk1", ",", "xk2", ",", 
      "xe1", ",", "xe2", ",", "\n", "sol", ",", "ff", ",", "f0", ",", 
      "result", ",", "result0", ",", "coef", ",", "table", ",", "covariance", 
      ",", "temp", ",", 
      RowBox[{"dim", "=", "4"}]}], "\n", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pars", "=", 
      RowBox[{"{", 
       RowBox[{"xe1", ",", "xe2", ",", "xk1", ",", "xk2"}], "}"}]}], ";", 
     RowBox[{"(*", " ", "parameters", "*)"}], "\n", 
     RowBox[{"iniGuess", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "eIniList"}], "-", "1"}], ",", "kIniList"}], 
         "}"}], "]"}], "]"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"parsGuess", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pars", ",", "iniGuess"}], "}"}], "\[Transpose]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"list", " ", "of", " ", 
       RowBox[{"{", 
        RowBox[{"var_i", ",", "guess_i"}], "}"}]}], " ", "*)"}], "\n", "\n", 
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{
       "xe1_Real", ",", "xe2_Real", ",", "xk1_Real", ",", "xk2_Real"}], "]"}],
       " ", ":=", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"it", "'"}], "s", " ", "important", " ", "to", " ", "have", 
        " ", "_Real", " ", "to", " ", "prevent", " ", "analytical", " ", 
        "evaluation"}], " ", "*)"}], "\n", 
      RowBox[{
       StyleBox["logLColorMLDyn2st",
        FontWeight->"Bold"], "[", 
       RowBox[{"bursts", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Exp", "[", 
              RowBox[{"{", 
               RowBox[{"xe1", ",", "xe2"}], "}"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"xk1", ",", "xk2"}], "}"}], "]"}]}], "}"}]}], "]"}]}], 
     ";", "\n", " ", "\n", 
     RowBox[{"sol", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", "=", "0"}], "}"}], ",", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"FindMaximum", "[", 
           RowBox[{
            RowBox[{"ff", "@@", "pars"}], ",", "parsGuess", ",", 
            RowBox[{"AccuracyGoal", "->", "4"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "4"}], ",", "\n", "\t", 
            RowBox[{"StepMonitor", "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"c", "++"}], 
              RowBox[{"(*", 
               RowBox[{";", "   ", 
                RowBox[{"Print", "[", 
                 RowBox[{"Now", ",", "\"\< c= \>\"", ",", "c"}], "]"}]}], 
               "*)"}], " ", ")"}]}]}], "\n", "\t       ", "]"}], ",", " ", 
          "c"}], "  ", "}"}]}], "]"}]}], ";", "\n", " ", "\n", " ", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"{", 
              RowBox[{"xe1", ",", "xe2"}], "}"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"Exp", "[", 
          RowBox[{"{", 
           RowBox[{"xk1", ",", "xk2"}], "}"}], "]"}]}], "}"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", "\n", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  LogLikelihood= \>\"", ",", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<   steps=\>\"", ",",
        " ", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<  (e,k) = \>\"", ",", "result"}], "]"}], ";", "\n", 
     "result"}]}], "\n", "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.433174731898714*^9, 3.4331748017758*^9}, 
   3.4331748502146606`*^9, {3.4331752268899417`*^9, 3.433175389285827*^9}, {
   3.433175426750022*^9, 3.433175578497192*^9}, {3.433175613711659*^9, 
   3.43317563175634*^9}, {3.433175985641314*^9, 3.433175989453423*^9}, {
   3.433176065773733*^9, 3.4331760725542884`*^9}, {3.433177858350347*^9, 
   3.4331779858693542`*^9}, 3.4331781434792223`*^9, {3.433178191037156*^9, 
   3.433178203457838*^9}, 3.433178378175439*^9, 3.433179517687674*^9, 
   3.4331824504290185`*^9, 3.4331824898319902`*^9, {3.4331827796672487`*^9, 
   3.433182785229286*^9}, 3.433182912437452*^9, {3.433182971729393*^9, 
   3.433182994985692*^9}, {3.4331831912347164`*^9, 3.4331831926726675`*^9}, {
   3.433183363438343*^9, 3.433183366532291*^9}, {3.433243912803263*^9, 
   3.4332439185223074`*^9}, {3.433243956664883*^9, 3.43324402112131*^9}, {
   3.433244061467126*^9, 3.433244222938886*^9}, {3.433247903739778*^9, 
   3.4332484822113533`*^9}, {3.4332485763323245`*^9, 3.433248646912972*^9}, {
   3.433248734209266*^9, 3.433248784340585*^9}, {3.433248860844732*^9, 
   3.433248994562719*^9}, {3.4332490745311947`*^9, 3.433249075765807*^9}, 
   3.4332495161464424`*^9, {3.433250184167661*^9, 3.4332502012153006`*^9}, {
   3.433250233201108*^9, 3.433250263420065*^9}, {3.4332509179493504`*^9, 
   3.4332509873507137`*^9}, {3.433251027667939*^9, 3.433251033277996*^9}, {
   3.433251152620631*^9, 3.433251153245707*^9}, {3.4332512183317456`*^9, 
   3.4332512702443075`*^9}, {3.433251641590469*^9, 3.433251665870942*^9}, {
   3.4332519264556203`*^9, 3.4332519287055054`*^9}, {3.433252491669583*^9, 
   3.4332525428261604`*^9}, {3.433259474469654*^9, 3.4332594779070663`*^9}, {
   3.4332596962921*^9, 3.433259700073253*^9}, {3.433259758899873*^9, 
   3.433259762102916*^9}, {3.433259851163135*^9, 3.433259863069081*^9}, {
   3.433259988565868*^9, 3.433260104078536*^9}, {3.4332604765415144`*^9, 
   3.433260479385537*^9}, {3.433260513043297*^9, 3.433260516184004*^9}, {
   3.433260623983638*^9, 3.433260627343099*^9}, 3.4332606819851227`*^9, 
   3.4332607192985783`*^9, {3.433260896549661*^9, 3.433260900893384*^9}, {
   3.433260958236767*^9, 3.433260965814843*^9}, {3.4332609985333843`*^9, 
   3.43326100072087*^9}, {3.43326110907942*^9, 3.433261114876221*^9}, 
   3.4332612352028065`*^9, {3.433261368763597*^9, 3.4332613876071053`*^9}, {
   3.4332616536505747`*^9, 3.433261721446372*^9}, {3.4332619185050883`*^9, 
   3.433261942738998*^9}, {3.433262015768846*^9, 3.4332620808925953`*^9}, {
   3.4332621422039185`*^9, 3.4332621449069915`*^9}, {3.4332622016715264`*^9, 
   3.433262209499501*^9}, {3.433262528868369*^9, 3.433262546164912*^9}, {
   3.433262599429514*^9, 3.433262615101088*^9}, 3.4332626591939917`*^9, {
   3.433265210083069*^9, 3.433265212489319*^9}, {3.433413659175805*^9, 
   3.433413718971788*^9}, {3.433413767781973*^9, 3.433413773289893*^9}, {
   3.4334139217033*^9, 3.43341393064616*^9}, {3.433413993927153*^9, 
   3.433414001447968*^9}, {3.43341407794797*^9, 3.433414111085619*^9}, {
   3.443003228231954*^9, 3.443003232488072*^9}, {3.443003263252309*^9, 
   3.443003357147323*^9}, {3.443003400599805*^9, 3.443003433036446*^9}, {
   3.44300348111558*^9, 3.443003538177635*^9}, {3.4430036156991024`*^9, 
   3.4430037081520452`*^9}, {3.443003741960658*^9, 3.443003894179538*^9}, 
   3.443003968816861*^9, {3.443004013320854*^9, 3.4430040565930786`*^9}, {
   3.4430041005763216`*^9, 3.443004355733219*^9}, {3.44300439620141*^9, 
   3.443004418773867*^9}, {3.443006271347739*^9, 3.443006281292037*^9}, {
   3.44303528461677*^9, 3.443035372032467*^9}, {3.4430354113089437`*^9, 
   3.4430354869076495`*^9}, {3.443035824032411*^9, 3.443035862247364*^9}, {
   3.443203204508971*^9, 3.4432032234916453`*^9}, {3.443203265066045*^9, 
   3.443203276002565*^9}, {3.443203311858727*^9, 3.443203317061386*^9}, {
   3.443267775018227*^9, 3.443267868873184*^9}, {3.4432683246485567`*^9, 
   3.443268449407953*^9}, {3.443268483667214*^9, 3.443268639481264*^9}, {
   3.443268698986829*^9, 3.443268846528984*^9}, {3.4432688814592113`*^9, 
   3.443268909599675*^9}, {3.443269020669386*^9, 3.443269032356191*^9}, {
   3.44326918958227*^9, 3.443269223601187*^9}, 3.443269264329752*^9, {
   3.443269299530368*^9, 3.4432692997106276`*^9}, {3.4432695569405055`*^9, 
   3.4432697116930285`*^9}, {3.443269768034044*^9, 3.443270100742455*^9}, {
   3.443270130995957*^9, 3.4432701374452305`*^9}, {3.443270425219028*^9, 
   3.443270438007418*^9}, {3.4432711692088337`*^9, 3.443271172743917*^9}, {
   3.443271357149079*^9, 3.443271360644104*^9}, {3.443271473977069*^9, 
   3.443271483781166*^9}, {3.443271547853299*^9, 3.443271550016408*^9}, {
   3.443271607218661*^9, 3.443271607589194*^9}, 3.4432716662235055`*^9, {
   3.4432717842632384`*^9, 3.4432718136054306`*^9}, {3.44327185209077*^9, 
   3.443271938044365*^9}, {3.443272011039327*^9, 3.443272012841919*^9}, {
   3.443273603318912*^9, 3.443273618801174*^9}, {3.44327459219084*^9, 
   3.4432745923711*^9}, {3.443306840428389*^9, 3.443306840859008*^9}, {
   3.4433069377883854`*^9, 3.443306940281971*^9}, {3.443310493971927*^9, 
   3.443310507972062*^9}, {3.443371422729501*^9, 3.443371427401286*^9}, {
   3.4433786470688753`*^9, 3.443378704739643*^9}, {3.443379063123388*^9, 
   3.4433791199347963`*^9}, {3.443448210761333*^9, 3.443448213084674*^9}, {
   3.4437852250745025`*^9, 3.4437852607157516`*^9}, {3.444009842443077*^9, 
   3.444010181791035*^9}, {3.444010527608296*^9, 3.444010536200651*^9}, {
   3.444010656022948*^9, 3.444010658997224*^9}, 3.444010946009928*^9, {
   3.444036149040715*^9, 3.444036362848155*^9}, 3.4440364509548464`*^9, {
   3.4440364964102077`*^9, 3.4440365268840275`*^9}, {3.444036597395419*^9, 
   3.444036597675821*^9}, {3.4440366811057873`*^9, 3.4440366847410145`*^9}, 
   3.444037233650307*^9, {3.444037698388568*^9, 3.444037771083098*^9}, {
   3.444037978851855*^9, 3.4440380538897533`*^9}, 3.444038240818544*^9, {
   3.44424034572138*^9, 3.444240451613644*^9}, {3.4442404848514385`*^9, 
   3.4442405194211473`*^9}, {3.444240571516056*^9, 3.4442406467842865`*^9}, {
   3.444240687623009*^9, 3.44424075155494*^9}, 3.4442408256915426`*^9, 
   3.444242353608579*^9, {3.4442423869164734`*^9, 3.444242388568847*^9}, {
   3.444242926372173*^9, 3.444242964517022*^9}, {3.444243792006894*^9, 
   3.444243793599184*^9}, {3.4442438650919857`*^9, 3.444243865282259*^9}, {
   3.444245668495152*^9, 3.444245685159114*^9}, {3.4442469111520047`*^9, 
   3.444246913936008*^9}, {3.4442509469752336`*^9, 3.444250995905592*^9}, {
   3.444253554434576*^9, 3.4442536269288177`*^9}, {3.4442536680379295`*^9, 
   3.444253907181802*^9}, {3.444254454088214*^9, 3.444254474006856*^9}, {
   3.44425460654744*^9, 3.4442546346378317`*^9}, {3.444254790201522*^9, 
   3.4442548194635983`*^9}, {3.444254868474072*^9, 3.444254941849581*^9}, {
   3.4443051139888*^9, 3.4443053107827997`*^9}, {3.4443053411247997`*^9, 
   3.444305341312001*^9}, {3.4443053795164003`*^9, 3.444305431792*^9}, 
   3.4443056166208*^9, {3.4443058145536003`*^9, 3.4443058420408*^9}, {
   3.4443200034812*^9, 3.4443200739308*^9}, {3.4443206560448*^9, 
   3.444320747102*^9}, {3.444320818487602*^9, 3.4443208945688*^9}, {
   3.444320972912002*^9, 3.4443210547028*^9}, {3.444321099818*^9, 
   3.444321145182801*^9}, {3.4443212205152*^9, 3.4443212317940006`*^9}, {
   3.444321277782802*^9, 3.444321447682411*^9}, {3.44432149169*^9, 
   3.444321647846002*^9}, {3.4443216945056*^9, 3.444321721634*^9}, {
   3.4443221059712*^9, 3.4443221180144*^9}, {3.444322168964*^9, 
   3.444322187122401*^9}, {3.4443223214228*^9, 3.4443223381304*^9}, {
   3.4443223820132*^9, 3.4443224359736*^9}, {3.444322488374*^9, 
   3.444322525970001*^9}, {3.4443226381496*^9, 3.4443226502864*^9}, {
   3.444322681424*^9, 3.4443226830620003`*^9}, 3.444323302116801*^9, {
   3.444323715688401*^9, 3.4443238062308*^9}, {3.4443241067492*^9, 
   3.4443241129268*^9}, {3.4443241933136*^9, 3.4443241983992*^9}, {
   3.444324586714401*^9, 3.4443246188972*^9}, {3.4443249093068*^9, 
   3.44432491082*^9}, {3.444324984062001*^9, 3.4443249910352*^9}, {
   3.4443253174808*^9, 3.444325322254401*^9}, {3.4443255111704*^9, 
   3.4443255170672*^9}, {3.444325557736401*^9, 3.4443255889364*^9}, {
   3.4443256836596003`*^9, 3.4443256899932*^9}, {3.4443258190364*^9, 
   3.4443258382868*^9}, {3.4443261446396*^9, 3.4443261506924*^9}, {
   3.444326282075601*^9, 3.4443263072852*^9}, {3.44432640452*^9, 
   3.4443264047696*^9}, {3.4443264838304*^9, 3.4443264897584*^9}, {
   3.4443266688932*^9, 3.444326715974*^9}, {3.4443269305987997`*^9, 
   3.4443271358792*^9}, {3.4443271708388*^9, 3.4443272367488003`*^9}, {
   3.4443272804288*^9, 3.4443273091952*^9}, {3.4443276386984*^9, 
   3.444327657917601*^9}, {3.451073551880951*^9, 3.451074008025193*^9}, {
   3.45107412054484*^9, 3.451074153242594*^9}, {3.780753618655472*^9, 
   3.7807536210310516`*^9}, {3.7807537308110046`*^9, 3.780753776925066*^9}, {
   3.780754625009075*^9, 3.780754625985173*^9}, {3.915540233822113*^9, 
   3.915540313146851*^9}, {3.9155404947060328`*^9, 3.915540513483889*^9}, {
   3.91554054751545*^9, 3.91554063877383*^9}, {3.915540680578752*^9, 
   3.915540833370596*^9}, {3.915540866942565*^9, 3.915540869239064*^9}, {
   3.9155410508767805`*^9, 3.915541055391581*^9}, {3.9155412372064686`*^9, 
   3.915541327127035*^9}, {3.915541561095535*^9, 3.9155415712967863`*^9}, {
   3.915542607093207*^9, 3.915542610432002*^9}, {3.915542697277974*^9, 
   3.915542731099862*^9}, 3.915545828071067*^9, 3.927970481249377*^9, 
   3.927970597297896*^9, {3.9279753384246902`*^9, 3.9279753388316097`*^9}, {
   3.927975482266695*^9, 3.927975504147614*^9}, {3.941544850497015*^9, 
   3.9415450098044357`*^9}, {3.9415450402006817`*^9, 
   3.941545040557743*^9}},ExpressionUUID->"4a0d44ee-f137-574c-97b4-\
fe581e338ddf"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["stdColorMLDyn2stk1k2",
  FontWeight->"Bold"],
 "[bursts_,mlPar_]--  standard deviation of the colorML parameters \
{{e1,e2},{k1,k2}} estimated near the maximum  ",
 StyleBox["mlPar",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["e1", "ml"], ",", 
        SuperscriptBox["e2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["k1", "ml"], ",", 
        SuperscriptBox["k2", "ml"]}]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a9fed8a2-02d7-8a40-a820-fdd8aaa33cc3"],
 "}} "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.9030856804809084`*^9, 3.903085699630611*^9}, {
   3.903085776131449*^9, 3.903085832711562*^9}, {3.9030872060587616`*^9, 
   3.9030872336325216`*^9}, {3.903162267887575*^9, 3.903162290689946*^9}, {
   3.903431718781564*^9, 3.903431724766472*^9}, 3.903432194361227*^9, {
   3.906802006853759*^9, 3.906802017108662*^9}, 3.924960669015648*^9, 
   3.925018904654131*^9, {3.927970358304869*^9, 3.927970360375412*^9}, {
   3.927975432814743*^9, 3.9279754674467697`*^9}, {3.9412787819618816`*^9, 
   3.9412788140260086`*^9}, {3.9412789131116295`*^9, 
   3.9412789455527897`*^9}, {3.941279517145254*^9, 3.9412796081620903`*^9}},
 FontSize->14,ExpressionUUID->"4111b4fe-9da9-3842-a894-8336b24977c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdColorMLDyn2stk1k2",
     FontWeight->"Bold"], "[", 
    RowBox[{"bursts_", ",", "mlPar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"June", " ", "21"}], ",", " ", 
      RowBox[{"2024", ";", "\n", 
       RowBox[{
       "Standard", " ", "deviation", " ", "of", " ", "colorML", " ", 
        "parameters", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e1", ",", "e2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "}"}], ".", 
         "\[IndentingNewLine]", "\n", 
         RowBox[{"return", ":", " ", 
          RowBox[{
           RowBox[{"standard", " ", "deviations", "  ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"stde1", ",", "stde2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"stdk1", ",", "stdk2"}], "}"}]}], "}"}], "  ", "\n", 
            "\n", "bursts"}], " ", "-", " ", 
           RowBox[{"list", " ", "of", " ", "bursts", " ", 
            RowBox[{"{", 
             RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}]}], ",", 
      " ", 
      RowBox[{
      "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
       "arrival", " ", "times", " ", "and", " ", "colors", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "c0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
        "t"}], "=", 
       RowBox[{
        RowBox[{"0", "\n", "mlPar"}], " ", "-", " ", 
        RowBox[{"ML", " ", "parameters", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e1", ",", "e2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "}"}], " ", "calculated", " ",
          "separately"}]}]}]}], "\n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "x", ",", "result0", ",", "f0", ",", "f0ML", ",", "mCoef", 
       ",", "table", ",", "temp", ",", "mCovariance", ",", "stdList", ",", 
       "mZ"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"dim", "=", "4"}], ";", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "number", " ", "of", " ", "parameters"}], "*)"}], 
      "\n", 
      RowBox[{"result0", "=", 
       RowBox[{"mlPar", "//", "Flatten"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", " ", "ML", " ", "parameters"}], "*)"}], 
      "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "logL"}], 
         RowBox[{"(", 
          RowBox[{"e1", ",", "e2", ",", "k1", ",", "k2"}], ")"}]}], ",", " ", 
        RowBox[{
        "fitted", " ", "later", " ", "to", " ", "a", " ", "quadratic", " ", 
         "function"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"f0", "[", 
        RowBox[{
        "xe1_Real", ",", "xe2_Real", ",", "xk1_Real", ",", "xk2_Real"}], 
        "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{
         StyleBox["logLColorMLDyn2st",
          FontWeight->"Bold"], "[", 
         RowBox[{"bursts", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xe1", ",", "xe2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xk1", ",", "xk2"}], "}"}]}], "}"}]}], "]"}]}]}], ";", 
      "\n", 
      RowBox[{"f0ML", "=", 
       RowBox[{"f0", "@@", "result0"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "value", " ", "at", " ", "max"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"mCoef", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "matrix", " ", "of", " ", "coefficients", " ", "of", " ", "quadratic", 
        " ", "fitting", " ", "for", " ", "4", 
        RowBox[{"(", "dim", ")"}], " ", "parameters"}], "*)"}], "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "calculate", " ", "diagonal", " ", "terms", " ", "of", " ", "mCoef"}],
         "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{
                   RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}], "->", 
                   RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}]}]}]}], ")"}]}], "-", 
               "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"ipar", ",", "ipar"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{"table", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "x", ",", 
                 RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
             "x", ",", "2"}], "]"}], "/", 
           RowBox[{
            RowBox[{"result0", "[", 
             RowBox[{"[", "ipar", "]"}], "]"}], "^", "2"}]}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
          "fitting", " ", "and", " ", "divide", " ", "by", " ", "the", " ", 
          "ml", " ", "parameter", " ", "squared"}], " ", "*)"}], "\n", 
        RowBox[{"{", 
         RowBox[{"ipar", ",", "dim"}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Calculate", " ", "off"}], "-", 
         RowBox[{"diagonal", " ", "terms", " ", "of", " ", "mCoef"}]}], " ", 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", " ", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}]}]}]}], "}"}]}], ")"}]}], 
               "-", "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", " ", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", " ", "\n", 
         RowBox[{"temp", "=", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"table", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", "x",
             ",", "2"}], "]"}]}], ";", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
           "table", " ", "at", " ", 
           SuperscriptBox["j", "2"]}], "*)"}], "\n", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"temp", "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "i1"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "i2"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "recalculate", " ", "the", " ", "coefficient", " ", "to", " ", 
           "find", " ", 
           SubscriptBox["a", "ij"]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i2", ",", "i1"}], "]"}], "]"}], "=", " ", 
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "use", " ", "symmetry", "  ", "of", " ", "the", " ", "matrix", " ", 
          "to", " ", "find", " ", "other", " ", "elements"}], " ", "*)"}], 
        "\n", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", 
          RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "find", " ", "the", " ", "covariance", " ", "matrix", " ", "by", " ", 
        "inverting", " ", "coef"}], "*)"}], "\n", 
      RowBox[{"mCovariance", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"2", " ", "mCoef"}], "]"}]}], ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Standard", " ", "deviation", " ", "is", " ", "the", " ", "square", 
        " ", "root", " ", "of", " ", "the", " ", "corresponding", " ", 
        "diagonal", " ", "term", " ", "of", " ", "the", " ", "covariance", 
        " ", "matrix"}], "*)"}], "\n", 
      RowBox[{"stdList", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Diagonal", "[", "mCovariance", "]"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< std: (\[Delta]e1,\[Delta]e2,\[Delta]k1,\[Delta]k2) = \>\"", ",", 
        "stdList"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k1/k1,\[Delta]k2/k2) = \
(%)\>\"", ",", 
        RowBox[{"100", " ", 
         RowBox[{"stdList", "/", "result0"}]}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}]}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}]], "Code",
 CellChangeTimes->{{3.857828097559574*^9, 3.857828194007698*^9}, {
   3.85782841823205*^9, 3.857828418425572*^9}, 3.857828613163211*^9, {
   3.857828968759426*^9, 3.857828974544918*^9}, {3.8578290442417507`*^9, 
   3.857829044563747*^9}, {3.857829074631036*^9, 3.8578291042214565`*^9}, {
   3.8578291458878775`*^9, 3.857829238048008*^9}, 3.857829421021576*^9, {
   3.857829520693486*^9, 3.8578295286928062`*^9}, {3.857829563084128*^9, 
   3.857829594548587*^9}, {3.8578296304109344`*^9, 3.857829664883241*^9}, {
   3.8578297868778315`*^9, 3.8578298087658625`*^9}, {3.857830175070758*^9, 
   3.857830205766608*^9}, {3.857830720048303*^9, 3.857830786852687*^9}, {
   3.8578386206551743`*^9, 3.8578386328804483`*^9}, 3.8581603537255497`*^9, 
   3.8581720905819454`*^9, {3.858175465324697*^9, 3.858175467959547*^9}, {
   3.8585857128665075`*^9, 3.858585717890374*^9}, {3.858585751989633*^9, 
   3.8585860021440372`*^9}, {3.8585860486735444`*^9, 
   3.8585861719989986`*^9}, {3.858586449725343*^9, 3.858586517018188*^9}, 
   3.858586549105003*^9, {3.858586581820258*^9, 3.858586630889717*^9}, {
   3.858586669033432*^9, 3.8585866746724653`*^9}, {3.858586722426854*^9, 
   3.858586723089554*^9}, {3.858586758032625*^9, 3.85858675972492*^9}, {
   3.858586823654657*^9, 3.858586844767112*^9}, {3.858586895103148*^9, 
   3.858586901012944*^9}, {3.85858693634341*^9, 3.8585871919171376`*^9}, {
   3.858587228461443*^9, 3.858587232589292*^9}, {3.858587373100877*^9, 
   3.85858738170232*^9}, {3.8585876806145115`*^9, 3.858587732592875*^9}, {
   3.858587824703308*^9, 3.8585878371918306`*^9}, {3.8585892179398785`*^9, 
   3.858589244881795*^9}, {3.858589320719643*^9, 3.858589323557064*^9}, {
   3.858589748412521*^9, 3.858589750946574*^9}, {3.858603155890789*^9, 
   3.858603258196697*^9}, {3.859468026844148*^9, 3.859468027754753*^9}, {
   3.859468107077246*^9, 3.859468519814144*^9}, {3.859468550173286*^9, 
   3.859468670046273*^9}, {3.859468716586191*^9, 3.859468743555145*^9}, {
   3.859468811427297*^9, 3.859468844253744*^9}, {3.859468875861836*^9, 
   3.859469102224951*^9}, {3.85946921160175*^9, 3.859469234195001*^9}, {
   3.85946927540121*^9, 3.859469322502188*^9}, {3.85946937313416*^9, 
   3.859469661559002*^9}, {3.85946972416766*^9, 3.859469724333266*^9}, {
   3.859469814090324*^9, 3.859469856862876*^9}, {3.859471936627837*^9, 
   3.859472067184894*^9}, {3.859472260094407*^9, 3.859472517707792*^9}, {
   3.85947257722421*^9, 3.8594726646524353`*^9}, {3.859472715522278*^9, 
   3.8594727179784913`*^9}, {3.8594730588921638`*^9, 3.859473062595656*^9}, {
   3.859473285051643*^9, 3.859473443684016*^9}, {3.859473543611983*^9, 
   3.8594735472502794`*^9}, {3.859473583978324*^9, 3.859473603607573*^9}, {
   3.859473637250788*^9, 3.859473750318581*^9}, {3.859473790905247*^9, 
   3.859473873953479*^9}, {3.859473939689728*^9, 3.859473963060348*^9}, {
   3.859474584321315*^9, 3.859474596131372*^9}, {3.85947466564873*^9, 
   3.859474676880967*^9}, {3.859474876470188*^9, 3.8594751622805023`*^9}, 
   3.85947531806351*^9, {3.8594753529544077`*^9, 3.859475379054974*^9}, {
   3.859475451219303*^9, 3.859475532894684*^9}, {3.859529855676712*^9, 
   3.85952993864158*^9}, {3.859529979584072*^9, 3.859530013523413*^9}, {
   3.8595300902418933`*^9, 3.859530276660777*^9}, {3.859530310018196*^9, 
   3.859530319601689*^9}, {3.859530429560343*^9, 3.8595304796034713`*^9}, {
   3.8595305100817184`*^9, 3.8595305937094493`*^9}, {3.859530654067239*^9, 
   3.8595310997181144`*^9}, {3.859531161690531*^9, 3.859531480368295*^9}, {
   3.859531764486404*^9, 3.859531933899324*^9}, {3.859531968920547*^9, 
   3.859531969663051*^9}, {3.85953221363411*^9, 3.859532214363294*^9}, {
   3.859533074575778*^9, 3.85953307561753*^9}, {3.8595332711466036`*^9, 
   3.8595332940354557`*^9}, {3.85953334743785*^9, 3.859533351015493*^9}, {
   3.859628187721283*^9, 3.859628194827474*^9}, {3.8596282465606947`*^9, 
   3.859628297715685*^9}, {3.859628340261663*^9, 3.859628357784096*^9}, {
   3.903162298497164*^9, 3.9031623863186007`*^9}, {3.903162436358452*^9, 
   3.903162502382076*^9}, {3.903163622421395*^9, 3.903163706311583*^9}, {
   3.903163745536602*^9, 3.903163806016772*^9}, {3.903172508814447*^9, 
   3.903172508972825*^9}, {3.90343220298139*^9, 3.903432362937925*^9}, {
   3.9034324128532543`*^9, 3.903432417825158*^9}, {3.924964643589987*^9, 
   3.924964863848978*^9}, 3.925018902007969*^9, 3.925018942507794*^9, {
   3.9279754492052937`*^9, 3.927975464387949*^9}, {3.9279755332702637`*^9, 
   3.927975706215287*^9}, {3.927975781394829*^9, 3.9279758122031136`*^9}, {
   3.927977792666991*^9, 3.927977793153431*^9}, {3.941545064619011*^9, 
   3.9415450932177563`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"ee4c07ac-fd1a-ed47-8687-2d7418424499"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["stdColorMLDyn2stkp",
  FontWeight->"Bold"],
 "[bursts_,mlPar_]--  standard deviation of the colorML parameters  \
{{e1,e2},{k,p1}}, k=k1+k2, p1=k2/(k1+k2)  estimated near the maximum  ",
 StyleBox["mlPar",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["e1", "ml"], ",", 
        SuperscriptBox["e2", "ml"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["k1", "ml"], ",", 
        SuperscriptBox["k2", "ml"]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"5ca78e78-adcb-ff40-8c7d-de65fec52c75"],
 "}} "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.903027514133808*^9, 
   3.903027555585255*^9}, {3.903027683667616*^9, 3.903027687447799*^9}, {
   3.903028041504904*^9, 3.903028053842356*^9}, {3.9030855821559596`*^9, 
   3.9030855991370153`*^9}, {3.9030856804809084`*^9, 3.903085699630611*^9}, {
   3.903085776131449*^9, 3.903085832711562*^9}, {3.9030872060587616`*^9, 
   3.9030872336325216`*^9}, {3.903162267887575*^9, 3.903162290689946*^9}, {
   3.903431718781564*^9, 3.903431724766472*^9}, 3.903432194361227*^9, {
   3.906802006853759*^9, 3.906802017108662*^9}, 3.924960669015648*^9, 
   3.925018904654131*^9, {3.927970358304869*^9, 3.927970360375412*^9}, {
   3.927975432814743*^9, 3.9279754674467697`*^9}, {3.9279757550709496`*^9, 
   3.927975761070858*^9}, {3.9412789983283043`*^9, 3.941279029304264*^9}, {
   3.941279629075203*^9, 3.9412796535310383`*^9}, {3.941279684394182*^9, 
   3.941279709944317*^9}},
 FontSize->14,ExpressionUUID->"e1ce960e-beb5-9542-bfab-025880a6b941"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdColorMLDyn2stkp",
     FontWeight->"Bold"], "[", 
    RowBox[{"bursts_", ",", "mlPar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"June", " ", "21"}], ",", " ", 
      RowBox[{"2024", ";", "\n", 
       RowBox[{
       "Standard", " ", "deviation", " ", "of", " ", "colorML", " ", 
        "parameters", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "p1"}], "}"}]}], "}"}]}], ";", " ", 
       RowBox[{"k", "=", 
        RowBox[{"k1", "+", "k2"}]}]}], ",", " ", 
      RowBox[{"p1", "=", 
       RowBox[{"k2", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], ".", "\[IndentingNewLine]", "\n", 
         RowBox[{"return", ":", " ", 
          RowBox[{
           RowBox[{"standard", " ", "deviations", "  ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"stde1", ",", "stde2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"stdk1", ",", "stdk2"}], "}"}]}], "}"}], "  ", "\n", 
            "\n", "bursts"}], " ", "-", " ", 
           RowBox[{"list", " ", "of", " ", "bursts", " ", 
            RowBox[{"{", 
             RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}]}]}]}], ",", 
      " ", 
      RowBox[{
      "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
       "arrival", " ", "times", " ", "and", " ", "colors", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "c0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "c1"}], "}"}], ",", "..."}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "first", " ", "photon", " ", "arrives", " ", "at", " ", 
        "t"}], "=", 
       RowBox[{
        RowBox[{"0", "\n", "mlPar"}], " ", "-", " ", 
        RowBox[{"ML", " ", "parameters", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e1", ",", "e2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "}"}], " ", "calculated", " ",
          "separately"}]}]}]}], "\n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dim", ",", "x", ",", "result0", ",", "f0", ",", "f0ML", ",", "mCoef", 
       ",", "table", ",", "temp", ",", "mCovariance", ",", "stdList", ",", 
       "mZ"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"dim", "=", "4"}], ";", 
      RowBox[{"(*", 
       RowBox[{"the", " ", "number", " ", "of", " ", "parameters"}], "*)"}], 
      "\n", 
      RowBox[{"result0", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mlPar", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Total", "[", 
           RowBox[{"mlPar", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"mlPar", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
           RowBox[{"Total", "[", 
            RowBox[{"mlPar", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], "//", 
        "Flatten"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"list", " ", "of", " ", "ML", " ", "parameters", " ", 
        RowBox[{"{", 
         RowBox[{"e1", ",", "e2", ",", "k", ",", "p1"}], "}"}]}], "*)"}], 
      "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "logL"}], 
         RowBox[{"(", 
          RowBox[{"e1", ",", "e2", ",", "k", ",", "p1"}], ")"}]}], ",", " ", 
        RowBox[{
        "fitted", " ", "later", " ", "to", " ", "a", " ", "quadratic", " ", 
         "function"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"f0", "[", 
        RowBox[{
        "xe1_Real", ",", "xe2_Real", ",", "xk_Real", ",", "xp1_Real"}], "]"}],
        ":=", 
       RowBox[{"-", 
        RowBox[{
         StyleBox["logLColorMLDyn2st",
          FontWeight->"Bold"], "[", 
         RowBox[{"bursts", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xe1", ",", "xe2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xk", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "xp1"}], ")"}]}], ",", 
              RowBox[{"xk", " ", "xp1"}]}], "}"}]}], "}"}]}], "]"}]}]}], ";", 
      "\n", 
      RowBox[{"f0ML", "=", 
       RowBox[{"f0", "@@", "result0"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "value", " ", "at", " ", "max"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"mCoef", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "matrix", " ", "of", " ", "coefficients", " ", "of", " ", "quadratic", 
        " ", "fitting", " ", "for", " ", "4", 
        RowBox[{"(", "dim", ")"}], " ", "parameters"}], "*)"}], "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "calculate", " ", "diagonal", " ", "terms", " ", "of", " ", "mCoef"}],
         "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{
                   RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}], "->", 
                   RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "ipar", "]"}], "]"}]}]}]}], ")"}]}], "-", 
               "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"ipar", ",", "ipar"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{"table", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "x", ",", 
                 RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", 
             "x", ",", "2"}], "]"}], "/", 
           RowBox[{
            RowBox[{"result0", "[", 
             RowBox[{"[", "ipar", "]"}], "]"}], "^", "2"}]}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
          "fitting", " ", "and", " ", "divide", " ", "by", " ", "the", " ", 
          "ml", " ", "parameter", " ", "squared"}], " ", "*)"}], "\n", 
        RowBox[{"{", 
         RowBox[{"ipar", ",", "dim"}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Calculate", " ", "off"}], "-", 
         RowBox[{"diagonal", " ", "terms", " ", "of", " ", "mCoef"}]}], " ", 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"table", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"j", " ", ",", 
              RowBox[{
               RowBox[{"f0", "@@", 
                RowBox[{"(", 
                 RowBox[{"result0", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "->", 
                    RowBox[{"j", " ", 
                    RowBox[{"result0", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}]}]}]}], "}"}]}], ")"}]}], 
               "-", "f0ML"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"1", "-", "0.05"}], ",", " ", 
              RowBox[{"1", "+", "0.05"}], ",", "0.01"}], "}"}]}], "]"}]}], 
         ";", " ", "\n", 
         RowBox[{"temp", "=", 
          RowBox[{"Coefficient", "[", 
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"table", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "x", ",", 
                RowBox[{"x", "^", "2"}]}], "}"}], ",", "x"}], "]"}], ",", "x",
             ",", "2"}], "]"}]}], ";", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "the", " ", "coefficient", " ", "of", " ", "the", " ", 
           "table", " ", "at", " ", 
           SuperscriptBox["j", "2"]}], "*)"}], "\n", "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"temp", "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "i1"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{
              RowBox[{"mCoef", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "i2"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"result0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], " ", 
             RowBox[{"result0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "recalculate", " ", "the", " ", "coefficient", " ", "to", " ", 
           "find", " ", 
           SubscriptBox["a", "ij"]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i2", ",", "i1"}], "]"}], "]"}], "=", " ", 
          RowBox[{"mCoef", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "use", " ", "symmetry", "  ", "of", " ", "the", " ", "matrix", " ", 
          "to", " ", "find", " ", "other", " ", "elements"}], " ", "*)"}], 
        "\n", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "dim"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", 
          RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "find", " ", "the", " ", "covariance", " ", "matrix", " ", "by", " ", 
        "inverting", " ", "coef"}], "*)"}], "\n", 
      RowBox[{"mCovariance", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"2", " ", "mCoef"}], "]"}]}], ";", " ", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Standard", " ", "deviation", " ", "is", " ", "the", " ", "square", 
        " ", "root", " ", "of", " ", "the", " ", "corresponding", " ", 
        "diagonal", " ", "term", " ", "of", " ", "the", " ", "covariance", 
        " ", "matrix"}], "*)"}], "\n", 
      RowBox[{"stdList", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Diagonal", "[", "mCovariance", "]"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< std: (\[Delta]e1,\[Delta]e2,\[Delta]k,\[Delta]p1) = \>\"", ",", 
        "stdList"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\< (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k/k,\[Delta]p1/p1) = \
(%)\>\"", ",", 
        RowBox[{"100", " ", 
         RowBox[{"stdList", "/", "result0"}]}]}], "]"}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"stdList", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}]}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}]], "Code",
 CellChangeTimes->{{3.857828097559574*^9, 3.857828194007698*^9}, {
   3.85782841823205*^9, 3.857828418425572*^9}, 3.857828613163211*^9, {
   3.857828968759426*^9, 3.857828974544918*^9}, {3.8578290442417507`*^9, 
   3.857829044563747*^9}, {3.857829074631036*^9, 3.8578291042214565`*^9}, {
   3.8578291458878775`*^9, 3.857829238048008*^9}, 3.857829421021576*^9, {
   3.857829520693486*^9, 3.8578295286928062`*^9}, {3.857829563084128*^9, 
   3.857829594548587*^9}, {3.8578296304109344`*^9, 3.857829664883241*^9}, {
   3.8578297868778315`*^9, 3.8578298087658625`*^9}, {3.857830175070758*^9, 
   3.857830205766608*^9}, {3.857830720048303*^9, 3.857830786852687*^9}, {
   3.8578386206551743`*^9, 3.8578386328804483`*^9}, 3.8581603537255497`*^9, 
   3.8581720905819454`*^9, {3.858175465324697*^9, 3.858175467959547*^9}, {
   3.8585857128665075`*^9, 3.858585717890374*^9}, {3.858585751989633*^9, 
   3.8585860021440372`*^9}, {3.8585860486735444`*^9, 
   3.8585861719989986`*^9}, {3.858586449725343*^9, 3.858586517018188*^9}, 
   3.858586549105003*^9, {3.858586581820258*^9, 3.858586630889717*^9}, {
   3.858586669033432*^9, 3.8585866746724653`*^9}, {3.858586722426854*^9, 
   3.858586723089554*^9}, {3.858586758032625*^9, 3.85858675972492*^9}, {
   3.858586823654657*^9, 3.858586844767112*^9}, {3.858586895103148*^9, 
   3.858586901012944*^9}, {3.85858693634341*^9, 3.8585871919171376`*^9}, {
   3.858587228461443*^9, 3.858587232589292*^9}, {3.858587373100877*^9, 
   3.85858738170232*^9}, {3.8585876806145115`*^9, 3.858587732592875*^9}, {
   3.858587824703308*^9, 3.8585878371918306`*^9}, {3.8585892179398785`*^9, 
   3.858589244881795*^9}, {3.858589320719643*^9, 3.858589323557064*^9}, {
   3.858589748412521*^9, 3.858589750946574*^9}, {3.858603155890789*^9, 
   3.858603258196697*^9}, {3.859468026844148*^9, 3.859468027754753*^9}, {
   3.859468107077246*^9, 3.859468519814144*^9}, {3.859468550173286*^9, 
   3.859468670046273*^9}, {3.859468716586191*^9, 3.859468743555145*^9}, {
   3.859468811427297*^9, 3.859468844253744*^9}, {3.859468875861836*^9, 
   3.859469102224951*^9}, {3.85946921160175*^9, 3.859469234195001*^9}, {
   3.85946927540121*^9, 3.859469322502188*^9}, {3.85946937313416*^9, 
   3.859469661559002*^9}, {3.85946972416766*^9, 3.859469724333266*^9}, {
   3.859469814090324*^9, 3.859469856862876*^9}, {3.859471936627837*^9, 
   3.859472067184894*^9}, {3.859472260094407*^9, 3.859472517707792*^9}, {
   3.85947257722421*^9, 3.8594726646524353`*^9}, {3.859472715522278*^9, 
   3.8594727179784913`*^9}, {3.8594730588921638`*^9, 3.859473062595656*^9}, {
   3.859473285051643*^9, 3.859473443684016*^9}, {3.859473543611983*^9, 
   3.8594735472502794`*^9}, {3.859473583978324*^9, 3.859473603607573*^9}, {
   3.859473637250788*^9, 3.859473750318581*^9}, {3.859473790905247*^9, 
   3.859473873953479*^9}, {3.859473939689728*^9, 3.859473963060348*^9}, {
   3.859474584321315*^9, 3.859474596131372*^9}, {3.85947466564873*^9, 
   3.859474676880967*^9}, {3.859474876470188*^9, 3.8594751622805023`*^9}, 
   3.85947531806351*^9, {3.8594753529544077`*^9, 3.859475379054974*^9}, {
   3.859475451219303*^9, 3.859475532894684*^9}, {3.859529855676712*^9, 
   3.85952993864158*^9}, {3.859529979584072*^9, 3.859530013523413*^9}, {
   3.8595300902418933`*^9, 3.859530276660777*^9}, {3.859530310018196*^9, 
   3.859530319601689*^9}, {3.859530429560343*^9, 3.8595304796034713`*^9}, {
   3.8595305100817184`*^9, 3.8595305937094493`*^9}, {3.859530654067239*^9, 
   3.8595310997181144`*^9}, {3.859531161690531*^9, 3.859531480368295*^9}, {
   3.859531764486404*^9, 3.859531933899324*^9}, {3.859531968920547*^9, 
   3.859531969663051*^9}, {3.85953221363411*^9, 3.859532214363294*^9}, {
   3.859533074575778*^9, 3.85953307561753*^9}, {3.8595332711466036`*^9, 
   3.8595332940354557`*^9}, {3.85953334743785*^9, 3.859533351015493*^9}, {
   3.859628187721283*^9, 3.859628194827474*^9}, {3.8596282465606947`*^9, 
   3.859628297715685*^9}, {3.859628340261663*^9, 3.859628357784096*^9}, {
   3.903162298497164*^9, 3.9031623863186007`*^9}, {3.903162436358452*^9, 
   3.903162502382076*^9}, {3.903163622421395*^9, 3.903163706311583*^9}, {
   3.903163745536602*^9, 3.903163806016772*^9}, {3.903172508814447*^9, 
   3.903172508972825*^9}, {3.90343220298139*^9, 3.903432362937925*^9}, {
   3.9034324128532543`*^9, 3.903432417825158*^9}, {3.924964643589987*^9, 
   3.924964863848978*^9}, 3.925018902007969*^9, 3.925018942507794*^9, {
   3.9279754492052937`*^9, 3.927975464387949*^9}, {3.9279755332702637`*^9, 
   3.927975706215287*^9}, {3.927975770034975*^9, 3.927975771258948*^9}, {
   3.9279758346680164`*^9, 3.927975903459463*^9}, {3.927975958943796*^9, 
   3.927975987992052*^9}, {3.927976032067055*^9, 3.927976212323504*^9}, {
   3.927976269899597*^9, 3.9279762845061245`*^9}, {3.92797780488196*^9, 
   3.927977805386559*^9}, {3.9415451145190983`*^9, 3.941545154369032*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"a88be000-0a70-e445-b32b-2cc63962f2f9"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["eBNCorr",
  FontWeight->"Bold"],
 "[eApp_, bA_, bD_, nAv_] -- correction of the apparent FRET efficiency ",
 StyleBox["eApp",
  FontSlant->"Italic"],
 " for background noise (BN) with acceptor and donor count rates ",
 StyleBox["bA",
  FontSlant->"Italic"],
 " and ",
 StyleBox["bD",
  FontSlant->"Italic"],
 "; ",
 StyleBox["nAv",
  FontSlant->"Italic"],
 " - average photon count rate including BN."
}], "Subtitle",
 CellChangeTimes->{{3.9104549233771067`*^9, 3.910454932540234*^9}, {
  3.924959740165535*^9, 3.924959745886356*^9}, {3.941219073934387*^9, 
  3.941219075453909*^9}, {3.941219627807867*^9, 3.9412196460724926`*^9}, {
  3.9412791105761395`*^9, 3.941279231191601*^9}},
 FontSize->14,ExpressionUUID->"6713a408-1a0a-864d-818b-53aa94a058d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eBNCorr", "[", 
    RowBox[{"eApp_", ",", "bA_", ",", "bD_", ",", "nAv_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"eApp", "-", 
      RowBox[{"bA", "/", "nAv"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bA", "+", "bD"}], ")"}], "/", "nAv"}]}], ")"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "FRET", " ", "efficiency", " ", "corrected", " ", "for", " ", 
      "Background", " ", "Noise"}], ";", " ", "\n", 
     RowBox[{"eApp", " ", "-", " ", 
      RowBox[{
      "apparent", " ", "FRET", " ", "efficiency", " ", "including", " ", "BN",
        "\n", "bA"}]}]}], ",", " ", 
    RowBox[{"bD", " ", "-", " ", 
     RowBox[{
     "acceptor", " ", "and", " ", "donor", " ", "photon", " ", "count", " ", 
      "rates", "\n", "nAv"}], " ", "-", " ", 
     RowBox[{
     "average", " ", "photon", " ", "count", " ", "rate", " ", "of", " ", 
      "corresponding", " ", "species"}]}], ",", " ", "\n", 
    RowBox[{
    "obtained", " ", "from", " ", "data", " ", "as", " ", "the", " ", "ratio",
      " ", "of", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
     "photons", " ", "in", " ", "selected", " ", "bursts", " ", "to", " ", 
     "the", " ", "total", " ", "duration", " ", "of", " ", "the", " ", 
     "bursts"}]}], "*)"}]}]}], "Code",
 CellChangeTimes->{{3.910448662300199*^9, 3.910448687262807*^9}, {
   3.910448726136501*^9, 3.910448845313234*^9}, {3.9104488821857*^9, 
   3.910449185731415*^9}, {3.910449224245112*^9, 3.910449267699725*^9}, 
   3.9104493103874063`*^9, {3.9104546366983423`*^9, 3.910454653505842*^9}, {
   3.9104547752734623`*^9, 3.910454867416813*^9}, {3.925021361236174*^9, 
   3.925021520092488*^9}, {3.925033562402018*^9, 3.925033562554085*^9}, {
   3.94154519930525*^9, 
   3.9415452147763023`*^9}},ExpressionUUID->"b8591cde-dc88-e548-9990-\
38379c232f2b"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Burst Fractions", "Section",
 CellChangeTimes->{{3.857043622670629*^9, 3.857043658166289*^9}, {
   3.858683521545704*^9, 3.8586835378057165`*^9}, {3.863709228939097*^9, 
   3.863709241679551*^9}, {3.866194556163769*^9, 3.866194568739001*^9}, {
   3.8676674652546024`*^9, 3.867667475667978*^9}, {3.872697420590452*^9, 
   3.872697429318453*^9}, 3.8737929662466*^9, {3.8768110226807437`*^9, 
   3.87681103600689*^9}, {3.8843453180314493`*^9, 3.884345336736976*^9}, {
   3.891596411249891*^9, 3.891596420147685*^9}, {3.891615210435973*^9, 
   3.8916152399932156`*^9}, {3.89167949349406*^9, 3.891679514814599*^9}, {
   3.892029165810185*^9, 3.892029166825779*^9}, {3.892042188451593*^9, 
   3.892042197267248*^9}, {3.892053619033068*^9, 3.892053647399187*^9}, {
   3.89644311195296*^9, 3.896443123906438*^9}, {3.896443731678987*^9, 
   3.896443739902118*^9}, {3.9054165821078405`*^9, 3.90541660102119*^9}, {
   3.910892815024537*^9, 3.9108928161577663`*^9}, {3.9249589402256794`*^9, 
   3.924958942572378*^9}, {3.924959388288381*^9, 3.924959426633196*^9}, {
   3.925019128572897*^9, 3.9250191391920147`*^9}, 3.925115126596044*^9, {
   3.9412178481578407`*^9, 
   3.941217851689335*^9}},ExpressionUUID->"22be18a9-4604-184f-b798-\
2e9907e02468"],

Cell["\<\
When  transitions  are  slow, the population of states in colorML is related \
to the  fraction of bursts emitted by a molecule in corresponding state. This \
fraction can be estimated when count rates and diffusion coefficients are \
known and used to correct the colorML population when the states have unequal \
brightness and diffusivity.\
\>", "Text",
 CellChangeTimes->{{3.941296367574663*^9, 
  3.9412965535255413`*^9}},ExpressionUUID->"26e53366-a709-904f-8d70-\
b374fc5da731"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["matricesStatic",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[n0_,e_,taud_,bA_,bD_,qMax_,jMax_] -- calculates matrices ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "A"], ",", " ", 
    SubscriptBox["N", "D"], ",", " ", 
    RowBox[{"L", "-", 
     SubscriptBox["N", "A"], "-", 
     SubscriptBox["N", "D"]}], ",", "  ", 
    RowBox[{"and", " ", "vector", " ", 
     SubscriptBox["p", "0"]}]}], TraditionalForm]],
  FontColor->GrayLevel[0],ExpressionUUID->
  "780073ff-1697-aa43-9d5b-32ab960fc699"],
 StyleBox["; isotropic laser spot approximation (1 discretized coordinate)",
  FontColor->GrayLevel[0]]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.903022288884467*^9, 
   3.9030223002580175`*^9}, {3.903022676526078*^9, 3.9030226960519857`*^9}, {
   3.903022743293788*^9, 3.9030228110361643`*^9}, {3.9030276917840576`*^9, 
   3.903027695901171*^9}, {3.924958138315531*^9, 3.924958140064163*^9}, {
   3.9249593025740776`*^9, 3.9249593207446384`*^9}, {3.9249602483479805`*^9, 
   3.9249602483479805`*^9}, {3.927970740398096*^9, 3.927970741688919*^9}, 
   3.941457873801203*^9},
 FontSize->14,ExpressionUUID->"7ecd24c7-8f0f-d54c-9338-4acd67517950"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matricesStatic", "[", 
   RowBox[{
   "n0_", ",", "e_", ",", "taud_", ",", "bA_", ",", "bD_", ",", "qMax_", ",", 
    "jMax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"May", " ", "17"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", 
      RowBox[{"matrices", " ", 
       SubscriptBox["N", "A"]}]}], ",", " ", 
     SubscriptBox["N", "D"], ",", " ", 
     RowBox[{"L", "+", "K", "-", "N"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "vector", " ", 
       SubscriptBox["p", "eq"]}], ";", "\n", 
      RowBox[{"diffusing", " ", "molecule"}]}], ",", " ", 
     RowBox[{
     "a", " ", "single", " ", "state", " ", "without", " ", "transitions", 
      " ", "\n", "isotropic", " ", "spot", " ", "approximation"}], ",", " ", 
     RowBox[{
      RowBox[{"1", " ", "discretized", " ", "coordinate"}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"return", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["N", "A"], ",", 
            SubscriptBox["N", "D"], ",", 
            RowBox[{"L", "+", "K", "-", "N"}], ",", "peq"}], "}"}], "\n", 
          "\n", "n0"}], " ", "-", " ", 
         RowBox[{
         "photon", " ", "count", " ", "rate", " ", "at", " ", "the", " ", 
          "center", " ", "of", " ", "the", " ", "laser", " ", "spot", "\n", 
          "e"}], " ", "-", "  ", 
         RowBox[{"FRET", " ", "efficiency", " ", 
          RowBox[{"(", 
           RowBox[{"without", " ", "BN"}], ")"}], "\n", "taud"}]}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "^", "2"}], "/", "d"}], " ", "-", " ", 
        RowBox[{"difusion", " ", "time", " ", 
         RowBox[{"(", 
          RowBox[{"a", " ", "-", " ", 
           RowBox[{
           "size", " ", "of", " ", "the", " ", "isotropic", " ", "spot"}]}], 
          ")"}], "\n", "bA"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"bD", " ", "-", " ", 
       RowBox[{
       "acceptor", " ", "and", " ", "donor", " ", "background", " ", "count", 
        " ", "rates", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
       RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
       " ", "-", " ", 
       RowBox[{
       "max", " ", "number", " ", "of", " ", "discretized", " ", 
        "points"}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "delta", ",", "q", ",", "lp", ",", "lm", ",", "j", ",", "mL", ",", "mNA",
       ",", "mND", ",", "peq"}], "}"}], ",", "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{"delta", "=", 
      RowBox[{"qMax", "/", "jMax"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"q", "[", "j_", "]"}], "=", 
      RowBox[{"delta", " ", 
       RowBox[{"(", 
        RowBox[{"j", "-", 
         RowBox[{"1", "/", "2"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"dimensionless", " ", "coordinate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lp", "[", "j_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"j", "+", 
          RowBox[{"1", "/", "2"}]}], "]"}], "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"matrix", " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", "[", "j_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"j", "-", 
          RowBox[{"1", "/", "2"}]}], "]"}], "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"delta", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", "[", "1", "]"}], "=", "0"}], ";", "\n", 
     RowBox[{
      RowBox[{"lp", "[", "jMax", "]"}], "=", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"reflecting", " ", "bc"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"diffusion", " ", "matrix", " ", "L"}], "*)"}], "\n", 
     RowBox[{"mL", "=", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}], "->", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lp", "[", "i", "]"}], "+", 
                 RowBox[{"lm", "[", "i", "]"}]}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
              RowBox[{"lp", "[", "i", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"jMax", "-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "i"}], "}"}], "->", 
              RowBox[{"lm", "[", "i", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "2", ",", "jMax"}], "}"}]}], "]"}]}], "}"}], "//",
          "Flatten"}], "\[IndentingNewLine]", "]"}], "/", "taud"}]}], ";", 
     "\n", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "diagonal", " ", "matrix", " ", "NA", " ", "and", " ", "ND", " ", "of", 
       " ", "the", " ", "count", " ", "rates"}], " ", "*)"}], "\n", 
     RowBox[{"mNA", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}], "->", 
          RowBox[{
           RowBox[{"n0", " ", "e", " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{
               RowBox[{"q", "[", "i", "]"}], "^", "2"}]}], "]"}]}], "+", 
           "bA"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"mND", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "i"}], "}"}], "->", 
          RowBox[{
           RowBox[{"n0", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "e"}], ")"}], " ", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{
               RowBox[{"q", "[", "i", "]"}], "^", "2"}]}], "]"}]}], "+", 
           "bD"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "jMax"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"vector", " ", 
       SubscriptBox["p", "eq"]}], "*)"}], "\n", 
     RowBox[{"peq", "=", 
      RowBox[{"4", " ", "Pi", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], "^", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "jMax"}], "}"}]}], "]"}]}]}], ";", "\n", "\n", 
     RowBox[{"{", 
      RowBox[{"mNA", ",", "mND", ",", 
       RowBox[{"mL", "-", "mNA", "-", "mND"}], ",", "peq"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.8328651111680064`*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.867242428034723*^9, 3.867242492515263*^9}, {3.867242529268175*^9, 
   3.867242560990389*^9}, 3.867242621479858*^9, {3.867242653420859*^9, 
   3.867242669582061*^9}, 3.867243147705471*^9, {3.867243368583119*^9, 
   3.867243383499181*^9}, {3.8672434472304697`*^9, 3.867243447507744*^9}, {
   3.867243495845126*^9, 3.8672435394414787`*^9}, {3.8672437597197824`*^9, 
   3.86724389989441*^9}, {3.867244111226159*^9, 3.867244152016118*^9}, {
   3.867244186852701*^9, 3.86724425254836*^9}, {3.8672443127818813`*^9, 
   3.867244326587611*^9}, {3.8672443689238586`*^9, 3.867244392771106*^9}, 
   3.867244511004591*^9, 3.867249228010229*^9, {3.883071995943559*^9, 
   3.883071998573907*^9}, {3.891600909761977*^9, 3.891601144276834*^9}, 
   3.891601209473031*^9, 3.891601412646661*^9, {3.891609401118507*^9, 
   3.891609422421115*^9}, {3.892546464701019*^9, 3.8925465663859944`*^9}, {
   3.892546625201773*^9, 3.8925467280634203`*^9}, {3.903022350910239*^9, 
   3.9030224198019505`*^9}, {3.9030224640470266`*^9, 3.903022483275598*^9}, {
   3.903022545113713*^9, 3.903022644301353*^9}, {3.903022824030433*^9, 
   3.903022826535358*^9}, {3.903027706278975*^9, 3.903027709831978*^9}, {
   3.9249581508006535`*^9, 3.92495819554458*^9}, {3.9279781768098087`*^9, 
   3.927978177782807*^9}, 3.941483793316653*^9, {3.941545303913494*^9, 
   3.9415454302449417`*^9}, {3.9415454761420555`*^9, 
   3.9415454796079464`*^9}},ExpressionUUID->"07f92517-9144-f547-b410-\
88444e72bb33"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["z",
  FontWeight->"Bold"],
 "[n0_, taud_, w_,b_, nTh_, tTh_, qMax_, jMax_] - normalization factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Z", " ", ";"}], " "}], TraditionalForm]],ExpressionUUID->
  "1a75ded2-5156-5848-93f4-0512aa3be187"]
}], "Subtitle",
 CellChangeTimes->{{3.910892824737662*^9, 3.910892824739656*^9}, 
   3.910892986079067*^9, {3.924959430233282*^9, 3.9249594388405304`*^9}, {
   3.925019147428234*^9, 3.9250191813566265`*^9}, {3.925021222215349*^9, 
   3.925021223179949*^9}, {3.925036671841088*^9, 3.925036673122158*^9}, 
   3.941457883262602*^9, {3.9415454420873337`*^9, 3.9415454426425304`*^9}},
 FontSize->14,ExpressionUUID->"eb8684f3-1364-bb4b-90c9-7e1b3f580a2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "[", 
   RowBox[{
   "n0_", ",", "taud_", ",", "w_", ",", "b_", ",", "nTh_", ",", "tTh_", ",", 
    "qMax_", ",", "jMax_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", "  ", 
    RowBox[{
     RowBox[{"May", " ", "17"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", 
      RowBox[{
      "normalization", " ", "factor", " ", "Z", " ", "\n", "\n", "diffusing", 
       " ", "molecule"}]}], ",", " ", 
     RowBox[{
     "a", " ", "single", " ", "state", " ", "without", " ", "transitions", 
      " ", "\n", "isotropic", " ", "spot", " ", "approximation"}], ",", " ", 
     RowBox[{
      RowBox[{"1", " ", "discretized", " ", "coordinate"}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"return", ":", " ", 
        RowBox[{
         RowBox[{"Z", "\n", "\n", "n0"}], " ", "-", " ", 
         RowBox[{
         "photon", " ", "count", " ", "rate", " ", "at", " ", "the", " ", 
          "center", " ", "of", " ", "the", " ", "laser", " ", "spot", "\n", 
          "e"}], " ", "-", "  ", 
         RowBox[{"FRET", " ", "efficiency", " ", 
          RowBox[{"(", 
           RowBox[{"without", " ", "BN"}], ")"}], "\n", "taud"}], " ", "-", 
         " ", 
         RowBox[{
         "difusion", " ", "time", " ", "in", " ", "the", " ", "elongated", 
          " ", "spot", "  ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["a", "xy"], "2"], "/", "D"}], " ", 
          RowBox[{"(", 
           RowBox[{
           "with", " ", "the", " ", "correction", " ", "factor", " ", 
            "included", " ", "inside", " ", "the", " ", "module"}], ")"}], 
          "\n", "w"}], " ", "-", " ", 
         RowBox[{"axial", " ", "ratio", " ", 
          RowBox[{
           SubscriptBox["a", "z"], "/", 
           SubscriptBox["a", "xy"]}], "\n", "b"}]}]}], "=", 
       RowBox[{"bA", "+", "bD", " ", "-", " ", 
        RowBox[{
        "total", " ", "acceptor", " ", "and", " ", "donor", " ", "background",
          " ", "count", " ", "rate", "\n", "nTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
         "photons", " ", "in", " ", "a", " ", "burst"}]}]}]}], ",", " ", 
     RowBox[{"N", ">=", 
      RowBox[{
       RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
     "  ", 
     RowBox[{
      RowBox[{"\[Tau]", "<", 
       RowBox[{"tTh", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
       RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
       " ", "-", " ", 
       RowBox[{
       "max", " ", "number", " ", "of", " ", "discretized", " ", 
        "points"}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mN", ",", "mRate", ",", "vals", ",", "vecs", ",", "valsZero", ",", 
      "zero", ",", "valsInt", ",", "vals1", ",", "vecs1", ",", "mM", ",", 
      "first", ",", "\n", "p0", ",", "pin", ",", "pf"}], "}"}], ",", 
    "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mN", ",", "mRate", ",", "p0"}], "}"}], "=", 
      RowBox[{
       RowBox[{"matricesStatic", "[", 
        RowBox[{"n0", ",", "0", ",", 
         RowBox[{"taud", " ", 
          RowBox[{"corrPhi", "[", "w", "]"}]}], ",", "0", ",", "b", ",", 
         "qMax", ",", "jMax"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"count", " ", "rate", " ", "matrix"}], ",", " ", 
       RowBox[{"rate", " ", "matrix"}], ",", " ", "p0"}], " ", "*)"}], "\n", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mRate", "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"eigenvalues", " ", "and", " ", "eigenfunctions"}], "*)"}], 
     "\n", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "fix", " ", "zero", " ", "eigenvalue", " ", "problem", " ", "in", " ", 
       "mM"}], " ", "*)"}], "\n", 
     RowBox[{"valsZero", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"vals", ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "zero"}], ",", "1"}], "]"}]}], 
     ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "replace", " ", "zero", " ", "eigenvalue", " ", "by", " ", "zero"}], 
      " ", "*)"}], "\n", 
     RowBox[{"valsInt", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"vals", " ", "tTh"}], "]"}], "-", "1"}], ")"}], "/", 
         "valsZero"}], ",", 
        RowBox[{
         RowBox[{"x_", "/;", 
          RowBox[{"x", "==", "0."}]}], "->", "tTh"}], ",", "1"}], "]"}]}], 
     ";", "\n", "\n", 
     RowBox[{"mM", "=", 
      RowBox[{"mN", ".", 
       RowBox[{"vecs", "\[Transpose]"}], ".", 
       RowBox[{"DiagonalMatrix", "[", "valsInt", "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"vecs", "\[Transpose]"}], "]"}]}]}], ";", " ", "\n", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals1", ",", "vecs1"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", "mM", "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
      "eienvalues", " ", "and", " ", "eigenvectors", " ", "of", " ", "M"}], 
      "*)"}], "\n", "\n", 
     RowBox[{"pin", "=", 
      RowBox[{
       RowBox[{"vecs", "\[Transpose]"}], ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"vecs", "\[Transpose]"}], "]"}], ".", "p0"}]}], ";", "\n", 
     RowBox[{"pf", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", "jMax"}], "]"}], ".", 
       RowBox[{"vecs", "\[Transpose]"}], ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"vals", " ", "tTh"}], "]"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"vecs", "\[Transpose]"}], "]"}]}]}], ";", "\n", "\n", 
     RowBox[{"pf", ".", 
      RowBox[{"vecs1", "\[Transpose]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vals1", "^", 
          RowBox[{"(", 
           RowBox[{"nTh", "-", "1"}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vals1"}], ")"}]}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"vecs1", "\[Transpose]"}], "]"}], ".", "mN", ".", "pin"}]}]}], 
   " ", "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->{{3.831558755501127*^9, 3.8315587575233145`*^9}, {
   3.831558797741019*^9, 3.831558916382979*^9}, {3.831560178763912*^9, 
   3.8315602049176106`*^9}, {3.831560250443149*^9, 3.831560251492424*^9}, {
   3.8315602870626097`*^9, 3.831560388355133*^9}, {3.831560593116764*^9, 
   3.831560594430298*^9}, {3.831560660921203*^9, 3.8315606779310026`*^9}, {
   3.831560731827955*^9, 3.8315607413895216`*^9}, {3.831561256903435*^9, 
   3.831561264645565*^9}, {3.831561332802137*^9, 3.831561335170785*^9}, {
   3.831561512553667*^9, 3.831561517212601*^9}, {3.831561717161616*^9, 
   3.831561721030436*^9}, {3.83156205281688*^9, 3.831562069946116*^9}, {
   3.8315621087879114`*^9, 3.831562109255873*^9}, {3.831562241419222*^9, 
   3.831562272082859*^9}, {3.8315623151714478`*^9, 3.831562315760946*^9}, {
   3.831562359313642*^9, 3.831562393316338*^9}, {3.831562448955311*^9, 
   3.831562493834184*^9}, {3.831562533834341*^9, 3.8315625384807725`*^9}, {
   3.831562605998551*^9, 3.83156261916351*^9}, {3.831562654578966*^9, 
   3.831562661556679*^9}, {3.8315627365953007`*^9, 3.831562757393388*^9}, {
   3.831562983631778*^9, 3.831563024332579*^9}, 3.831565605092565*^9, {
   3.83156570413702*^9, 3.831565714174383*^9}, {3.8315657756482*^9, 
   3.8315657767556477`*^9}, {3.831565866967497*^9, 3.831565886109122*^9}, {
   3.831565970077132*^9, 3.83156597462907*^9}, {3.831566352947871*^9, 
   3.8315663622024016`*^9}, {3.831566558146302*^9, 3.831566562316964*^9}, {
   3.831567734478528*^9, 3.831567737780408*^9}, 3.831728909349518*^9, {
   3.831729073210167*^9, 3.8317294071603107`*^9}, {3.831729445725483*^9, 
   3.831729453976568*^9}, {3.831729484125134*^9, 3.8317294864414473`*^9}, {
   3.8317295460954156`*^9, 3.831729658216906*^9}, {3.831729883050532*^9, 
   3.831729967786326*^9}, {3.831735751663984*^9, 3.83173576912384*^9}, {
   3.831735849986325*^9, 3.831735993764864*^9}, {3.832676035764168*^9, 
   3.832676079313406*^9}, {3.83267614455806*^9, 3.832676149150703*^9}, {
   3.83275355584862*^9, 3.83275356045973*^9}, {3.832768437340783*^9, 
   3.832768441639168*^9}, {3.832769009505863*^9, 3.832769012926512*^9}, {
   3.832840544592169*^9, 3.832840595004842*^9}, {3.832840627265619*^9, 
   3.832840629623565*^9}, {3.832841221139524*^9, 3.832841336562183*^9}, {
   3.832841388293797*^9, 3.832841529352778*^9}, 3.832841593087763*^9, {
   3.8328605508271337`*^9, 3.832860551842874*^9}, {3.832860642767151*^9, 
   3.832860645831888*^9}, {3.832863774986405*^9, 3.8328637756425*^9}, {
   3.832863808476223*^9, 3.832863818775749*^9}, {3.8328651111680064`*^9, 
   3.832865111808898*^9}, {3.832865501604945*^9, 3.83286552693767*^9}, {
   3.8329326908689027`*^9, 3.832932699604748*^9}, {3.832940846277726*^9, 
   3.83294085520256*^9}, {3.832941024041624*^9, 3.8329411180144567`*^9}, {
   3.8329411678854384`*^9, 3.8329411693068767`*^9}, {3.832941213197667*^9, 
   3.832941222856441*^9}, {3.8329515117749243`*^9, 3.832951511915819*^9}, {
   3.832953902306124*^9, 3.832953929672965*^9}, {3.832955482526454*^9, 
   3.832955492153642*^9}, {3.832958980635526*^9, 3.832958991606631*^9}, {
   3.83295992109474*^9, 3.832959932456202*^9}, {3.833027939513659*^9, 
   3.833027965064051*^9}, {3.833029424200046*^9, 3.833029439950867*^9}, {
   3.83302981056361*^9, 3.8330298976527653`*^9}, {3.8333645105026884`*^9, 
   3.833364611061632*^9}, {3.8333670811441493`*^9, 3.8333671120733757`*^9}, {
   3.833367142603683*^9, 3.833367143606535*^9}, {3.8333671743841524`*^9, 
   3.833367183553048*^9}, {3.833367230489499*^9, 3.8333672390257273`*^9}, {
   3.833367406578017*^9, 3.83336750011685*^9}, {3.833367554301772*^9, 
   3.833367556474757*^9}, {3.833369437104673*^9, 3.83336946076124*^9}, {
   3.833372830506523*^9, 3.8333728784526258`*^9}, {3.833372910497728*^9, 
   3.833372960383438*^9}, {3.833373030924053*^9, 3.833373045143049*^9}, {
   3.833373279169752*^9, 3.833373281593004*^9}, {3.83337334327094*^9, 
   3.83337344973328*^9}, {3.833472953882684*^9, 3.833473179967276*^9}, {
   3.833473231740118*^9, 3.8334732712657175`*^9}, {3.8334733155626593`*^9, 
   3.8334733370574207`*^9}, {3.833473419176511*^9, 3.833473424574583*^9}, {
   3.833473593366536*^9, 3.833473619716595*^9}, {3.833474112022759*^9, 
   3.8334741698828573`*^9}, {3.833474267026322*^9, 3.833474294375263*^9}, {
   3.833474347690326*^9, 3.833474406295361*^9}, {3.833474639271596*^9, 
   3.833474662384567*^9}, {3.833474710091855*^9, 3.833474724073449*^9}, {
   3.8334748591566916`*^9, 3.833474904285076*^9}, {3.8334749478204956`*^9, 
   3.833474975123524*^9}, 3.833475143074797*^9, {3.83347522658918*^9, 
   3.8334752406242337`*^9}, 3.8334752895676594`*^9, {3.833476052596104*^9, 
   3.833476177979813*^9}, {3.833476640574518*^9, 3.83347664385483*^9}, {
   3.833476675199948*^9, 3.8334767178192387`*^9}, {3.833696202467212*^9, 
   3.833696207962532*^9}, {3.833696627370323*^9, 3.833696644637524*^9}, {
   3.8336966848463774`*^9, 3.833696685684562*^9}, {3.833696720374271*^9, 
   3.83369674759152*^9}, {3.8338052988512487`*^9, 3.833805425815514*^9}, {
   3.833805551644845*^9, 3.833805576657791*^9}, {3.834163839521208*^9, 
   3.834163842663408*^9}, {3.834164598651268*^9, 3.834164642248473*^9}, {
   3.834164681057603*^9, 3.834164706163245*^9}, {3.834164768082939*^9, 
   3.834164781911815*^9}, {3.8341651268915033`*^9, 3.834165132393593*^9}, {
   3.834165197492756*^9, 3.834165325875321*^9}, {3.834165409495172*^9, 
   3.83416542689308*^9}, {3.8341657234824*^9, 3.8341658761153584`*^9}, {
   3.834509653074819*^9, 3.834509653591601*^9}, {3.834511025796572*^9, 
   3.834511209685166*^9}, {3.8345112443981953`*^9, 3.834511250093107*^9}, {
   3.834511586378085*^9, 3.83451159301423*^9}, {3.834511698028097*^9, 
   3.834511702584042*^9}, {3.834511898869835*^9, 3.834511919904207*^9}, {
   3.834512099620034*^9, 3.834512104365228*^9}, {3.834513027330273*^9, 
   3.834513036382973*^9}, {3.834513930780204*^9, 3.83451393424139*^9}, {
   3.834514448460308*^9, 3.83451456663211*^9}, {3.834520222059952*^9, 
   3.8345202887058835`*^9}, {3.834520338202818*^9, 3.834520356235608*^9}, {
   3.834520465146631*^9, 3.834520469322776*^9}, {3.83452050743044*^9, 
   3.834520561424592*^9}, {3.8345206133344584`*^9, 3.834520687382329*^9}, {
   3.834520784013569*^9, 3.834520785529432*^9}, {3.834520864094966*^9, 
   3.834520878946307*^9}, {3.834522324161105*^9, 3.834522768626412*^9}, {
   3.8353759403248773`*^9, 3.835375950809206*^9}, {3.835376602977296*^9, 
   3.835376606142609*^9}, {3.835879437363182*^9, 3.835879446637107*^9}, {
   3.8358795945595*^9, 3.835879596372403*^9}, {3.857130718049742*^9, 
   3.857130761824317*^9}, {3.857130808804911*^9, 3.857130866586254*^9}, {
   3.857131568135592*^9, 3.8571316047441883`*^9}, {3.857131713892329*^9, 
   3.857131832059427*^9}, {3.857132253027142*^9, 3.8571322742295218`*^9}, {
   3.857132343221775*^9, 3.8571323602244654`*^9}, {3.8571324686180234`*^9, 
   3.857132471990389*^9}, {3.857132570826422*^9, 3.857132671201175*^9}, {
   3.857132701389345*^9, 3.857132733841216*^9}, {3.857132892913519*^9, 
   3.857132905142166*^9}, {3.857132947684403*^9, 3.857132958754617*^9}, {
   3.857133025960047*^9, 3.8571330563717756`*^9}, 3.857133134577051*^9, {
   3.85713319951112*^9, 3.857133200167227*^9}, {3.857133241390032*^9, 
   3.857133252142156*^9}, {3.8571333355566635`*^9, 3.857133341249653*^9}, {
   3.857133388011263*^9, 3.85713344673734*^9}, {3.857133516881628*^9, 
   3.857133517263718*^9}, {3.857133897123229*^9, 3.857133922483061*^9}, {
   3.857134027236618*^9, 3.857134038036349*^9}, {3.857134163899369*^9, 
   3.8571341770755982`*^9}, {3.857134229987637*^9, 3.8571342804632044`*^9}, {
   3.857134371684188*^9, 3.857134376105397*^9}, {3.857134498567511*^9, 
   3.857134500337384*^9}, 3.857134595517914*^9, {3.857134644393577*^9, 
   3.85713464716781*^9}, {3.857135154071781*^9, 3.857135203536938*^9}, {
   3.857135259697161*^9, 3.85713526274984*^9}, {3.857149364611351*^9, 
   3.8571493705969744`*^9}, {3.858822127198836*^9, 3.858822136660469*^9}, {
   3.859461596668448*^9, 3.859461726287856*^9}, {3.859462082107832*^9, 
   3.859462092893596*^9}, 3.859462920317589*^9, {3.859463024005192*^9, 
   3.859463024950213*^9}, {3.8594631611963434`*^9, 3.859463167868601*^9}, {
   3.859463237002424*^9, 3.859463311990161*^9}, {3.859463351377907*^9, 
   3.859463373239383*^9}, {3.859464002475232*^9, 3.859464126835088*^9}, {
   3.8594642073850565`*^9, 3.859464218952507*^9}, {3.8594643447944393`*^9, 
   3.859464447303088*^9}, {3.8594644786568227`*^9, 3.859464497371915*^9}, {
   3.859464895480138*^9, 3.859464906409324*^9}, 3.859464945421381*^9, {
   3.859465058712371*^9, 3.859465070921692*^9}, 3.859465104990363*^9, {
   3.859465190891206*^9, 3.859465219864296*^9}, {3.859465270087589*^9, 
   3.859465294279329*^9}, {3.859465413097711*^9, 3.859465464829583*^9}, 
   3.859465732418494*^9, {3.859465810127607*^9, 3.859465813656138*^9}, 
   3.859465852381715*^9, {3.859465894525204*^9, 3.859465906875414*^9}, {
   3.859466041658722*^9, 3.859466063940067*^9}, {3.85946625067324*^9, 
   3.859466261996317*^9}, 3.859466663624732*^9, {3.859466770323827*^9, 
   3.859466861726527*^9}, {3.860528588911055*^9, 3.860528593757845*^9}, {
   3.867242428034723*^9, 3.867242492515263*^9}, {3.867242529268175*^9, 
   3.867242560990389*^9}, 3.867242621479858*^9, {3.867242653420859*^9, 
   3.867242669582061*^9}, 3.867243147705471*^9, {3.867243368583119*^9, 
   3.867243383499181*^9}, {3.8672434472304697`*^9, 3.867243447507744*^9}, {
   3.867243495845126*^9, 3.8672435394414787`*^9}, {3.8672437597197824`*^9, 
   3.86724389989441*^9}, {3.86724440729881*^9, 3.86724449525564*^9}, 
   3.8672445310756435`*^9, {3.867244674164641*^9, 3.8672446747165017`*^9}, {
   3.867245556187465*^9, 3.8672455574706993`*^9}, {3.867248032721158*^9, 
   3.8672480473671*^9}, {3.867248088613968*^9, 3.867248141968791*^9}, {
   3.8672481979929395`*^9, 3.867248284008562*^9}, {3.867248323686466*^9, 
   3.867248394245662*^9}, {3.867248459290366*^9, 3.867248485150243*^9}, 
   3.8672485177384343`*^9, 3.925019822127674*^9, {3.925020287402624*^9, 
   3.925020473960853*^9}, {3.925020578647576*^9, 3.9250205849885387`*^9}, {
   3.9250206646016*^9, 3.925020718139065*^9}, {3.925020858702915*^9, 
   3.925020953002978*^9}, {3.925021039459347*^9, 3.925021044988596*^9}, {
   3.9250367939391193`*^9, 3.925036795107493*^9}, {3.9250368476240654`*^9, 
   3.9250368897230263`*^9}, {3.925036952940949*^9, 3.925037017491982*^9}, {
   3.92503708212438*^9, 3.925037095590767*^9}, {3.925037130067915*^9, 
   3.925037132522963*^9}, 3.92503735261252*^9, {3.925105144911907*^9, 
   3.925105250925749*^9}, {3.925105322303375*^9, 3.925105326855165*^9}, {
   3.925105370959116*^9, 3.9251053724390717`*^9}, {3.925105636151415*^9, 
   3.9251056369308777`*^9}, {3.925107118502676*^9, 3.925107122791159*^9}, {
   3.927970796951321*^9, 3.927970797871389*^9}, 3.941457893666044*^9, 
   3.941483781834505*^9, {3.9415454558813095`*^9, 3.9415454568692207`*^9}, {
   3.941545506933241*^9, 3.941545557507015*^9}, {3.941545634594225*^9, 
   3.9415457026020927`*^9}, {3.9415457405492115`*^9, 
   3.9415458072315826`*^9}, {3.9415458407328606`*^9, 3.941545846351347*^9}, {
   3.941546062913664*^9, 
   3.9415460631991177`*^9}},ExpressionUUID->"f65d1b83-f40f-a243-9455-\
36cb0c4f9c8f"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["pb1",
  FontWeight->"Bold"],
 "[p1_,{n01_,n02_},{taud1_,taud2_},w_,b_,nTh_,tTh_,qMax_,jMax_]-- burst \
fraction for species 1"
}], "Subtitle",
 CellChangeTimes->{{3.910455415147385*^9, 3.910455485974248*^9}, {
   3.924959754831957*^9, 3.924959760159916*^9}, {3.925019228982872*^9, 
   3.925019250307495*^9}, {3.925019376008882*^9, 3.925019379564886*^9}, {
   3.92501942921508*^9, 3.925019430014654*^9}, 3.9284817864432087`*^9, {
   3.941219673023615*^9, 3.9412196865356483`*^9}, {3.9414579208556175`*^9, 
   3.941457923205673*^9}},
 FontSize->14,ExpressionUUID->"3468d4f2-6e80-fb44-b5a4-651da27cbcf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pb1", "[", 
   RowBox[{"p1_", ",", 
    RowBox[{"{", 
     RowBox[{"n01_", ",", "n02_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"taud1_", ",", "taud2_"}], "}"}], ",", "w_", ",", "b_", ",", 
    "nTh_", ",", "tTh_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"May", " ", "17"}], ",", " ", 
     RowBox[{"2024", ";", " ", "\n", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"burst", " ", "fraction", " ", 
         SubscriptBox[
          SuperscriptBox["p", "b"], "1"], " ", "for", " ", "species", " ", 
         "1", " ", "in", " ", "system", " ", "with", " ", "two", " ", "non"}],
         "-", 
        RowBox[{
        "interconverting", " ", "species", "\n", " ", "diffusing", " ", 
         "molecules", " ", "with", " ", "two", " ", "non"}], "-", 
        RowBox[{"interconverting", " ", "states", "\n", "  ", "\n", "p1"}], 
        " ", "-", " ", 
        RowBox[{
        "population", " ", "of", " ", "the", " ", "first", " ", "species", 
         "\n", 
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}]}], " ", "-", " ", 
        RowBox[{
        "count", " ", "rates", " ", "at", " ", "the", " ", "center", " ", 
         "of", " ", "the", " ", "spot", "\n", 
         RowBox[{"{", 
          RowBox[{"taud1", ",", "taud2"}], "}"}]}], " ", "-", " ", 
        RowBox[{"diffusion", " ", "times", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["a", "xy"], "2"], "/", 
          SubscriptBox["D", 
           RowBox[{"1", " "}]]}], "and", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["a", "xy"], "2"], "/", 
          SubscriptBox["D", 
           RowBox[{"2", " "}]]}], "\n", "w"}], " ", "-", " ", 
        RowBox[{"axial", " ", "ratio", " ", 
         RowBox[{
          SubscriptBox["a", "z"], "/", 
          SubscriptBox["a", "xy"]}], "\n", "b"}]}], "=", 
       RowBox[{"bA", "+", "bD", " ", "-", " ", 
        RowBox[{
        "total", " ", "acceptor", " ", "and", " ", "donor", " ", "background",
          " ", "count", " ", "rate", "\n", "nTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
         "photons", " ", "in", " ", "a", " ", "burst"}]}]}]}], ",", " ", 
     RowBox[{"N", ">=", 
      RowBox[{
       RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
       RowBox[{
       "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
     "  ", 
     RowBox[{
      RowBox[{"\[Tau]", "<", 
       RowBox[{"tTh", "\n", "qMax"}]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
       RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
       " ", "-", " ", 
       RowBox[{
       "max", " ", "number", " ", "of", " ", "discretized", " ", 
        "points"}]}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"{", "ratio", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"ratio", "=", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{
        "n02", ",", "taud2", ",", "w", ",", "b", ",", "nTh", ",", "tTh", ",", 
         "qMax", ",", "jMax"}], "]"}], "/", 
       RowBox[{"z", "[", 
        RowBox[{
        "n01", ",", "taud1", ",", "w", ",", "b", ",", "nTh", ",", "tTh", ",", 
         "qMax", ",", "jMax"}], "]"}]}]}], ";", "\n", 
     RowBox[{"p1", " ", "/", 
      RowBox[{"(", 
       RowBox[{"p1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "p1"}], ")"}], " ", "ratio"}]}], ")"}]}]}]}], 
   "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.91045505614855*^9, 3.910455114425326*^9}, {
   3.910455156766118*^9, 3.91045540391238*^9}, 3.91045549180828*^9, {
   3.910455537280086*^9, 3.91045553826406*^9}, {3.910455587081437*^9, 
   3.910455617615971*^9}, {3.925019255795481*^9, 3.9250193006352177`*^9}, {
   3.9250193379121094`*^9, 3.925019344179907*^9}, {3.925019432742969*^9, 
   3.925019433492611*^9}, {3.925019470396505*^9, 3.9250195246371593`*^9}, {
   3.9250195552477036`*^9, 3.9250196914110985`*^9}, {3.9250197386698647`*^9, 
   3.925019777924139*^9}, {3.925019845155117*^9, 3.925020184066408*^9}, {
   3.925020215708589*^9, 3.925020262740595*^9}, {3.9250218594697304`*^9, 
   3.925021882137429*^9}, {3.925106102711199*^9, 3.925106106623104*^9}, {
   3.925106193866934*^9, 3.925106203329775*^9}, 3.928481712932972*^9, {
   3.9414579345456476`*^9, 3.9414579565682507`*^9}, {3.941545872949438*^9, 
   3.9415460300258446`*^9}, 3.9415460763310127`*^9, {3.941546145268341*^9, 
   3.9415461457543583`*^9}},ExpressionUUID->"8c4f7871-6e69-c146-b7be-\
3be9b6ba2852"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["p1Corr",
  FontWeight->"Bold"],
 "[pb1_, {n01_, n02_}, {taud1_, taud2_}, w_,b_, nTh_, tTh_, qMax_, jMax_]-- \
corrected burst fraction"
}], "Subtitle",
 CellChangeTimes->{{3.910455415147385*^9, 3.910455485974248*^9}, {
  3.924959754831957*^9, 3.924959760159916*^9}, {3.925021338419367*^9, 
  3.925021339439005*^9}, {3.925036319374758*^9, 3.925036324099235*^9}, {
  3.941219679767679*^9, 3.941219683534748*^9}, {3.94145792663295*^9, 
  3.9414579289130745`*^9}},
 FontSize->14,ExpressionUUID->"64e877a2-6b50-484b-b836-4546aaf3c690"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p1Corr", "[", 
    RowBox[{"pb1_", ",", 
     RowBox[{"{", 
      RowBox[{"n01_", ",", "n02_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"taud1_", ",", "taud2_"}], "}"}], ",", "w_", ",", "b_", ",", 
     "nTh_", ",", "tTh_", ",", "qMax_", ",", "jMax_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"May", " ", "17"}], ",", " ", 
      RowBox[{"2024", ";", " ", "\n", "\n", 
       RowBox[{
        RowBox[{"burst", " ", "fraction", " ", 
         SubscriptBox[
          SuperscriptBox["p", "b"], "1"], " ", "for", " ", "species", " ", 
         "1", " ", "in", " ", "system", " ", "with", " ", "two", " ", "non"}],
         "-", 
        RowBox[{
        "interconverting", " ", "species", "\n", " ", "diffusing", " ", 
         "molecules", " ", "with", " ", "two", " ", "non"}], "-", 
        RowBox[{"interconverting", " ", "states", "\n", "  ", "\n", "pb1"}], 
        " ", "-", " ", 
        RowBox[{
        "burst", " ", "fraction", " ", "of", " ", "the", " ", "first", " ", 
         "species"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "also", " ", "equal", " ", "to", " ", "the", " ", "population", " ", 
         "in", " ", "colorML", "\n", 
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}]}], " ", "-", " ", 
        RowBox[{
        "count", " ", "rates", " ", "at", " ", "the", " ", "center", " ", 
         "of", " ", "the", " ", "spot", "\n", 
         RowBox[{"{", 
          RowBox[{"taud1", ",", "taud2"}], "}"}]}], " ", "-", " ", 
        RowBox[{"diffusion", " ", "times", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["a", "xy"], "2"], "/", 
          SubscriptBox["D", 
           RowBox[{"1", " "}]]}], "and", " ", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["a", "xy"], "2"], "/", 
          SubscriptBox["D", 
           RowBox[{"2", " "}]]}], "\n", "w"}], " ", "-", " ", 
        RowBox[{"axial", " ", "ratio", " ", 
         RowBox[{
          SubscriptBox["a", "z"], "/", 
          SubscriptBox["a", "xy"]}], "\n", "b"}]}], "=", 
       RowBox[{"bA", "+", "bD", " ", "-", " ", 
        RowBox[{
        "total", " ", "acceptor", " ", "and", " ", "donor", " ", "background",
          " ", "count", " ", "rate", "\n", "nTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
         "photons", " ", "in", " ", "a", " ", "burst"}]}]}], ",", " ", 
      RowBox[{"N", ">=", 
       RowBox[{
        RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
      "  ", 
      RowBox[{
       RowBox[{"\[Tau]", "<", 
        RowBox[{"tTh", "\n", "qMax"}]}], "=", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "max"], "/", "a"}], " ", "-", " ", 
        RowBox[{"max", " ", "dimensionless", " ", "radius", "\n", "jMax"}], 
        " ", "-", " ", 
        RowBox[{
        "max", " ", "number", " ", "of", " ", "discretized", " ", 
         "points"}]}]}]}], "\n", "*)"}], "\n", 
    RowBox[{
     RowBox[{"{", "ratio", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"ratio", "=", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{
         "n02", ",", "taud2", ",", "w", ",", "b", ",", "nTh", ",", "tTh", ",",
           "qMax", ",", "jMax"}], "]"}], "/", 
        RowBox[{"z", "[", 
         RowBox[{
         "n01", ",", "taud1", ",", "w", ",", "b", ",", "nTh", ",", "tTh", ",",
           "qMax", ",", "jMax"}], "]"}]}]}], ";", "\n", 
      RowBox[{"pb1", " ", "/", 
       RowBox[{"(", 
        RowBox[{"pb1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "pb1"}], ")"}], "/", "ratio"}]}], ")"}]}]}]}], 
    "\n", "]"}]}], "\n"}]], "Code",
 CellChangeTimes->{{3.91045505614855*^9, 3.910455114425326*^9}, {
   3.910455156766118*^9, 3.91045540391238*^9}, 3.91045549180828*^9, {
   3.910455537280086*^9, 3.91045553826406*^9}, {3.910455587081437*^9, 
   3.910455617615971*^9}, {3.925021710911354*^9, 3.9250218276712494`*^9}, {
   3.925021889806526*^9, 3.925021975319996*^9}, {3.925106248944063*^9, 
   3.925106257917416*^9}, 3.925106787390723*^9, {3.94145797342329*^9, 
   3.941457992729311*^9}, {3.941546255689392*^9, 3.94154631751832*^9}, {
   3.9415463668260193`*^9, 
   3.9415463673435364`*^9}},ExpressionUUID->"eda5650a-2049-8e46-b991-\
1e067a5909c4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Photon Burst Simulation", "Section",
 CellChangeTimes->{{3.90878652974298*^9, 3.908786535601168*^9}, {
  3.908786882106604*^9, 3.908786886153018*^9}, {3.908786990639246*^9, 
  3.908786995320179*^9}, {3.9412202713665047`*^9, 
  3.941220302247425*^9}},ExpressionUUID->"0921c886-fd89-c948-bb6c-\
b581d7410680"],

Cell[TextData[{
 "Input model parameters:  \n",
 StyleBox["n0List",
  FontSlant->"Italic"],
 "={n01,n02} - total (donor and acceptor) photon count rate in the center of \
the laser spot, \n",
 StyleBox["dList",
  FontSlant->"Italic"],
 "={D1,D2} - diffusion coefficients of the two states, \n",
 StyleBox["kList",
  FontSlant->"Italic"],
 "={k1,k2} - transition rates 1->2 and 2->2, \n",
 StyleBox["eList",
  FontSlant->"Italic"],
 "={e1,e2} - FRET efficiencies,\n",
 StyleBox["axy",
  FontSlant->"Italic"],
 " and ",
 StyleBox["az",
  FontSlant->"Italic"],
 " - lateral and axial laser spot sizes, \n",
 StyleBox["bA",
  FontSlant->"Italic"],
 " and ",
 StyleBox["bD",
  FontSlant->"Italic"],
 " - background count rates, \n",
 StyleBox["nTh",
  FontSlant->"Italic"],
 " - threshold number of photons, \n",
 StyleBox["tTh",
  FontSlant->"Italic"],
 " - threshold time."
}], "Text",
 CellChangeTimes->{{3.924956148433134*^9, 3.9249561766411743`*^9}, {
   3.924959164597851*^9, 3.924959174259962*^9}, 3.9250222431085224`*^9, {
   3.927966783247219*^9, 3.927966785271158*^9}, {3.927987493076542*^9, 
   3.9279874981092014`*^9}, {3.930223993860391*^9, 3.930223998968836*^9}, 
   3.9303073742052345`*^9, 3.9303899493667583`*^9, {3.930551479159078*^9, 
   3.930551479254263*^9}, 3.941216889099893*^9, {3.9412169535056744`*^9, 
   3.9412169651838846`*^9}, {3.941217171109112*^9, 3.941217306094869*^9}, {
   3.941217342022753*^9, 3.9412173857594376`*^9}, {3.941217959157961*^9, 
   3.941218293518112*^9}, {3.9412184460314236`*^9, 3.941218475495689*^9}, {
   3.9412185132558513`*^9, 3.941218617240122*^9}, {3.941218652263172*^9, 
   3.941218663784281*^9}, {3.941219421110742*^9, 3.941219440382439*^9}, {
   3.941278185293604*^9, 3.941278233040186*^9}, {3.941279791718441*^9, 
   3.941280026378235*^9}, {3.941280348881167*^9, 3.941280357450285*^9}, {
   3.941281002323265*^9, 3.9412810329757214`*^9}, {3.9412820631534767`*^9, 
   3.941282083184694*^9}, {3.941282145039734*^9, 3.941282539280567*^9}, 
   3.941282954409944*^9, {3.941283679185335*^9, 3.941283681075003*^9}, {
   3.9412837341140175`*^9, 
   3.9412837345641575`*^9}},ExpressionUUID->"ddd42176-6444-af4e-b005-\
b49be642680d"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["photonTrajDyn2st",
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[time_,n0List_,dList_,kList_,axy_,az_,r0_,qOut_,timeStep_]--\
generates a list of photon arrival times and corresponding  molecule\
\[CloseCurlyQuote]s states. The  molecule  starts from r0={x0,y0,z0}  and \
diffuses for ",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["time",
  FontSize->14,
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox["  (with time increment ",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["timeStep",
  FontSize->14,
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox[")  in a  region with reflecting boundary at  dimensionless \
coordinate ",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox["qOut",
  FontSize->14,
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox["=rOut/axy=zOut/az.",
  FontSize->14,
  FontColor->GrayLevel[0]],
 StyleBox[" ",
  FontColor->GrayLevel[0]]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8358799703074374`*^9, 3.83588001889894*^9}, {
   3.838988659803615*^9, 3.8389886601439924`*^9}, 3.856972490529789*^9, {
   3.85704390010357*^9, 3.8570439073404603`*^9}, {3.857044179161391*^9, 
   3.857044189751581*^9}, {3.857469265029519*^9, 3.8574692798703847`*^9}, {
   3.857661529640655*^9, 3.857661529961195*^9}, {3.872697998692715*^9, 
   3.872698042439066*^9}, 3.872706420462074*^9, {3.884346259867925*^9, 
   3.884346260338133*^9}, 3.884346352086578*^9, {3.891598893390768*^9, 
   3.891599140296831*^9}, {3.8915994475047865`*^9, 3.891599455931495*^9}, {
   3.891599525199625*^9, 3.891599638239925*^9}, 3.891599670731134*^9, {
   3.891600601341807*^9, 3.891600690108411*^9}, {3.891600752781344*^9, 
   3.8916007789343405`*^9}, {3.8916766096514173`*^9, 3.89167661226425*^9}, {
   3.8920542455334435`*^9, 3.892054247288871*^9}, {3.892054395088888*^9, 
   3.892054399496934*^9}, {3.892544795567833*^9, 3.892544880673948*^9}, {
   3.90837891488593*^9, 3.9083789305771275`*^9}, {3.9086256372452*^9, 
   3.908625702086988*^9}, {3.908643511210524*^9, 3.908643521834687*^9}, {
   3.908643605385336*^9, 3.908643606178753*^9}, {3.908643697995427*^9, 
   3.9086437002181787`*^9}, {3.908644043376566*^9, 3.908644044767777*^9}, {
   3.9089834296513996`*^9, 3.908983430214758*^9}, {3.927967038958044*^9, 
   3.927967040269768*^9}, 3.9412821152727833`*^9, {3.9412825563670235`*^9, 
   3.941282610492899*^9}, {3.941282641639925*^9, 3.941282706171791*^9}, {
   3.941283043322239*^9, 3.941283065201971*^9}, 3.9412831181777973`*^9, {
   3.9412832137792397`*^9, 3.941283319815222*^9}, {3.9412833961223793`*^9, 
   3.9412834167539387`*^9}},ExpressionUUID->"82c9e417-e68e-7440-93b3-\
d96517972f2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"photonTrajDyn2st", "[", 
   RowBox[{
   "time_", ",", "n0List_", ",", "dList_", ",", "kList_", ",", "axy_", ",", 
    "az_", ",", "r0_", ",", "qOut_", ",", "timeStep_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"June", " ", "20"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "2024", "\n", "generate", " ", "a", " ", "list", " ", "of", " ", 
        "photon", " ", "arrival", " ", "times", " ", "and", " ", "states", 
        "\n", "diffusing", " ", "molecule", " ", "undergoing", " ", "2"}], 
       "-", 
       RowBox[{"state", " ", "transitions"}]}], ";", " ", 
      RowBox[{
       RowBox[{"Gaussian", " ", "laser", " ", "spot", "\n", "\n", 
        RowBox[{"return", ":", " ", 
         RowBox[{
          RowBox[{"list", " ", "of", " ", 
           RowBox[{"{", 
            RowBox[{"ti", ",", "iState"}], "}"}], " ", "photon", " ", 
           "arrival", " ", "times", " ", "and", " ", "molecular", " ", 
           "states", "\n", "\n", "time"}], " ", "-", " ", 
          RowBox[{
          "photon", " ", "trajectory", " ", "duration", "\n", 
           "n0List"}]}]}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], " ", "-", " ", 
         RowBox[{
         "list", " ", "of", " ", "photon", " ", "count", " ", "rate", "\n", 
          "dList"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d1", ",", "d2"}], "}"}], " ", "-", " ", 
          RowBox[{
          "list", " ", "of", " ", "diffusion", " ", "coefficients", "\n", 
           "kList"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], " ", "-", " ", 
           RowBox[{
           "list", " ", "of", " ", "transition", " ", "rate", " ", 
            "constants", " ", "1"}]}], "->", 
          RowBox[{
           RowBox[{"2", " ", "and", " ", "2"}], "->", 
           RowBox[{"1", "\n", "axy"}]}]}]}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"az", " ", "-", " ", 
       RowBox[{
       "lateral", " ", "and", " ", "axial", " ", "laser", " ", "spot", " ", 
        "size", "\n", "r0"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}], " ", "-", " ", 
        RowBox[{"initial", " ", "coordinate", "\n", "qOut"}], " ", "-", "  ", 
        RowBox[{
        "ellipsoid", " ", "boundary", " ", "condition", " ", "at", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}], ")"}], "/", 
          SuperscriptBox[
           SubscriptBox["a", "xy"], "2"]}]}], "+", 
        RowBox[{
         SuperscriptBox["z", "2"], "/", 
         SuperscriptBox[
          SubscriptBox["a", "z"], "2"]}]}], "=", 
       RowBox[{
        RowBox[{
         SuperscriptBox["qOut", "2"], "\[IndentingNewLine]", "timeStep"}], 
        " ", "-", " ", 
        RowBox[{"time", " ", "step"}]}]}]}]}], "\n", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "normDistList", ",", "p1", ",", "k1", ",", "k2", ",", "axyz2Recip", ",", 
      "iState", ",", "transitionTime", ",", "coordinate", ",", "itime", ",", 
      "arrivalList", ",", "arrival", ",", "probPh", ",", "photon", ",", 
      "newCoor"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"list", " ", "of", " ", "1"}], "-", 
      RowBox[{"dimensional", " ", "Normal", " ", "distribution"}]}], " ", 
     "*)"}], "\n", 
    RowBox[{
     RowBox[{"normDistList", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", " ", "#", " ", "timeStep"}], "]"}]}], "]"}], "&"}], 
        ",", "dList"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"equilibrium", " ", "population"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "=", "kList"}], ";", "\n", 
     RowBox[{"p1", "=", 
      RowBox[{"k2", "/", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}]}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"list", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"axy", "^", "2"}]}], ",", 
         RowBox[{"1", "/", 
          RowBox[{"axy", "^", "2"}]}], ",", 
         RowBox[{"1", "/", 
          RowBox[{"az", "^", "2"}]}]}], "}"}]}], " ", "*)"}], "\n", 
     RowBox[{"axyz2Recip", "=", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"axy", ",", "axy", ",", "az"}], "}"}], "^", "2"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "initialization", "*)"}], "\n", 
     RowBox[{"coordinate", "=", "r0"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"arrivalList", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"iState", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", 
          RowBox[{"1", "-", "p1"}]}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"transitionTime", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"ExponentialDistribution", "[", 
        RowBox[{"kList", "[", 
         RowBox[{"[", "iState", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "  ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"new", " ", "coordinate"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"newCoor", "=", 
         RowBox[{"coordinate", "+", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{
            RowBox[{"normDistList", "[", 
             RowBox[{"[", "iState", "]"}], "]"}], ",", "3"}], "]"}]}]}], ";", 
        "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sept", " ", "21"}], "-", 
            RowBox[{"2022", " ", "if", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "^", "2"}], "/", 
                RowBox[{"axy", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"y", "^", "2"}], "/", 
                RowBox[{"axy", "^", "2"}]}], "+", 
               RowBox[{
                RowBox[{"z", "^", "2"}], "/", 
                RowBox[{"az", "^", "2"}]}]}], ")"}]}]}], " ", "<", 
           SuperscriptBox["qOut", "2"]}], ",", " ", 
          RowBox[{
          "then", " ", "renewed", " ", "coordinate", " ", "accepted"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"newCoor", "^", "2"}], ")"}], ".", "axyz2Recip"}], "<", 
           RowBox[{"qOut", "^", "2"}]}], ",", 
          RowBox[{"coordinate", "=", "newCoor"}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"new", " ", "state"}], " ", "*)"}], "\n", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"itime", ">", "transitionTime"}], ",", "\n", 
          RowBox[{
           RowBox[{"iState", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], ",", 
               RowBox[{
                RowBox[{"#", "!=", "iState"}], "&"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{"update", " ", "state"}], "*)"}], "\n", 
           RowBox[{"transitionTime", "=", 
            RowBox[{"transitionTime", "+", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"ExponentialDistribution", "[", 
               RowBox[{"kList", "[", 
                RowBox[{"[", "iState", "]"}], "]"}], "]"}], "]"}]}]}]}]}], 
         RowBox[{"(*", 
          RowBox[{"update", " ", "transitionTime"}], "*)"}], "\n", "]"}], ";",
         "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "probability", " ", "to", " ", "detect", " ", "a", " ", "photon"}], 
         " ", "*)"}], "\n", 
        RowBox[{"probPh", "=", 
         RowBox[{
          RowBox[{"n0List", "[", 
           RowBox[{"[", "iState", "]"}], "]"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"coordinate", "^", "2"}], ")"}], ".", "axyz2Recip"}]}], 
           "]"}], " ", "timeStep"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"photon", "=", 
          RowBox[{"0", " ", 
           RowBox[{"(", 
            RowBox[{"no", " ", "photon"}], ")"}], " ", "or", " ", "1", " ", 
           RowBox[{"(", "photon", ")"}]}]}], "*)"}], "\n", 
        RowBox[{"photon", "=", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", "probPh"}], ",", "probPh"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", " ", "\n", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"photon", "==", "1"}], ",", "  ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"arrivalList", ",", 
            RowBox[{"{", 
             RowBox[{"itime", ",", "iState"}], "}"}]}], "]"}]}], "]"}]}], ",",
        "\n", "\n", 
       RowBox[{"{", 
        RowBox[{"itime", ",", "0", ",", "time", ",", "timeStep"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "arrivalList"}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.832943111057689*^9, 3.832943370824018*^9}, {
   3.832943418556206*^9, 3.832943449134824*^9}, {3.832946378976969*^9, 
   3.832946409421643*^9}, {3.832946449061434*^9, 3.832946484318125*^9}, {
   3.832946525783768*^9, 3.832946578815704*^9}, {3.832946610700377*^9, 
   3.832946634225037*^9}, {3.832946673640986*^9, 3.832946708981002*^9}, {
   3.8329467457667637`*^9, 3.832946784590041*^9}, {3.832946838383672*^9, 
   3.832946856495561*^9}, {3.832946963856405*^9, 3.832947022191239*^9}, {
   3.832947154004489*^9, 3.832947156489314*^9}, {3.8329472140142*^9, 
   3.8329472240623064`*^9}, {3.8329472875114326`*^9, 3.832947290340822*^9}, {
   3.832947326590331*^9, 3.832947349511759*^9}, {3.832947525822677*^9, 
   3.832947528574332*^9}, {3.832947611888514*^9, 3.832947629986614*^9}, {
   3.832948150231212*^9, 3.832948180976554*^9}, {3.832948289962485*^9, 
   3.832948665267894*^9}, 3.83294887477767*^9, {3.832949500505222*^9, 
   3.8329495115263968`*^9}, {3.832949556841669*^9, 3.832949571983164*^9}, {
   3.832949692364217*^9, 3.8329497074143753`*^9}, {3.8329497455295997`*^9, 
   3.8329497676083994`*^9}, {3.832949839677252*^9, 3.832949863262901*^9}, {
   3.83294990385202*^9, 3.832949935842686*^9}, {3.832949985450743*^9, 
   3.83294999613369*^9}, {3.8329502021078568`*^9, 3.832950206922307*^9}, {
   3.832950310046441*^9, 3.832950313769413*^9}, {3.832950491896601*^9, 
   3.832950497524335*^9}, {3.832950557508899*^9, 3.832950613704788*^9}, {
   3.833110160063466*^9, 3.833110559959506*^9}, {3.8331106070541487`*^9, 
   3.833110666537569*^9}, {3.8331109382831345`*^9, 3.833110943641344*^9}, {
   3.833111249374897*^9, 3.833111265145691*^9}, {3.8331113102661405`*^9, 
   3.833111337861108*^9}, {3.833111654613776*^9, 3.833111701765064*^9}, {
   3.833111732099039*^9, 3.833111777668176*^9}, {3.833383036928882*^9, 
   3.83338312048294*^9}, {3.833454303166479*^9, 3.8334544728023844`*^9}, {
   3.833454503578222*^9, 3.833454552041314*^9}, 3.833454870365365*^9, {
   3.833623078511217*^9, 3.83362308170953*^9}, {3.8345095875973096`*^9, 
   3.83450958889388*^9}, {3.83587919059439*^9, 3.83587922568568*^9}, {
   3.85084543583343*^9, 3.850845492510012*^9}, {3.850845727161249*^9, 
   3.850845736076522*^9}, {3.85084578074659*^9, 3.8508458114503174`*^9}, {
   3.85090618850904*^9, 3.8509063091714334`*^9}, {3.850906590915844*^9, 
   3.850906607719504*^9}, {3.856971578525493*^9, 3.85697162778039*^9}, {
   3.856971683211468*^9, 3.856971699065524*^9}, {3.856971772751299*^9, 
   3.8569718709084873`*^9}, {3.856972666943238*^9, 3.856972688848673*^9}, {
   3.872697447616336*^9, 3.87269747833705*^9}, {3.872697626165511*^9, 
   3.872697725678377*^9}, {3.872776079375575*^9, 3.872776094575757*^9}, {
   3.872776287203727*^9, 3.872776344565948*^9}, {3.872776427192614*^9, 
   3.872776550927575*^9}, 3.884346352087576*^9, {3.891598344542883*^9, 
   3.891598350426812*^9}, 3.891598445795773*^9, {3.891598477221357*^9, 
   3.891598489474663*^9}, {3.8915986802103987`*^9, 3.891598830325287*^9}, {
   3.891599309576065*^9, 3.891599314636976*^9}, {3.891599875074095*^9, 
   3.891599894983288*^9}, {3.8916773104329376`*^9, 3.891677342998407*^9}, {
   3.8925455992997*^9, 3.892545886179325*^9}, {3.9083795209617634`*^9, 
   3.908379608686935*^9}, {3.908379654815509*^9, 3.908379663166814*^9}, {
   3.908379698930775*^9, 3.9083798056091146`*^9}, {3.908379861802155*^9, 
   3.908379865250166*^9}, {3.9083799157367826`*^9, 3.9083800043010626`*^9}, {
   3.9083800762821*^9, 3.908380116826196*^9}, {3.9083804062762995`*^9, 
   3.908380406476314*^9}, {3.9083804891488667`*^9, 3.908380512491156*^9}, {
   3.9083805637345657`*^9, 3.9083805801647096`*^9}, {3.908380614492689*^9, 
   3.908380648421334*^9}, {3.908380682092914*^9, 3.9083807118287005`*^9}, {
   3.908401033615929*^9, 3.90840111383541*^9}, {3.9086088538061523`*^9, 
   3.908608853914281*^9}, {3.908608943980795*^9, 3.908609087795637*^9}, {
   3.908609126390738*^9, 3.908609134867742*^9}, {3.908609185995946*^9, 
   3.9086092865307174`*^9}, {3.9086093610212784`*^9, 3.908609453123374*^9}, {
   3.908624665026581*^9, 3.908624897514085*^9}, {3.908624933866209*^9, 
   3.908624934330098*^9}, {3.908625171474867*^9, 3.908625201471525*^9}, {
   3.9086434229122133`*^9, 3.90864342425884*^9}, {3.9086434562735224`*^9, 
   3.908643457304028*^9}, {3.90864369183351*^9, 3.908643725946734*^9}, {
   3.9086438586058207`*^9, 3.908643880687955*^9}, {3.908643930937879*^9, 
   3.908643944017774*^9}, {3.9086440505016804`*^9, 3.908644056143715*^9}, {
   3.908983437523605*^9, 3.908983438074468*^9}, {3.91993216420552*^9, 
   3.919932168048523*^9}, {3.91993237881971*^9, 3.919932418655809*^9}, {
   3.9279671073670692`*^9, 3.927967116949728*^9}, {3.927971440683941*^9, 
   3.9279714631856613`*^9}, {3.9415465425869865`*^9, 
   3.9415466530300636`*^9}, {3.9415466950954227`*^9, 
   3.941546726180521*^9}},ExpressionUUID->"4f772abb-991f-7e40-bc6e-\
a61cf284f2bb"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["addColorDyn",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[photonStateTraj_,eList_]-- adds color labels according to FRET \
efficiencies ",
  FontColor->GrayLevel[0]],
 StyleBox["eList",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox["={e1,e2}  to the list of arrival times and states ",
  FontColor->GrayLevel[0]],
 StyleBox["photonStateTraj",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 " "
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020465615723*^9}, {3.9030227112841434`*^9, 3.9030227138038273`*^9}, {
   3.903173320736844*^9, 3.903173320926035*^9}, {3.908644001741567*^9, 
   3.908644018921917*^9}, {3.9086442091345124`*^9, 3.908644209315851*^9}, {
   3.9086449982674255`*^9, 3.9086449989706745`*^9}, {3.908645077818916*^9, 
   3.908645093897639*^9}, {3.908787480482394*^9, 3.908787483542597*^9}, 
   3.9279674540554276`*^9, {3.927967817439644*^9, 3.9279678194465885`*^9}, {
   3.9279711890617085`*^9, 3.9279712140477757`*^9}, {3.9412827580169067`*^9, 
   3.941282817834711*^9}, {3.941282850578478*^9, 3.9412828549629536`*^9}, 
   3.9412834225926743`*^9},
 FontSize->14,ExpressionUUID->"a9a52028-7752-9e4c-8ffc-58616cd8f996"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addColorDyn", "[", 
   RowBox[{"photonArrival_", ",", "eList_"}], "]"}], ":=", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"add", " ", "color", " ", "to", " ", "the", 
     StyleBox[
      RowBox[{" ", 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]]}]], 
     StyleBox["list",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["of",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["arrival",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["times",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["and",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["states",
      FontColor->RGBColor[1, 0, 1]]}], ";", "\n", "\n", 
    RowBox[{
     RowBox[{"return", ":", " ", 
      RowBox[{
      "list", " ", "of", " ", "arrival", " ", "times", " ", "ti", " ", "and", 
       "  ", "colors", " ", "ci"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", ",", "d"}], ")"}], ":", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t1", ",", "c1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "c2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t3", ",", "c3"}], "}"}], ",", "..."}], "}"}], "\n", "\n",
          "photonArrival"}], " ", "-", " ", 
        RowBox[{
        "list", " ", "of", " ", "arrival", " ", "times", " ", "and", " ", 
         "states", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t1", ",", "s1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "s2"}], "}"}], ",", "..."}], "}"}], "\n", 
         "eList"}]}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}], " ", "-", " ", 
       RowBox[{
       "list", " ", "of", " ", "apparent", " ", "FRET", " ", "efficiencies", 
        " ", "without", " ", "BN"}]}]}]}]}], "\n", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "photons1", ",", "photons2", ",", "nPh1", ",", "nPh2", ",", "e1", ",", 
      "e2", ",", "colors1", ",", "colors2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\n", 
    RowBox[{"(*", "  ", 
     RowBox[{
     "photons", " ", "in", " ", "state", " ", "1", " ", "and", " ", "2"}], 
     "*)"}], "\n", 
    RowBox[{
     RowBox[{"photons1", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"photonArrival", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "==", "1"}], "&"}]}], "]"}]}], ";",
      "\n", 
     RowBox[{"photons2", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"photonArrival", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "==", "2"}], "&"}]}], "]"}]}], ";",
      "\n", "\n", 
     RowBox[{"(*", "  ", 
      RowBox[{
      "number", " ", "of", " ", "photons", " ", "in", " ", "state", " ", "1", 
       " ", "and", " ", "2"}], "*)"}], "\n", 
     RowBox[{"nPh1", "=", 
      RowBox[{"Length", "[", "photons1", "]"}]}], ";", "\n", 
     RowBox[{"nPh2", "=", 
      RowBox[{"Length", "[", "photons2", "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}], "=", "eList"}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "photon", " ", "colors"}], " ", "*)"}], "\n", 
     RowBox[{"colors1", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e1", ",", 
           RowBox[{"1", "-", "e1"}]}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"\"\<a\>\"", ",", "\"\<d\>\""}], "}"}]}], ",", "nPh1"}], 
       "]"}]}], ";", "\n", 
     RowBox[{"colors2", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e2", ",", 
           RowBox[{"1", "-", "e2"}]}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"\"\<a\>\"", ",", "\"\<d\>\""}], "}"}]}], ",", "nPh2"}], 
       "]"}]}], ";", "\n", "\n", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"photons1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "colors1"}], "}"}], 
        "\[Transpose]"}], ",", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"photons2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "colors2"}], "}"}], 
        "\[Transpose]"}]}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{"returns", " ", "sorted", " ", "list", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"ti", ",", "ci"}], "}"}]}], "*)"}], "\[IndentingNewLine]", "\n",
    "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.596302874277189*^9, 3.5963029629127088`*^9}, {
   3.596303185821743*^9, 3.596303189102804*^9}, {3.596306748821638*^9, 
   3.59630707040995*^9}, {3.5963071055119095`*^9, 3.5963072481848955`*^9}, {
   3.5963073530221243`*^9, 3.596307355334136*^9}, {3.5963075955802603`*^9, 
   3.596307600797909*^9}, {3.596308966712491*^9, 3.596309018951456*^9}, {
   3.596309091779821*^9, 3.596309098512774*^9}, {3.780324913791532*^9, 
   3.78032493107476*^9}, {3.780325467094615*^9, 3.780325467990833*^9}, {
   3.780325525747509*^9, 3.780325543360842*^9}, 3.780325756055325*^9, {
   3.780325802789912*^9, 3.780325804514608*^9}, {3.857648965180871*^9, 
   3.8576490587350483`*^9}, {3.857649097618759*^9, 3.8576491024454203`*^9}, {
   3.857649157148554*^9, 3.8576492415608273`*^9}, {3.857649277612503*^9, 
   3.8576492843573284`*^9}, {3.857649428711811*^9, 3.8576495049144163`*^9}, {
   3.857649603831258*^9, 3.857649615599821*^9}, 3.857653616664822*^9, {
   3.857654762379578*^9, 3.857654778051904*^9}, {3.857655094360427*^9, 
   3.857655104409032*^9}, 3.884346352087576*^9, {3.8915994021693335`*^9, 
   3.891599416490585*^9}, {3.891599920622949*^9, 3.891599929478813*^9}, 
   3.8915999896066337`*^9, {3.891600099410579*^9, 3.891600107371478*^9}, {
   3.891600718533284*^9, 3.891600730268549*^9}, {3.891600824798996*^9, 
   3.891600850332402*^9}, {3.892545912551134*^9, 3.892546083130006*^9}, {
   3.892546144359939*^9, 3.892546164685378*^9}, {3.902942326216397*^9, 
   3.902942458150954*^9}, {3.902942871398108*^9, 3.90294288050583*^9}, {
   3.902942913804041*^9, 3.9029431038906727`*^9}, {3.903173326414626*^9, 
   3.903173326619096*^9}, {3.908644028421119*^9, 3.908644036298915*^9}, {
   3.9086440693711433`*^9, 3.908644148876734*^9}, {3.90864420516328*^9, 
   3.908644272949356*^9}, {3.908644397073259*^9, 3.9086445197430563`*^9}, {
   3.9086445592325954`*^9, 3.90864462878957*^9}, {3.9086446619395313`*^9, 
   3.908644755953014*^9}, {3.908644818920979*^9, 3.9086448532878585`*^9}, {
   3.908645020316522*^9, 3.908645069114132*^9}, 3.9086451045739*^9, {
   3.927971097055874*^9, 3.92797109879912*^9}, {3.927971204479693*^9, 
   3.927971206009388*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"fe817b36-824e-af4f-a60a-d13c2b898e80"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["addBN",
  FontWeight->"Bold"],
 "[photonTraj_, bA_, bD_] --  adds background noise  with count rates ",
 StyleBox["bA",
  FontSlant->"Italic"],
 " and ",
 StyleBox["bD",
  FontSlant->"Italic"],
 " to the photon trajectory ",
 StyleBox["photonTraj",
  FontSlant->"Italic"],
 " (a list of photon  arrival times and colors {ti,ci})"
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, 3.903022001367322*^9, {3.903022718261641*^9, 
   3.9030227221053686`*^9}, 3.908643348614055*^9, {3.924957348346865*^9, 
   3.924957355248804*^9}, {3.924957805592694*^9, 3.92495780777874*^9}, {
   3.924957930425764*^9, 3.9249579354037323`*^9}, 3.927967008488598*^9, 
   3.9279676403196697`*^9, {3.941281833778631*^9, 3.941281919128042*^9}, {
   3.9412828717445946`*^9, 3.941282886931223*^9}},
 FontSize->14,
 FontColor->GrayLevel[
  0],ExpressionUUID->"39f8d9fb-24ee-1940-bfc7-b3eff7fbb7bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addBN", "[", 
   RowBox[{"traj_", ",", "bA_", ",", "bD_"}], "]"}], ":=", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"May", " ", "17"}], ",", " ", 
    RowBox[{
     RowBox[{
     "2024", "\n", "add", " ", "background", " ", "noise", " ", "to", " ", 
      "a", " ", "photon", " ", "trajectory", "\n", " ", "\n", 
      RowBox[{"return", ":", " ", 
       RowBox[{
       "list", " ", "of", " ", "arrival", " ", "times", " ", "ti", " ", "and",
         " ", "colors", " ", "ci"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", ",", "d"}], ")"}], ":", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t1", ",", "c1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t2", ",", "c2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t3", ",", "c3"}], "}"}], ",", "..."}], "}"}], "\n", " ", 
         "\n", "traj"}], " ", "-", "  ", 
        RowBox[{
        "list", " ", "of", " ", "arrival", " ", "times", " ", "ti", " ", 
         "and", "  ", "colors", " ", "ci"}]}]}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", ",", "d"}], ")"}], ":", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t1", ",", "c1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t2", ",", "c2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t3", ",", "c3"}], "}"}], ",", "..."}], "}"}], "\n", 
        "bA"}]}]}]}], ",", " ", 
    RowBox[{"bD", " ", "-", " ", 
     RowBox[{
     "acceptor", " ", "and", " ", "donor", " ", "photon", " ", "count", " ", 
      "rates"}]}]}], "\n", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "first", ",", "last", ",", "arrivalBNA", ",", "arrivalBND", ",", 
      "lengthA", ",", "lengthD", ",", "bnTrajA", ",", "bnTrajD"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"first", ",", "last"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "traj", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Last", "[", "traj", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "first", " ", "and", " ", "last", " ", "arrival", " ", "times", " ", 
       "of", " ", "\"\<traj\>\""}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
     RowBox[{"arrivalBNA", "=", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomFunction", "[", 
          RowBox[{
           RowBox[{"PoissonProcess", "[", "bA", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"first", ",", "last"}], "}"}]}], "]"}], "[", 
         "\"\<PathTimes\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"generate", " ", "Poisson", " ", "process"}], ",", " ", 
       RowBox[{
       "exclude", " ", "initial", " ", "and", " ", "final", " ", "times"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"arrivalBND", "=", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RandomFunction", "[", 
          RowBox[{
           RowBox[{"PoissonProcess", "[", "bD", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"first", ",", "last"}], "}"}]}], "]"}], "[", 
         "\"\<PathTimes\>\"", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lengthA", ",", "lengthD"}], "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"{", 
         RowBox[{"arrivalBNA", ",", "arrivalBND"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "numbers", " ", "of", " ", "acceptor", " ", "and", " ", "donor", " ", 
       "BN", " ", "photons"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bnTrajA", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrivalBNA", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<a\>\"", ",", 
           RowBox[{"{", "lengthA", "}"}]}], "]"}]}], "}"}], 
       "\[Transpose]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"acceptor", " ", "BN", " ", "photons"}], " ", "-", " ", 
       RowBox[{"list", " ", "of", "  ", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "a"}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bnTrajD", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arrivalBND", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<d\>\"", ",", 
           RowBox[{"{", "lengthD", "}"}]}], "]"}]}], "}"}], 
       "\[Transpose]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"donor", " ", "BN", " ", "photons"}], " ", "-", " ", 
       RowBox[{"list", " ", "of", "  ", 
        RowBox[{"{", 
         RowBox[{"ti", ",", "d"}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{"traj", ",", "bnTrajA", ",", "bnTrajD"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{
    "superimose", " ", "\"\<traj\>\"", " ", "with", " ", "background", " ", 
     "photons"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.596302874277189*^9, 3.5963029629127088`*^9}, {
  3.596303185821743*^9, 3.596303189102804*^9}, {3.596306748821638*^9, 
  3.59630707040995*^9}, {3.5963071055119095`*^9, 3.5963072481848955`*^9}, {
  3.5963073530221243`*^9, 3.596307355334136*^9}, {3.5963075955802603`*^9, 
  3.596307600797909*^9}, {3.596308966712491*^9, 3.596309018951456*^9}, {
  3.596309091779821*^9, 3.596309098512774*^9}, {3.903019201250158*^9, 
  3.903019258952593*^9}, {3.903020261400416*^9, 3.903020319780498*^9}, {
  3.924957437113298*^9, 3.92495746278742*^9}, {3.924957511657067*^9, 
  3.924957754544895*^9}, {3.9415467937436504`*^9, 
  3.941546878050663*^9}},ExpressionUUID->"e7348b14-4d4d-9f41-90d6-\
1d2bace8628c"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["selectBursts",
  FontWeight->"Bold",
  FontColor->GrayLevel[0]],
 StyleBox["[photonTraj_, nTh_,tTh_] --  selects bursts from  the list of \
photon arrival times and colors ",
  FontColor->GrayLevel[0]],
 StyleBox["photonTraj ",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox[" using threshold time ",
  FontColor->GrayLevel[0]],
 StyleBox["tTh",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox[" and applies the threshold for the number of photons in a burst, ",
  FontColor->GrayLevel[0]],
 StyleBox["nTh",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 StyleBox[". ",
  FontColor->GrayLevel[0]]
}], "Subtitle",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.647624074122567*^9, 3.647624074372175*^9}, {
   3.647624583438178*^9, 3.647624593047901*^9}, {3.647624632397608*^9, 
   3.647624632397608*^9}, 3.647625099537116*^9, {3.903020342161899*^9, 
   3.903020368072278*^9}, {3.903020591311149*^9, 3.903020594755336*^9}, {
   3.903021971446923*^9, 3.903022015716086*^9}, {3.9030227246208525`*^9, 
   3.903022732670697*^9}, {3.9249578730164986`*^9, 3.9249579518148994`*^9}, {
   3.924960185648033*^9, 3.9249602298566494`*^9}, 3.9279670094950695`*^9, 
   3.9279677217091885`*^9, {3.9412829251442127`*^9, 3.941282983947401*^9}, {
   3.941283579160343*^9, 3.9412836590409985`*^9}},
 FontSize->14,ExpressionUUID->"b1e59fdd-8127-ce4f-baeb-624ab8edf039"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"selectBursts", "[", 
    RowBox[{"traj_", ",", "nTh_", ",", "tTh_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"May", " ", "17"}], ",", " ", 
      RowBox[{
      "2024", "\n", "select", " ", "bursts", " ", "from", " ", "a", " ", 
       "photon", " ", "trajectory"}], ",", " ", 
      RowBox[{
       RowBox[{
       "apply", " ", "thresholds", " ", "and", " ", "set", " ", "time", " ", 
        "0", " ", "for", " ", "the", " ", "first", " ", "photon", " ", 
        "arrival", " ", "\n", "\n", 
        RowBox[{"return", ":", " ", 
         RowBox[{"list", " ", "of", " ", "bursts", " ", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2", ",", "..."}], "}"}]}]}]}], ";", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "each", " ", "burst", " ", "is", " ", "a", " ", "list", " ", "of", 
          " ", "arrival", " ", "times", " ", "and", " ", "colors", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "c1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t2", ",", "c2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t3", ",", "c3"}], "}"}], ",", "..."}], "}"}], "\n", 
          "\n", "traj"}], " ", "-", "  ", 
         RowBox[{
         "list", " ", "of", " ", "arrival", " ", "times", " ", "ti", " ", 
          "and", "  ", "colors", " ", "ci"}]}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", ",", "d"}], ")"}], ":", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t1", ",", "c1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"t2", ",", "c2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"t3", ",", "c3"}], "}"}], ",", "..."}], "}"}], "\n", 
           "nTh"}], " ", "-", " ", 
          RowBox[{
          "threshold", " ", "for", " ", "the", " ", "number", " ", "of", " ", 
           "photons", " ", "in", " ", "a", " ", "burst"}]}]}]}]}], ",", " ", 
      RowBox[{"N", ">=", 
       RowBox[{
        RowBox[{"nTh", "\n", "tTh"}], " ", "-", " ", 
        RowBox[{
        "threshold", " ", "for", " ", "interphoton", " ", "times"}]}]}], ",", 
      "  ", 
      RowBox[{"\[Tau]", "<", "tTh"}]}], "\n", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "bursts", "}"}], ",", "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"bursts", "=", 
       RowBox[{"Split", "[", 
        RowBox[{"traj", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "<", "tTh"}], "&"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "split", " ", "into", " ", "bursts", " ", "whith", " ", "interphoton",
          " ", "times"}], " ", "<", " ", "tTh"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"bursts", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"bursts", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">=", "nTh"}], "&"}]}], "]"}]}],
       ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"apply", " ", "threshold", " ", "N"}], ">=", "ntr"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], 
          "\[Transpose]"}], "&"}], ",", "bursts"}], "]"}]}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "shift", " ", "time", " ", "to", " ", "0", "  ", "for", " ", "the", " ", 
      "first", " ", "photon", " ", "in", " ", "a", " ", "burst"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], "\n"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8332778191811776`*^9, 3.8332778254028683`*^9}, {
   3.8332778883105745`*^9, 3.833278368731304*^9}, {3.833281187842584*^9, 
   3.8332812261803694`*^9}, {3.8332814571382723`*^9, 3.833281496881675*^9}, {
   3.8332815380180597`*^9, 3.83328157298557*^9}, 3.833447174947397*^9, {
   3.8334548543207664`*^9, 3.833454879925221*^9}, {3.833454913679335*^9, 
   3.833454919425334*^9}, {3.857464890043457*^9, 3.85746490279068*^9}, {
   3.857464948817471*^9, 3.857464974069079*^9}, {3.857465207391038*^9, 
   3.8574652357778583`*^9}, {3.857466018523642*^9, 3.857466028447499*^9}, {
   3.8576546207154427`*^9, 3.857654638859223*^9}, {3.858848269793737*^9, 
   3.858848304693332*^9}, {3.872760479843756*^9, 3.872760486851017*^9}, 
   3.884346352087576*^9, {3.8915985856113214`*^9, 3.8915985988662033`*^9}, {
   3.891599822048901*^9, 3.8915998239680667`*^9}, {3.891600002996854*^9, 
   3.891600075987588*^9}, 3.891600116580818*^9, {3.891600226446307*^9, 
   3.891600436786588*^9}, {3.891600487477529*^9, 3.8916005799965987`*^9}, 
   3.891600786834184*^9, 3.892545417370116*^9, {3.892546122904935*^9, 
   3.892546126551811*^9}, {3.892546224671059*^9, 3.892546318702721*^9}, {
   3.892546394085551*^9, 3.892546396689448*^9}, {3.892546579814422*^9, 
   3.892546595736592*^9}, {3.903020611328523*^9, 3.9030206153678784`*^9}, {
   3.903020649433816*^9, 3.903020748709636*^9}, {3.903020787120995*^9, 
   3.903020791132779*^9}, {3.903021017680918*^9, 3.903021022081983*^9}, {
   3.903021561472135*^9, 3.9030216095898657`*^9}, 3.903022119831641*^9, {
   3.903022260299351*^9, 3.903022271335296*^9}, {3.9249579649917603`*^9, 
   3.924957997849165*^9}, {3.924958037617071*^9, 3.924958054827395*^9}, {
   3.941546904897112*^9, 3.9415470279535427`*^9}, {3.9415470682740746`*^9, 
   3.9415470766587276`*^9}},ExpressionUUID->"03a2bd39-31af-9c4c-8c3d-\
edc96d87eca7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.9412176760986767`*^9, 
  3.941217681518175*^9}},ExpressionUUID->"4296c3ab-40ee-df40-94b8-\
68b2c89059a5"],

Cell[CellGroupData[{

Cell["Parameters (in  ms an \[Mu]m)", "Subsection",
 CellChangeTimes->{{3.891678189636395*^9, 
  3.891678229496559*^9}},ExpressionUUID->"6cf4be3e-485d-5744-a51d-\
1b47c0968c25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"axy", ":=", "0.5"}], 
  RowBox[{"(*", 
   RowBox[{"lateral", " ", "spot", " ", "size", " ", "0.5", " ", "\[Mu]m"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"az", ":=", "1.5"}], 
  RowBox[{"(*", 
   RowBox[{"axial", " ", "spot", " ", "size", " ", "1.5", " ", "\[Mu]m"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nTh", ":=", "30"}], 
  RowBox[{"(*", 
   RowBox[{"theshold", " ", "number", " ", "of", " ", "photons"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tTh", ":=", "0.2"}], 
  RowBox[{"(*", 
   RowBox[{"threshold", " ", "time", " ", "200", " ", "\[Mu]s"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qMax", ":=", "4."}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "max", " ", "dimensionless", " ", "discretized", " ", "coordinate", " ", 
    "q"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jMax", ":=", "50"}], 
  RowBox[{"(*", 
   RowBox[{
   "max", " ", "number", " ", "of", " ", "discret", " ", "points", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "discretized", " ", "coordinate"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jMax2", ":=", "20"}], 
  RowBox[{"(*", 
   RowBox[{
   "max", " ", "number", " ", "of", " ", "discret", " ", "points", " ", 
    RowBox[{"(", 
     RowBox[{"2", " ", "discretized", " ", "coordinates"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"qO", 
     StyleBox["ut",
      FontSize->14,
      FontColor->GrayLevel[0]]}]], 
   StyleBox[":=",
    FontSize->14,
    FontColor->GrayLevel[0]], 
   StyleBox["4.",
    FontSize->14,
    FontColor->GrayLevel[0]]}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "max", " ", "dimensionless", " ", "coordinate", " ", "in", " ", "photon", 
     " ", "trajectory", " ", "simulations"}], "*)"}],
   FontSize->14,
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"timeStep", ":=", "0.0001"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
    "time", " ", "step", " ", "in", " ", "photon", " ", "trajectory", " ", 
     "simulations", " ", "is", " ", "0.1", " ", "\[Mu]s"}], "*)"}]}],
  FontSize->14,
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"n01", ":=", "400."}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the", 
     " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"n02", ":=", "200."}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"d1", ":=", "0.1"}], 
   RowBox[{"(*", 
    RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"d2", ":=", "0.2"}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"e1", ":=", "0.3"}], 
   RowBox[{"(*", 
    RowBox[{"FRET", " ", "efficiencies"}], "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"e2", ":=", "0.7"}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bA", ":=", "2."}], 
  RowBox[{"(*", 
   RowBox[{"acceptor", " ", "BN", " ", "count", " ", "rate"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bD", ":=", "1."}], 
  RowBox[{"(*", 
   RowBox[{"donor", " ", "BN", " ", "count", " ", "rate"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", ":=", "1."}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"transition", " ", "rate", " ", "1"}], "->", "2"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"k2", ":=", "1.", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"transition", " ", "rate", " ", "2"}], "->", "1"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8916782650529823`*^9, {3.891678896868974*^9, 3.891678929946194*^9}, {
   3.891679907671721*^9, 3.891680000455879*^9}, {3.892028664111795*^9, 
   3.892028670409159*^9}, {3.8920351384653993`*^9, 3.892035139952879*^9}, {
   3.896443181432767*^9, 3.896443185229492*^9}, {3.896444064840052*^9, 
   3.896444090287366*^9}, {3.901369501150799*^9, 3.9013695170532722`*^9}, {
   3.9039451067017393`*^9, 3.903945118005231*^9}, {3.905416663633179*^9, 
   3.905416664071869*^9}, {3.9058583491343365`*^9, 3.905858354396607*^9}, {
   3.905871493646333*^9, 3.905871493829472*^9}, 3.9132718120832186`*^9, {
   3.9249592250244675`*^9, 3.9249592327348633`*^9}, {3.9249607147437057`*^9, 
   3.924960821310499*^9}, {3.924960909216385*^9, 3.924960960064518*^9}, {
   3.9249611044980774`*^9, 3.924961184583858*^9}, {3.924961456201561*^9, 
   3.9249614748671474`*^9}, {3.925022493318878*^9, 3.92502255076919*^9}, {
   3.925022605107853*^9, 3.925022611317713*^9}, {3.925107234582161*^9, 
   3.925107236894118*^9}, {3.927971030982798*^9, 3.927971042433148*^9}, {
   3.927971914576498*^9, 3.9279719520313277`*^9}, {3.930222513952671*^9, 
   3.9302225266533566`*^9}, {3.9412202307328243`*^9, 3.941220251170391*^9}, {
   3.9412751077188582`*^9, 3.941275128344345*^9}, {3.9412757415777454`*^9, 
   3.941275747882307*^9}, {3.9412874178610477`*^9, 3.941287423140138*^9}, {
   3.941287810647007*^9, 3.941287812413479*^9}, {3.9412882729703655`*^9, 
   3.941288311583959*^9}, {3.941288822274143*^9, 3.941288835095972*^9}, {
   3.9413049273183136`*^9, 3.941304928925963*^9}, {3.9413049924924383`*^9, 
   3.9413049944615784`*^9}, {3.941305183542049*^9, 3.9413051841189747`*^9}, {
   3.941309541831227*^9, 3.941309544132948*^9}, {3.941458031010658*^9, 
   3.941458043374769*^9}, 3.941461949597412*^9, {3.941546424081459*^9, 
   3.9415464551744633`*^9}},ExpressionUUID->"c5699082-179f-9746-982f-\
5bfb9d989546"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 1: Generate  short photon  sequences", "Subsection",
 CellChangeTimes->{{3.924962181065222*^9, 3.9249622133327637`*^9}, {
  3.9250220482046776`*^9, 3.925022049326704*^9}, {3.92797175576795*^9, 
  3.92797175937658*^9}, {3.9412973942162437`*^9, 
  3.9412973982164135`*^9}},ExpressionUUID->"7436f627-c3aa-6a43-8efe-\
43db040620f3"],

Cell[CellGroupData[{

Cell["\<\
generate  a photon sequence of 200 ms with arrival times  and states; show \
the first 20 photons\
\>", "Text",
 CellChangeTimes->{{3.924962221951771*^9, 3.924962273277481*^9}, 
   3.927970986506487*^9, 3.9279710623020763`*^9, {3.927971738405657*^9, 
   3.9279717406326866`*^9}, {3.941287702350937*^9, 3.941287723586958*^9}, {
   3.9412877649985847`*^9, 3.941287771379404*^9}, 3.941288105320225*^9, {
   3.9412883317243137`*^9, 3.9412883560780926`*^9}, {3.94128842845928*^9, 
   3.941288441038261*^9}, 3.941288852701515*^9, 3.941288904837509*^9, {
   3.941289103020796*^9, 3.94128910366505*^9}, 3.94145838051312*^9, 
   3.9415471243512344`*^9},ExpressionUUID->"009fa71f-a5a8-e249-bdc4-\
0f56b69c2224"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{"time", ":=", "200"}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", ":=", 
   RowBox[{"{", 
    RowBox[{"1.", ",", "1.", ",", "1."}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "starting", " ", "point", " ", "to", " ", "generate", " ", "a", " ", 
    "photon", " ", "trajectory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     StyleBox["photonsStates1",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["photonTrajDyn2st",
       FontWeight->"Bold"], "[", 
      RowBox[{"time", ",", 
       RowBox[{"{", 
        RowBox[{"n01", ",", "n02"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d1", ",", "d2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}], ",", "axy", ",", "az", ",", "r0", 
       ",", "qOut", ",", "timeStep"}], "]"}]}], ";"}],
   FontSize->14,
   FontColor->GrayLevel[0]], 
  StyleBox["//",
   FontSize->14,
   FontColor->GrayLevel[0]], "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"photonsStates1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", 
     StyleBox[
      RowBox[{"2", "0"}]]}], "]"}], "]"}],
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.924960983599108*^9, 3.924961030873495*^9}, {
   3.924961063264754*^9, 3.924961089295807*^9}, {3.924961188416664*^9, 
   3.924961189576451*^9}, {3.924961222776293*^9, 3.924961297073839*^9}, 
   3.924961346459593*^9, {3.924961407081585*^9, 3.92496143373011*^9}, {
   3.924961540711211*^9, 3.924961541199187*^9}, {3.924961607673979*^9, 
   3.924961608640297*^9}, {3.924961642098414*^9, 3.924961644443697*^9}, {
   3.9250227225103016`*^9, 3.925022722892176*^9}, 3.925023463331028*^9, {
   3.927971332551205*^9, 3.927971408558691*^9}, {3.927971963785324*^9, 
   3.927971963911934*^9}, {3.9412877789416504`*^9, 3.9412877792886105`*^9}, 
   3.9412881023595085`*^9, {3.941288195588705*^9, 3.9412881986227894`*^9}, {
   3.941288329927738*^9, 3.9412883588611946`*^9}, 3.9412884435084724`*^9, 
   3.9412888558851166`*^9, 3.9412889032458725`*^9, {3.9413051355301113`*^9, 
   3.9413051356928806`*^9}, {3.941305186853342*^9, 3.9413051871367817`*^9}, 
   3.9414582234543056`*^9, 3.9414584330637856`*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"ba406bce-926b-f344-a1e6-5c7b8eb2fae0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"23.8149037`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.924962313877447*^9, 3.925022677367956*^9, 3.925022739657931*^9, 
   3.9250227858635*^9, 3.925023481149223*^9, 3.925578812217341*^9, {
   3.927971385636835*^9, 3.927971409447054*^9}, 3.9279714845053186`*^9, 
   3.927971977785412*^9, 3.927972014889124*^9, 3.941287755004427*^9, 
   3.941287793086502*^9, 3.9412878265657063`*^9, 3.9412880829063606`*^9, 
   3.9412881315926247`*^9, 3.9412881864806347`*^9, 3.94128822449362*^9, 
   3.941288345753771*^9, 3.941288385526779*^9, 3.9412884825417233`*^9, 
   3.941288869894533*^9, 3.941288931210699*^9, 3.941290340490635*^9, 
   3.9413050240720177`*^9, 3.941305239880268*^9, 3.9413095951710396`*^9, 
   3.9413932707617016`*^9, 3.941393326942396*^9, 3.9414580943237095`*^9, 
   3.941458168853142*^9, 3.9414582118745575`*^9, 3.941458248003277*^9, 
   3.9414583213243294`*^9, 3.9414583516223793`*^9, 3.9414584079021606`*^9, 
   3.9414584586372166`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"cb68de95-3b85-d74c-b1dc-f6a01b3f1bc1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.5694`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6096`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6126`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.620800000000001`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.67`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6813`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6841`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6922`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7002`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7021`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.707600000000001`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7127`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7269`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7319`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7337`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7339`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.74`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.750300000000001`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7683`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7761`", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.924962313877447*^9, 3.925022677367956*^9, 3.925022739657931*^9, 
   3.9250227858635*^9, 3.925023481149223*^9, 3.925578812217341*^9, {
   3.927971385636835*^9, 3.927971409447054*^9}, 3.9279714845053186`*^9, 
   3.927971977785412*^9, 3.927972014889124*^9, 3.941287755004427*^9, 
   3.941287793086502*^9, 3.9412878265657063`*^9, 3.9412880829063606`*^9, 
   3.9412881315926247`*^9, 3.9412881864806347`*^9, 3.94128822449362*^9, 
   3.941288345753771*^9, 3.941288385526779*^9, 3.9412884825417233`*^9, 
   3.941288869894533*^9, 3.941288931210699*^9, 3.941290340490635*^9, 
   3.9413050240720177`*^9, 3.941305239880268*^9, 3.9413095951710396`*^9, 
   3.9413932707617016`*^9, 3.941393326942396*^9, 3.9414580943237095`*^9, 
   3.941458168853142*^9, 3.9414582118745575`*^9, 3.941458248003277*^9, 
   3.9414583213243294`*^9, 3.9414583516223793`*^9, 3.9414584079021606`*^9, 
   3.9414584586424904`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"db86512e-a7a8-7a46-887d-009bb892ace9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["add  color labels", "Text",
 CellChangeTimes->{{3.924962304166542*^9, 3.924962315400112*^9}, 
   3.9279709891839447`*^9, 3.927971536007551*^9, {3.9412212702497196`*^9, 
   3.941221273137144*^9}},ExpressionUUID->"d749fdef-1bb0-ad47-8dd6-\
78fc3d8da23f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["photonsColor1",
    FontWeight->"Bold"], 
   StyleBox["=",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox["addColorDyn",
     FontWeight->"Bold"], 
    StyleBox["[",
     FontColor->GrayLevel[0]], 
    StyleBox[
     RowBox[{"photonsStates1", ",", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}]}],
     FontColor->GrayLevel[0]], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}]}], 
  StyleBox[";",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"photonsColor1", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "20"}], "]"}], "]"}],
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.924960983599108*^9, 3.924961030873495*^9}, {
   3.924961063264754*^9, 3.924961089295807*^9}, {3.924961188416664*^9, 
   3.924961189576451*^9}, {3.924961222776293*^9, 3.924961297073839*^9}, 
   3.924961346459593*^9, {3.924961407081585*^9, 3.92496143373011*^9}, {
   3.924961540711211*^9, 3.924961541199187*^9}, {3.924961607673979*^9, 
   3.924961608640297*^9}, {3.924961642098414*^9, 3.92496165267265*^9}, {
   3.9279714970392838`*^9, 3.9279715206163483`*^9}, 3.941458392381399*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"c69d6b21-863f-5241-b606-a2e70c66ba4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.5694`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6096`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6126`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.620800000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.67`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6813`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6841`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6922`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7002`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7021`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.707600000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7127`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7269`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7319`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7337`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7339`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.74`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.750300000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7683`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7761`", ",", "\<\"d\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9413932949559536`*^9, 3.941393331350378*^9, 
  3.9414580943841705`*^9, 3.941458168953987*^9, 3.941458274662588*^9, 
  3.9414584586757793`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"0068ce93-7c41-8e45-ac41-c51cf308453d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["add  background  noise", "Text",
 CellChangeTimes->{{3.924962349776701*^9, 3.924962358546627*^9}, 
   3.9279709898963795`*^9, 
   3.9279715657845993`*^9},ExpressionUUID->"a8f7845c-97e5-7e4e-a258-\
ebe7ce75c646"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["photonsColorBN1",
    FontWeight->"Bold"], 
   StyleBox["=",
    FontWeight->"Bold"], 
   StyleBox[
    RowBox[{"addBN", "[", 
     StyleBox[
      RowBox[{"photonsColor1", ",", "bA", ",", "bD"}],
      FontWeight->"Bold"], "]"}],
    FontColor->GrayLevel[0]]}], 
  StyleBox[";",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{"photonsColorBN1", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "20"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.924960983599108*^9, 3.924961030873495*^9}, {
   3.924961063264754*^9, 3.924961089295807*^9}, {3.924961188416664*^9, 
   3.924961189576451*^9}, {3.924961222776293*^9, 3.924961297073839*^9}, 
   3.924961346459593*^9, {3.924961407081585*^9, 3.92496143373011*^9}, {
   3.924961540711211*^9, 3.924961541199187*^9}, {3.924961607673979*^9, 
   3.924961608640297*^9}, {3.924961642098414*^9, 3.924961658190224*^9}, 
   3.924962373616785*^9, 3.9414583963815746`*^9},
 CellLabel->
  "In[124]:=",ExpressionUUID->"1775f98b-7d04-da4a-841c-e7350336aaa4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8.5694`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6096`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6126`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.620800000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.625510663041979`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.67`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6813`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6841`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.6922`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7002`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7021`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.707600000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7127`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7269`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7319`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7337`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.7339`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.74`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.750300000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.750660385961027`", ",", "\<\"d\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.924961344067114*^9, 3.9249613649982224`*^9}, 
   3.9249614288584976`*^9, 3.9249615784131813`*^9, 3.92496171137475*^9, 
   3.924962378114897*^9, 3.925022819018446*^9, 3.9250234984109936`*^9, 
   3.925578812396944*^9, 3.92797157383211*^9, 3.927971986047882*^9, 
   3.9279720249990883`*^9, 3.941287864220373*^9, 3.94128808300766*^9, 
   3.941288345856043*^9, 3.9412883856223984`*^9, 3.9412884826214504`*^9, 
   3.941288879015449*^9, 3.941288931286667*^9, 3.941290340635321*^9, 
   3.941305248585964*^9, 3.941309595301472*^9, 3.941393334282038*^9, 
   3.941458094428211*^9, 3.9414581690086527`*^9, 3.941458278076996*^9, 
   3.9414584587162724`*^9, 3.94145850099385*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"50f1554d-a61f-b340-b3f1-4abbee4eb061"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
select  bursts; the first photon in a burst has arrival time 0.\
\>", "Text",
 CellChangeTimes->{{3.924962393688741*^9, 3.9249624011171837`*^9}, 
   3.927970990791971*^9, 3.927971640511565*^9, {3.941287918184351*^9, 
   3.94128793189546*^9}},ExpressionUUID->"e7c09b33-cd07-504a-b7bd-\
0e77b1ad236f"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    StyleBox["bursts1",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["selectBursts",
      FontWeight->"Bold"], "[", 
     RowBox[{"photonsColorBN1", ",", " ", "nTh", ",", "tTh"}], "]"}]}], ";"}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{{3.924961679573477*^9, 3.9249616908240395`*^9}, {
   3.924961732576487*^9, 3.924961734536379*^9}, {3.924961771475107*^9, 
   3.924961821271242*^9}, {3.92496242997567*^9, 3.924962433002256*^9}, 
   3.925022861362129*^9},
 CellLabel->
  "In[126]:=",ExpressionUUID->"0c8ed64d-c058-a74f-88f4-a864a149f0fc"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", 
    RowBox[{"there", " ", "are", " ", "7", "  ", "bursts"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"bursts1", "//", "Length"}]}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{
  3.9412884894670105`*^9, 3.941288958417835*^9, 3.9412903596776924`*^9, 
   3.941305260789772*^9, 3.941393348020563*^9, 3.941458173779436*^9, {
   3.941458288597391*^9, 3.9414582889096813`*^9}, 
   3.941458542239479*^9},ExpressionUUID->"5e8e0f55-e342-0b4e-9c93-\
dd50983dda96"],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{
  3.9412879857927094`*^9, 3.941288084725527*^9, {3.941288348858736*^9, 
   3.941288350906929*^9}, 3.941288385706196*^9, 3.9412884826875515`*^9, 
   3.9412888880405254`*^9, 3.941288931353094*^9, 3.9412903560769005`*^9, 
   3.941305257034664*^9, 3.941309595378172*^9, 3.9413933445334663`*^9, 
   3.9414580945072136`*^9, 3.9414581690868855`*^9, 3.9414582830956135`*^9, 
   3.941458536374161*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"f1b40f84-dd40-6243-a34c-833e429b3e92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "first", " ", "and", " ", "the", " ", "second", " ", 
     "burst"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bursts1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"bursts1", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}],
  FontColor->GrayLevel[0]]], "Input",
 CellChangeTimes->{{3.924961679573477*^9, 3.9249616908240395`*^9}, {
  3.924961732576487*^9, 3.924961734536379*^9}, {3.924961771475107*^9, 
  3.924961821271242*^9}, {3.92496242997567*^9, 3.924962433002256*^9}, {
  3.925022861362129*^9, 3.925022881895981*^9}, {3.9412879011733265`*^9, 
  3.941287901909565*^9}, {3.9412890775907097`*^9, 3.9412890803496933`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"75143194-e63c-944b-b311-7b0feec4ab5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04020000000000046`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04320000000000057`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.051400000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05611066304197898`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.10060000000000002`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11190000000000033`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11470000000000091`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1227999999999998`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1308000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.13269999999999982`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1382000000000012`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.14329999999999998`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15750000000000064`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16249999999999964`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16430000000000078`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1645000000000003`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1706000000000003`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.18090000000000117`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.18126038596102667`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.19890000000000008`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.20669999999999966`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.20790000000000042`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.20809999999999995`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.21260000000000012`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.21670000000000122`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.21879999999999988`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.22090000000000032`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.22940000000000005`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.23820000000000086`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2538`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25640000000000107`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25980000000000025`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2668999999999997`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2697000000000003`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2713000000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.27340000000000053`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2735000000000003`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3021737900847956`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.32590000000000074`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.32670000000000066`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3308`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.33140000000000036`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.34020000000000117`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.34299999999999997`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3498000000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.36240000000000094`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3655000000000008`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3708000000000009`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.37870000000000026`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3899000000000008`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.39440000000000097`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3947000000000003`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.39860000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.40800000000000125`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.41350000000000087`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.41660000000000075`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.42100000000000115`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.422600000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.42769999999999975`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.43100000000000094`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4458000000000002`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4565999999999999`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4873000000000012`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4933000000000014`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5020000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5058000000000007`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5096000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5126000000000008`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.517100000000001`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5175999999999998`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5350000000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5529000000000011`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5560000000000009`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5653000000000006`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5683000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5718000000000014`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5812000000000008`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5863000000000014`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6103000000000005`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6633000000000013`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6984849799004582`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7041000000000004`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7248000000000001`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7557000000000009`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7612000000000005`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7667999999999999`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.783100000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7991598295209332`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8314000000000004`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8383000000000003`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8384`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9379000000000008`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9789000000000012`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1000000000000014`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1105`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.135200000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1378000000000004`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1506000000000007`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1662`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1671000000000014`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1795539222770817`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.202300000000001`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2406000000000006`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3979`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4502000000000006`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4741`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4748`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4755000000000003`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4764`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4895000000000014`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4920000000000009`", ",", "\<\"d\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.925022884896871*^9, 3.925022896585932*^9}, 
   3.925023523034004*^9, 3.925578812490999*^9, 3.927971655622696*^9, 
   3.9279720372271996`*^9, 3.9412879099555035`*^9, 3.9412880220136604`*^9, 
   3.9412885038251095`*^9, 3.941288931404705*^9, {3.941290340782709*^9, 
   3.9412903614258003`*^9}, 3.94130527024753*^9, 3.9413095954455433`*^9, 
   3.941393351307604*^9, 3.941458094564871*^9, 3.9414581752491646`*^9, 
   3.9414584587960663`*^9, 3.941458543600439*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"a059cd1a-91bd-0046-b971-0335e8ade131"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.01559999999999917`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.022999999999999687`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.08939999999999948`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.09049999999999869`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1324999999999985`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.13739999999999952`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.14589999999999925`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15409999999999968`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16139999999999866`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.22959999999999958`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.23320000000000007`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3149999999999995`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3396999999999988`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3562999999999992`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3929965567719176`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5805427969965518`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6290999999999993`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6567999999999987`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7924624778976845`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8082452761437349`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8111999999999995`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8141999999999996`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8270999999999997`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8551000000000002`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9245000000000001`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9281999999999986`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9298607217792476`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9603999999999999`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9614999999999991`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0030999999999999`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0275999999999996`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0358`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0420999999999996`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0421999999999993`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0556999999999999`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0572999999999997`", ",", "\<\"d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0661999999999985`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0902999999999992`", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1225999999999985`", ",", "\<\"a\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.925022884896871*^9, 3.925022896585932*^9}, 
   3.925023523034004*^9, 3.925578812490999*^9, 3.927971655622696*^9, 
   3.9279720372271996`*^9, 3.9412879099555035`*^9, 3.94128802201366*^9, 
   3.941288503825109*^9, 3.941288931404705*^9, {3.941290340782709*^9, 
   3.9412903614258003`*^9}, 3.94130527024753*^9, 3.9413095954455433`*^9, 
   3.941393351307604*^9, 3.941458094564871*^9, 3.9414581752491636`*^9, 
   3.9414584587960663`*^9, 3.941458543610552*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"0584ecf5-ac67-4d4a-9145-48802ed3c75e"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 2: Generate longer photon  sequences", "Subsection",
 CellChangeTimes->{{3.924962181065222*^9, 3.9249622133327637`*^9}, {
   3.9250220482046776`*^9, 3.925022049326704*^9}, {3.92797175576795*^9, 
   3.92797175937658*^9}, {3.9412892150794983`*^9, 3.941289245190493*^9}, 
   3.941290069862997*^9, {3.941297380327524*^9, 3.941297391422922*^9}, {
   3.94144558177042*^9, 
   3.9414455819477425`*^9}},ExpressionUUID->"4daa62d2-e13e-d84e-b3e0-\
2e25ab722b92"],

Cell[CellGroupData[{

Cell["\<\
 Generate  bursts  from  nTraj=8    photon  trajectories  of  duration  7 s  \
each; unequal count rates and diffusion coefficients of the states\
\>", "Text",
 CellChangeTimes->{{3.924962393688741*^9, 3.9249624011171837`*^9}, 
   3.927970990791971*^9, 3.927971640511565*^9, {3.941287918184351*^9, 
   3.94128793189546*^9}, {3.9412896187818394`*^9, 3.941289641696066*^9}, {
   3.941289699181261*^9, 3.94128976060344*^9}, 3.94129007563744*^9, {
   3.941290198449089*^9, 3.941290244235501*^9}, 3.9412903856530743`*^9, {
   3.941461985846323*^9, 
   3.941462001182741*^9}},ExpressionUUID->"2ca257d0-53e4-bb4e-91a5-\
7b77d5ed703c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "there", " ", "are", " ", "8", " ", "photon", " ", "trajectories"}], ",", 
    " ", 
    RowBox[{
    "each", " ", "generated", " ", "independently", " ", "in", " ", 
     "parallel"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"nTraj", ":=", "8"}], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"time", ":=", "7000"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox["\[IndentingNewLine]",
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"random", " ", "starting", " ", "point"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"r0", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rVector", ",", "rx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Until", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rVector", ".", "rVector"}], "<", 
           RowBox[{"qOut", "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"rVector", "=", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "qOut"}], ",", "qOut"}], "}"}], ",", "3"}], 
             "]"}]}], ";", 
           RowBox[{"rx", "=", 
            RowBox[{"rVector", 
             RowBox[{"{", 
              RowBox[{"axy", ",", "axy", ",", "az"}], "}"}]}]}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "rx"}]}], "\[IndentingNewLine]", "]"}], 
     " "}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.92496187745641*^9, 3.9249618848790607`*^9}, {
   3.924961981102909*^9, 3.924962036776516*^9}, {3.924962569132433*^9, 
   3.92496259980015*^9}, 3.9249652071152744`*^9, 3.9249652386444454`*^9, {
   3.925022966895317*^9, 3.925023027365464*^9}, {3.925023058964081*^9, 
   3.92502306333749*^9}, {3.9250234256799145`*^9, 3.925023441903122*^9}, {
   3.9250281453693676`*^9, 3.925028147970415*^9}, {3.92797292326302*^9, 
   3.927972924031095*^9}, {3.9279729604384785`*^9, 3.92797303619149*^9}, {
   3.927973073815155*^9, 3.927973136487009*^9}, {3.92797318048782*^9, 
   3.927973222926399*^9}, {3.927973665528572*^9, 3.927973695971361*^9}, {
   3.92797414122143*^9, 3.927974147288449*^9}, {3.927974311423172*^9, 
   3.927974350889147*^9}, {3.9302198727789803`*^9, 3.9302198749504604`*^9}, 
   3.930222874359863*^9, {3.930224017681526*^9, 3.930224019493681*^9}, 
   3.930307401821827*^9, {3.941275211320307*^9, 3.9412752211927166`*^9}, {
   3.941288544285845*^9, 3.941288575469049*^9}, {3.941288620479147*^9, 
   3.941288637349767*^9}, {3.941288672191908*^9, 3.941288729981325*^9}, {
   3.941288762010065*^9, 3.9412887715507126`*^9}, {3.9412889346773777`*^9, 
   3.94128894305509*^9}, {3.941289285240591*^9, 3.941289300644327*^9}, {
   3.9412893384478493`*^9, 3.941289342316202*^9}, {3.941289424558346*^9, 
   3.9412894314364243`*^9}, {3.941289652224167*^9, 3.9412896603483143`*^9}, {
   3.9412901253075714`*^9, 3.9412901361617947`*^9}, 3.9412927589438705`*^9, {
   3.9412952004231358`*^9, 3.941295209750868*^9}, 3.941295247974219*^9, {
   3.941295500519718*^9, 3.941295526310217*^9}, {3.9413053382728863`*^9, 
   3.941305372423794*^9}, 3.941393399470743*^9, {3.9414620080323715`*^9, 
   3.941462010222725*^9}, 
   3.9415471961133766`*^9},ExpressionUUID->"c411af84-0d4f-0546-bb34-\
c6bc2a5f3a3f"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"n01", ":=", "400."}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the", 
     " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"n02", ":=", "200."}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"d1", ":=", "0.1"}], 
   RowBox[{"(*", 
    RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"d2", ":=", "0.2"}], "\[IndentingNewLine]"}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trajList", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        StyleBox["photonTrajDyn2st",
         FontWeight->"Bold"], "[", 
        RowBox[{"time", ",", 
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d1", ",", "d2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}], ",", "axy", ",", "az", ",", "r0", 
         ",", "qOut", ",", "timeStep"}], "]"}], ",", 
       RowBox[{"{", "nTraj", "}"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "generate", " ", "bursts", " ", "from", " ", "\"\<nTraj\>\"", "  ", 
     "photon", " ", "trajectories", " ", "of", " ", "duration", " ", 
     "\"\<time\>\"", " ", "each"}], "*)"}],
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["photonsColor1List",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["Map",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      RowBox[{
       RowBox[{
        StyleBox["addColorDyn",
         FontWeight->"Bold"], 
        StyleBox["[",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}]}],
         FontColor->GrayLevel[0]], 
        StyleBox["]",
         FontColor->GrayLevel[0]]}], 
       StyleBox["&",
        FontColor->GrayLevel[0]]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["trajList",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}]}], 
   StyleBox[";",
    FontColor->GrayLevel[0]]}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "add", " ", "color", " ", "labels", " ", "to", " ", "each", " ", 
     "photon"}], " ", "*)"}],
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["photonsColorBN1List",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["Map",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{
        RowBox[{"addBN", "[", 
         StyleBox[
          RowBox[{"#", ",", "bA", ",", "bD"}],
          FontWeight->"Bold"], "]"}], "&"}],
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["photonsColor1List",
       FontWeight->"Bold"]}], 
     StyleBox["]",
      FontWeight->"Bold"]}]}], 
   StyleBox[";",
    FontColor->GrayLevel[0]]}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "add", " ", "BN", " ", "to", " ", "each", " ", "photon", " ", 
     "trajectory"}], "*)"}],
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["burstsList",
     FontColor->GrayLevel[0]], 
    StyleBox["=",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["Map",
      FontColor->GrayLevel[0]], 
     StyleBox["[",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{
       RowBox[{
        StyleBox["selectBursts",
         FontWeight->"Bold"], "[", 
        RowBox[{"#", ",", " ", "nTh", ",", "tTh"}], "]"}], "&"}], ",", 
      StyleBox["photonsColorBN1List",
       FontWeight->"Bold"]}], 
     StyleBox["]",
      FontWeight->"Bold"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"select", " ", "bursts"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bursts", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"burstsList", ",", "1"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"unite", " ", "bursts"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.92496187745641*^9, 3.9249618848790607`*^9}, {
   3.924961981102909*^9, 3.924962036776516*^9}, {3.924962569132433*^9, 
   3.92496259980015*^9}, 3.9249652071152744`*^9, 3.9249652386444454`*^9, {
   3.925022966895317*^9, 3.925023027365464*^9}, {3.925023058964081*^9, 
   3.92502306333749*^9}, {3.9250234256799145`*^9, 3.925023441903122*^9}, {
   3.9250281453693676`*^9, 3.925028147970415*^9}, {3.92797292326302*^9, 
   3.927972924031095*^9}, {3.9279729604384785`*^9, 3.92797303619149*^9}, {
   3.927973073815155*^9, 3.927973136487009*^9}, {3.92797318048782*^9, 
   3.927973222926399*^9}, {3.927973665528572*^9, 3.927973695971361*^9}, {
   3.92797414122143*^9, 3.927974147288449*^9}, {3.927974311423172*^9, 
   3.927974350889147*^9}, {3.9302198727789803`*^9, 3.9302198749504604`*^9}, 
   3.930222874359863*^9, {3.930224017681526*^9, 3.930224019493681*^9}, 
   3.930307401821827*^9, {3.941275211320307*^9, 3.9412752211927166`*^9}, {
   3.941288544285845*^9, 3.941288575469049*^9}, {3.941288620479147*^9, 
   3.941288637349767*^9}, {3.941288672191908*^9, 3.941288729981325*^9}, {
   3.941288762010065*^9, 3.9412887715507126`*^9}, {3.9412889346773777`*^9, 
   3.94128894305509*^9}, {3.941289285240591*^9, 3.941289300644327*^9}, {
   3.9412893384478493`*^9, 3.941289342316202*^9}, {3.941289424558346*^9, 
   3.9412894314364243`*^9}, {3.941289476461822*^9, 3.941289528972933*^9}, {
   3.9412896856322823`*^9, 3.941289690725757*^9}, {3.941290057316334*^9, 
   3.9412900578731213`*^9}, {3.9412927795540104`*^9, 3.941292858253441*^9}, {
   3.9413935006440988`*^9, 3.9413935015067396`*^9}, {3.94145861199687*^9, 
   3.941458619262192*^9}, {3.9415472472034016`*^9, 
   3.9415472636806946`*^9}},ExpressionUUID->"7a0dde17-0ac7-7b45-a34f-\
163c9b11053f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4029.7232662`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.9249627810587463`*^9, 3.9249652289530487`*^9, 
  3.9249662633900375`*^9, 3.9250234042660065`*^9, 3.9250273516480618`*^9, 
  3.925030030892504*^9, 3.925580628832421*^9, 3.927974230551737*^9, 
  3.92797430814699*^9, 3.9279774496402893`*^9, 3.930219429596279*^9, 
  3.930219869123354*^9, 3.93022066830986*^9, 3.9302240299761353`*^9, 
  3.9302241185247803`*^9, 3.930224954874914*^9, 3.930309029108406*^9, 
  3.930509710681355*^9, 3.930511086123245*^9, 3.941291878949005*^9, 
  3.941296719331211*^9, 3.941306968698818*^9, 3.9413115705557346`*^9, 
  3.941393477381422*^9, 3.9413949693387756`*^9, 3.941460079782852*^9, 
  3.94146604845553*^9},
 CellLabel->
  "Out[186]=",ExpressionUUID->"48f093f3-c86c-8047-a84d-93091e76333c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"there", " ", "are", " ", 
      RowBox[{"{", 
       RowBox[{
       "122", ",", "136", ",", "110", ",", "120", ",", "123", ",", "118", ",",
         "102", ",", "145"}], "}"}], " ", "bursts", " ", "from", "  ", "8", 
      " ", "photon", " ", "sequences"}], ";", " ", 
     RowBox[{"total", " ", "976", " ", "bursts"}]}], "*)"}],
   FontWeight->"Bold"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox[
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "burstsList"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{"bursts", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{{3.925023043090948*^9, 3.9250230533958035`*^9}, {
   3.925023092370714*^9, 3.925023115595297*^9}, {3.9250333815785484`*^9, 
   3.925033396660076*^9}, {3.9255878313718204`*^9, 3.925587835344393*^9}, {
   3.927973719247055*^9, 3.927973734665118*^9}, {3.92797753075749*^9, 
   3.927977563432549*^9}, {3.930222890138155*^9, 3.9302228961213436`*^9}, 
   3.930225131344946*^9, 3.9303080808495464`*^9, 3.930311342271181*^9, {
   3.9412895437896748`*^9, 3.941289560540729*^9}, {3.941306696916729*^9, 
   3.941306717900542*^9}, {3.941309262142159*^9, 3.9413092680786*^9}, {
   3.941400587742176*^9, 3.941400597413494*^9}, {3.941547279185854*^9, 
   3.9415472895365467`*^9}},ExpressionUUID->"866c5872-0e57-3343-a945-\
f97e62966f40"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "122", ",", "136", ",", "110", ",", "120", ",", "123", ",", "118", ",", 
   "102", ",", "145"}], "}"}]], "Output",
 CellChangeTimes->{{3.925033378594845*^9, 3.925033383384821*^9}, 
   3.925582336793623*^9, 3.927977525109211*^9, 3.9302214913893833`*^9, 
   3.930224955921543*^9, 3.9303113322502975`*^9, 3.930511086450062*^9, 
   3.94129187970438*^9, 3.941296748393057*^9, 3.941306969157751*^9, 
   3.9413115709892235`*^9, 3.9413949698414516`*^9, 3.941460080274744*^9, 
   3.9414660493396473`*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"daf64cc7-5f23-f543-82aa-3e2aec77b100"],

Cell[BoxData["976"], "Output",
 CellChangeTimes->{{3.925033378594845*^9, 3.925033383384821*^9}, 
   3.925582336793623*^9, 3.927977525109211*^9, 3.9302214913893833`*^9, 
   3.930224955921543*^9, 3.9303113322502975`*^9, 3.930511086450062*^9, 
   3.94129187970438*^9, 3.941296748393057*^9, 3.941306969157751*^9, 
   3.9413115709892235`*^9, 3.9413949698414516`*^9, 3.941460080274744*^9, 
   3.9414660493396473`*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"1722ef67-712a-d74d-bf63-3c64a4d6b95c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "bursts", " ", "for", " ", "further", " ", "analysis"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bursts", ">>", "\"\<burstsSampleUnEqual\>\""}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.930307478871672*^9, 3.930307499414549*^9}, {
   3.9303075377293396`*^9, 3.9303075856166916`*^9}, 3.930307659744993*^9, {
   3.930389918888052*^9, 3.930389927566384*^9}, {3.941289573350811*^9, 
   3.941289589615244*^9}, {3.941289812878401*^9, 3.941289820180907*^9}, {
   3.9412901808849335`*^9, 3.941290181213266*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"10b9a6cb-6754-f243-9945-3df28d77d3f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
The same for a molecule with equal brightness and diffusivity in two states.\
\>", "Text",
 CellChangeTimes->{{3.924962393688741*^9, 3.9249624011171837`*^9}, 
   3.927970990791971*^9, 3.927971640511565*^9, {3.941287918184351*^9, 
   3.94128793189546*^9}, {3.9412896187818394`*^9, 3.941289641696066*^9}, {
   3.941289699181261*^9, 3.9412897606034393`*^9}, {3.941289876287098*^9, 
   3.941289902725439*^9}, {3.9412902642876377`*^9, 
   3.9412902730623417`*^9}},ExpressionUUID->"c1fe3d25-1ab4-ef4a-9924-\
3f2fc19cb3d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"n01", ":=", "200."}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the", 
     " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"n02", ":=", "200."}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"d1", ":=", "0.2"}], 
   RowBox[{"(*", 
    RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}]}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"d2", ":=", "0.2"}],
  FontSize->14,
  FontWeight->"Bold",
  FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trajList", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        StyleBox["photonTrajDyn2st",
         FontWeight->"Bold"], "[", 
        RowBox[{"time", ",", 
         RowBox[{"{", 
          RowBox[{"n01", ",", "n02"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d1", ",", "d2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}], ",", "axy", ",", "az", ",", "r0", 
         ",", "qOut", ",", "timeStep"}], "]"}], ",", 
       RowBox[{"{", "nTraj", "}"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "generate", " ", "bursts", " ", "from", " ", "\"\<nTraj\>\"", "  ", 
     "photon", " ", "trajectories", " ", "of", " ", "duration", " ", 
     "\"\<time\>\"", " ", "each"}], "*)"}],
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["photonsColor1List",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["Map",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      RowBox[{
       RowBox[{
        StyleBox["addColorDyn",
         FontWeight->"Bold"], 
        StyleBox["[",
         FontColor->GrayLevel[0]], 
        StyleBox[
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}]}],
         FontColor->GrayLevel[0]], 
        StyleBox["]",
         FontColor->GrayLevel[0]]}], 
       StyleBox["&",
        FontColor->GrayLevel[0]]}], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["trajList",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}]}], 
   StyleBox[";",
    FontColor->GrayLevel[0]]}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "add", " ", "color", " ", "labels", " ", "to", " ", "each", " ", "photon",
      " ", "trajectory"}], "*)"}],
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["photonsColorBN1List",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["Map",
      FontWeight->"Bold"], 
     StyleBox["[",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox[
       RowBox[{
        RowBox[{"addBN", "[", 
         StyleBox[
          RowBox[{"#", ",", "bA", ",", "bD"}],
          FontWeight->"Bold"], "]"}], "&"}],
       FontColor->GrayLevel[0]], 
      StyleBox[",",
       FontColor->GrayLevel[0]], 
      StyleBox["photonsColor1List",
       FontWeight->"Bold"]}], 
     StyleBox["]",
      FontWeight->"Bold"]}]}], 
   StyleBox[";",
    FontColor->GrayLevel[0]]}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "add", " ", "BN", " ", "to", " ", "each", " ", "photon", " ", 
     "trajectory"}], "*)"}],
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["burstsList",
     FontColor->GrayLevel[0]], 
    StyleBox["=",
     FontColor->GrayLevel[0]], 
    RowBox[{
     StyleBox["Map",
      FontColor->GrayLevel[0]], 
     StyleBox["[",
      FontColor->GrayLevel[0]], 
     RowBox[{
      RowBox[{
       RowBox[{
        StyleBox["selectBursts",
         FontWeight->"Bold"], "[", 
        RowBox[{"#", ",", " ", "nTh", ",", "tTh"}], "]"}], "&"}], ",", 
      StyleBox["photonsColorBN1List",
       FontWeight->"Bold"]}], 
     StyleBox["]",
      FontWeight->"Bold"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"select", " ", "bursts"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bursts", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"burstsList", ",", "1"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"unite", " ", "bursts"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.92496187745641*^9, 3.9249618848790607`*^9}, {
   3.924961981102909*^9, 3.924962036776516*^9}, {3.924962569132433*^9, 
   3.92496259980015*^9}, 3.9249652071152744`*^9, 3.9249652386444454`*^9, {
   3.925022966895317*^9, 3.925023027365464*^9}, {3.925023058964081*^9, 
   3.92502306333749*^9}, {3.9250234256799145`*^9, 3.925023441903122*^9}, {
   3.9250281453693676`*^9, 3.925028147970415*^9}, {3.92797292326302*^9, 
   3.927972924031095*^9}, {3.9279729604384785`*^9, 3.92797303619149*^9}, {
   3.927973073815155*^9, 3.927973136487009*^9}, {3.92797318048782*^9, 
   3.927973222926399*^9}, {3.927973665528572*^9, 3.927973695971361*^9}, {
   3.92797414122143*^9, 3.927974147288449*^9}, {3.927974311423172*^9, 
   3.927974350889147*^9}, {3.9302198727789803`*^9, 3.9302198749504604`*^9}, 
   3.930222874359863*^9, {3.930224017681526*^9, 3.930224019493681*^9}, 
   3.930307401821827*^9, {3.941275211320307*^9, 3.9412752211927166`*^9}, {
   3.941288544285845*^9, 3.941288575469049*^9}, {3.941288620479147*^9, 
   3.941288637349767*^9}, {3.941288672191908*^9, 3.941288729981325*^9}, {
   3.941288762010065*^9, 3.9412887715507126`*^9}, {3.9412889346773777`*^9, 
   3.94128894305509*^9}, {3.941289285240591*^9, 3.941289300644327*^9}, {
   3.9412893384478493`*^9, 3.941289342316202*^9}, {3.941289424558346*^9, 
   3.9412894314364243`*^9}, {3.941289476461822*^9, 3.941289528972933*^9}, {
   3.9412896856322823`*^9, 3.941289690725757*^9}, {3.9412899246249313`*^9, 
   3.9412899284613647`*^9}, {3.9412902794456673`*^9, 
   3.9412902828292675`*^9}, {3.941458674727369*^9, 3.941458676068163*^9}, 
   3.9415473112827225`*^9},ExpressionUUID->"e5b5d5c8-f342-3f43-a441-\
1455ca8960d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4079.6448076`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.9249627810587463`*^9, 3.9249652289530487`*^9, 
  3.9249662633900375`*^9, 3.9250234042660065`*^9, 3.9250273516480618`*^9, 
  3.925030030892504*^9, 3.925580628832421*^9, 3.927974230551737*^9, 
  3.92797430814699*^9, 3.9279774496402893`*^9, 3.930219429596279*^9, 
  3.930219869123354*^9, 3.93022066830986*^9, 3.9302240299761353`*^9, 
  3.9302241185247803`*^9, 3.930224954874914*^9, 3.930309029108406*^9, 
  3.930509710681355*^9, 3.930511086123245*^9, 3.94131301750194*^9, 
  3.941396561366434*^9, 3.9414616009045525`*^9, 3.941470129759508*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"9af431ee-5bbe-0e40-ad61-803154efb52f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"there", " ", "are", " ", 
     RowBox[{"{", 
      RowBox[{
      "109", ",", "105", ",", "106", ",", "104", ",", "102", ",", "111", ",", 
       "124", ",", "122"}], "}"}], " ", "bursts", " ", "from", "  ", "8", " ",
      "sequences", " ", "and", " ", "total", " ", "883", " ", "bursts"}], 
    "*)"}],
   FontWeight->"Bold"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox[
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "burstsList"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Bold"], 
   RowBox[{"bursts", "//", "Length"}]}]}]], "Input",
 CellChangeTimes->{{3.925023043090948*^9, 3.9250230533958035`*^9}, {
   3.925023092370714*^9, 3.925023115595297*^9}, {3.9250333815785484`*^9, 
   3.925033396660076*^9}, {3.9255878313718204`*^9, 3.925587835344393*^9}, {
   3.927973719247055*^9, 3.927973734665118*^9}, {3.92797753075749*^9, 
   3.927977563432549*^9}, {3.930222890138155*^9, 3.9302228961213436`*^9}, 
   3.930225131344946*^9, 3.9303080808495464`*^9, 3.930311342271181*^9, {
   3.9412895437896748`*^9, 3.941289560540729*^9}, {3.9414006439239*^9, 
   3.941400650084612*^9}, {3.941477272636511*^9, 3.9414772895128345`*^9}, {
   3.9415473234246254`*^9, 
   3.941547323840681*^9}},ExpressionUUID->"79118ef6-5338-9145-a98a-\
e355ab90cb07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "109", ",", "105", ",", "106", ",", "104", ",", "102", ",", "111", ",", 
   "124", ",", "122"}], "}"}]], "Output",
 CellChangeTimes->{{3.925033378594845*^9, 3.925033383384821*^9}, 
   3.925582336793623*^9, 3.927977525109211*^9, 3.9302214913893833`*^9, 
   3.930224955921543*^9, 3.9303113322502975`*^9, 3.930511086450062*^9, 
   3.9413130177892876`*^9, 3.9413965616690426`*^9, 3.9414616012620277`*^9, 
   3.9414701306956234`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"6753b3ea-e36d-cf4e-8810-59a5ac7292b6"],

Cell[BoxData["883"], "Output",
 CellChangeTimes->{{3.925033378594845*^9, 3.925033383384821*^9}, 
   3.925582336793623*^9, 3.927977525109211*^9, 3.9302214913893833`*^9, 
   3.930224955921543*^9, 3.9303113322502975`*^9, 3.930511086450062*^9, 
   3.9413130177892876`*^9, 3.9413965616690426`*^9, 3.9414616012620277`*^9, 
   3.941470130700739*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"e0b985a4-392b-8844-80c5-338551d7f15c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "save", " ", "bursts", " ", "for", " ", "further", " ", "analysis"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bursts", ">>", "\"\<burstsSampleEqual\>\""}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.930307478871672*^9, 3.930307499414549*^9}, {
   3.9303075377293396`*^9, 3.9303075856166916`*^9}, 3.930307659744993*^9, {
   3.930389918888052*^9, 3.930389927566384*^9}, {3.941289573350811*^9, 
   3.941289589615244*^9}, {3.941289812878401*^9, 3.9412898201809063`*^9}, {
   3.9412899416301575`*^9, 3.9412899418855076`*^9}, {3.9413096140611343`*^9, 
   3.9413096142531033`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"80a67e6c-17b0-2a49-8ea0-115f771d265e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example 3: BurstML", "Subsection",
 CellChangeTimes->{{3.924962181065222*^9, 3.9249622133327637`*^9}, {
   3.924962481168434*^9, 3.9249624864759674`*^9}, {3.925022054893024*^9, 
   3.925022070724636*^9}, 3.925033459636433*^9, 3.9412973312542*^9, 
   3.9413049059769287`*^9, 
   3.9413940663300457`*^9},ExpressionUUID->"acbd99be-4f4c-734e-b6bd-\
1a8f267336f4"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "unequal", " ", "count", " ", "rates", "  ", "and", " ", "diffusion", " ",
      "coefficients", " ", "of", " ", "the", " ", "two", " ", "states"}], 
    "*)"}],
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox[
    RowBox[{"n01", ":=", "400."}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[" ",
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the",
       " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"n02", ":=", "200."}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d1", ":=", "0.1"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d2", ":=", "0.2"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.941393911002915*^9, 3.941393947698443*^9}, {
  3.941477310522766*^9, 3.941477313810865*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"075141c1-c8ef-164a-993e-07acc8fc98d9"],

Cell[CellGroupData[{

Cell["get  generated bursts", "Text",
 CellChangeTimes->{{3.9412906031665287`*^9, 3.9412906224845104`*^9}, {
   3.941290784963421*^9, 3.941290788954603*^9}, {3.9413055049234295`*^9, 
   3.94130550951486*^9}, {3.941306307044546*^9, 3.941306315211712*^9}, 
   3.9414468451014614`*^9},ExpressionUUID->"759d3e8a-ee7d-6c42-9244-\
a0b00e7aeaec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bursts", "=", 
   RowBox[{"Get", "[", "\"\<burstsSampleUnEqual\>\"", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.941290499403423*^9, 3.941290527420414*^9}, {
   3.941291144956148*^9, 3.9412911452593822`*^9}, 3.941306178269078*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"c49b9f73-58a6-ad4a-9fa4-933ba8e7f9f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["find  burstML1   parameters  from 200 bursts", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
   3.925033477987683*^9, 3.925033483884262*^9}, {3.925107606126749*^9, 
   3.9251076248156776`*^9}, {3.925107659815073*^9, 3.925107697058201*^9}, {
   3.930389544917061*^9, 3.930389555029682*^9}, 
   3.9413937702582855`*^9},ExpressionUUID->"ebea82cd-7b83-9d46-9d5c-\
d609cd2efbbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"initial", " ", 
     RowBox[{"guess", ":", " ", 
      RowBox[{
      "exact", " ", "parameters", " ", "shifted", " ", "by", " ", "20", 
       "%"}]}]}], " ", "*)"}],
   FontWeight->"Bold"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["parsBurstML1",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["findMaxLBurstML1Dyn2st",
       FontWeight->"Bold"], "[", 
      RowBox[{
       RowBox[{"bursts", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.2", " ", 
          RowBox[{"{", 
           RowBox[{"n01", ",", "n02"}], "}"}]}], ",", 
         RowBox[{"1.2", " ", 
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}]}], ",", 
         RowBox[{"1.2", " ", 
          RowBox[{
           RowBox[{"axy", "^", "2"}], "/", 
           RowBox[{"{", 
            RowBox[{"d1", ",", "d2"}], "}"}]}]}], ",", 
         RowBox[{"1.2", " ", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}]}], "}"}], ",", "bA", ",", "bD", 
       ",", "nTh", ",", "tTh", ",", "qMax", ",", "jMax"}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}]}]], "Input",
 CellChangeTimes->{{3.924964409223089*^9, 3.924964412792168*^9}, {
   3.924965008575491*^9, 3.924965010500595*^9}, 3.925018890870472*^9, {
   3.9250221287566566`*^9, 3.925022136741073*^9}, {3.925107382698206*^9, 
   3.925107384867131*^9}, {3.9251075286978645`*^9, 3.9251075563530445`*^9}, {
   3.925107631642018*^9, 3.925107653652489*^9}, {3.9251076844489384`*^9, 
   3.925107689480921*^9}, {3.925107735368817*^9, 3.9251079306149273`*^9}, {
   3.927977432119665*^9, 3.9279774366086025`*^9}, {3.927978710593373*^9, 
   3.927978717480685*^9}, {3.9302236551542664`*^9, 3.930223656857123*^9}, {
   3.930311443692892*^9, 3.930311445740288*^9}, {3.9303895643665714`*^9, 
   3.93038957026142*^9}, {3.94139366253895*^9, 3.9413936811949844`*^9}, 
   3.9413937725388985`*^9, {3.9413938961469536`*^9, 3.941393896650215*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"03e01cc2-12df-8b4d-a21b-2ea30a47c2de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  LogLikelihood= \"\>", "\[InvisibleSpace]", 
   "69472.74869094921`", "\[InvisibleSpace]", "\<\"   steps=\"\>", 
   "\[InvisibleSpace]", "27"}],
  SequenceForm["  LogLikelihood= ", 69472.74869094921, "   steps=", 27],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303117267751255`*^9, 3.930511787335484*^9, 
  3.9413134990154743`*^9, 3.941397028556835*^9, 3.9414852110925064`*^9},
 CellLabel->
  "During evaluation of \
In[254]:=",ExpressionUUID->"0390a81e-ae83-6849-80ea-239eed818780"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (\\!\\(\\*SubscriptBox[\\(n\\), \
\\(0\\)]\\),e,\\!\\(\\*SubscriptBox[\\(\[Tau]\\), \\(d\\)]\\),k) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"418.5757494458671`", ",", "199.68571545291633`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.29414580974952437`", ",", "0.7035175070437565`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"3.6285205694796754`", ",", "1.9957842584970562`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1973455275515`", ",", "1.2111009467734462`"}], "}"}]}], 
    "}"}]}],
  SequenceForm[
  "  (\!\(\*SubscriptBox[\(n\), \(0\)]\),e,\!\(\*SubscriptBox[\(\[Tau]\), \(d\
\)]\),k) = ", {{418.5757494458671, 199.68571545291633`}, {
   0.29414580974952437`, 0.7035175070437565}, {3.6285205694796754`, 
   1.9957842584970562`}, {1.1973455275515, 1.2111009467734462`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303117267751255`*^9, 3.930511787335484*^9, 
  3.9413134990154743`*^9, 3.941397028556835*^9, 3.9414852111182632`*^9},
 CellLabel->
  "During evaluation of \
In[254]:=",ExpressionUUID->"7f584de5-97ae-2748-bbe5-a0900b06b2a4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1231.9289288`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.927982591207657*^9, 3.930222419345375*^9, 3.93022248158367*^9, {
   3.930223635173654*^9, 3.9302236576225986`*^9}, 3.9302249560309486`*^9, 
   3.930311395459816*^9, 3.930311448039076*^9, 3.930511239497946*^9, 
   3.941313110760668*^9, 3.94139702858428*^9, 3.9414852111232967`*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"bf698e98-4905-3047-88f6-3dcafa885381"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
find  standard deviations of  {{n01, n02}, {e1, e2}, {td1, td2}, {k1, k2}}    \
in  burstML1: \
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.925107977869015*^9, 
  3.925107981116112*^9}, {3.9279874381500835`*^9, 3.927987438333395*^9}, {
  3.930222429905895*^9, 3.930222430077747*^9}, {3.941305823218879*^9, 
  3.941305835411392*^9}},ExpressionUUID->"77a7c2bb-3200-6743-993a-\
78434f829113"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdk1k2",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdBurstML1Dyn2stk1k2",
      FontWeight->"Bold"], "[", 
     RowBox[{
      RowBox[{"bursts", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", "parsBurstML1", ",", 
      "bA", ",", "bD", ",", "nTh", ",", "tTh", ",", "qMax", ",", "jMax"}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["stdk1k2",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{
  3.925018886758653*^9, {3.92510798500511*^9, 3.925107989389204*^9}, {
   3.925108232622053*^9, 3.925108248854376*^9}, {3.927979112559975*^9, 
   3.92797913106389*^9}, {3.927979799993065*^9, 3.9279798316571236`*^9}, {
   3.930222439372898*^9, 3.930222444356323*^9}, {3.930222642638727*^9, 
   3.9302226538553715`*^9}, {3.930223676400261*^9, 3.930223678243664*^9}, {
   3.93031147872284*^9, 3.930311488329073*^9}, {3.941305753035551*^9, 
   3.9413057815883846`*^9}, {3.941305838933508*^9, 3.941305839548155*^9}, 
   3.941393793715044*^9},
 CellLabel->
  "In[255]:=",ExpressionUUID->"ad306e33-a09d-0a4a-9f3b-e9163cfa083c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"correlation= \"\>", "\[InvisibleSpace]", 
   TagBox["mZ$9417791",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["correlation= ", 
   MatrixForm[$CellContext`mZ$9417791]],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.925112082336979*^9, 3.9255856086534176`*^9, 3.9302339893644733`*^9, 
  3.930312138020025*^9, 3.9305122280706825`*^9, 3.941313866134878*^9, 
  3.941397830528185*^9, 3.941486948686857*^9},
 CellLabel->
  "During evaluation of \
In[255]:=",ExpressionUUID->"095a396f-ea78-5447-ac30-8693dcb9871c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: \
(\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]taud2,\
\[Delta]k1,\[Delta]k2) = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "13.473499127676027`", ",", "8.468659398901627`", ",", 
     "0.004102164686586623`", ",", "0.007857671363409428`", ",", 
     "0.24154154873656591`", ",", "0.1536907335913681`", ",", 
     "0.13783195862292524`", ",", "0.1453629215826457`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]\
taud2,\[Delta]k1,\[Delta]k2) = ", {13.473499127676027`, 8.468659398901627, 
   0.004102164686586623, 0.007857671363409428, 0.24154154873656591`, 
   0.1536907335913681, 0.13783195862292524`, 0.1453629215826457}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.925112082336979*^9, 3.9255856086534176`*^9, 3.9302339893644733`*^9, 
  3.930312138020025*^9, 3.9305122280706825`*^9, 3.941313866134878*^9, 
  3.941397830528185*^9, 3.9414869487185497`*^9},
 CellLabel->
  "During evaluation of \
In[255]:=",ExpressionUUID->"76a0a362-e2bd-f04a-b414-e56520d7f0b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\
\[Delta]taud1/taud1,\[Delta]taud2/taud2,\[Delta]k1/k1,\[Delta]k2/k2) = \
(%)\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "3.218891477949443`", ",", "4.240994093990886`", ",", 
     "1.3946024558635604`", ",", "1.1169119865158816`", ",", 
     "6.656750157852974`", ",", "7.700768905107324`", ",", 
     "11.511460597742689`", ",", "12.002543798674607`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]\
taud1/taud1,\[Delta]taud2/taud2,\[Delta]k1/k1,\[Delta]k2/k2) = (%)", {
   3.218891477949443, 4.240994093990886, 1.3946024558635604`, 
   1.1169119865158816`, 6.656750157852974, 7.700768905107324, 
   11.511460597742689`, 12.002543798674607`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.925112082336979*^9, 3.9255856086534176`*^9, 3.9302339893644733`*^9, 
  3.930312138020025*^9, 3.9305122280706825`*^9, 3.941313866134878*^9, 
  3.941397830528185*^9, 3.941486948724491*^9},
 CellLabel->
  "During evaluation of \
In[255]:=",ExpressionUUID->"77b01a54-db61-d343-9bf8-b89c615d6312"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1737.5196956`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925112082363959*^9, 3.925585608681415*^9, 3.930228934786066*^9, 
  3.930311726952122*^9, 3.930511787471178*^9, 3.941313866165243*^9, 
  3.9413978305633926`*^9, 3.941486948731331*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"f9970e3d-3499-8444-b0ae-cdb4547627db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"13.473499127676027`", ",", "8.468659398901627`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.004102164686586623`", ",", "0.007857671363409428`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.24154154873656591`", ",", "0.1536907335913681`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.13783195862292524`", ",", "0.1453629215826457`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925112082363959*^9, 3.925585608681415*^9, 3.930228934786066*^9, 
  3.930311726952122*^9, 3.930511787471178*^9, 3.941313866165243*^9, 
  3.9413978305633926`*^9, 3.941486948737274*^9},
 CellLabel->
  "Out[256]=",ExpressionUUID->"1889e3a1-5ace-774e-9d2d-fd4feacf96f0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
find  standard deviations of  {{n01, n02}, {e1, e2}, {td1, td2}, {k,p1}}    \
in  burstML1: \
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.925107977869015*^9, 
  3.925107981116112*^9}, {3.9279874381500835`*^9, 3.927987438333395*^9}, {
  3.930222429905895*^9, 3.930222430077747*^9}, {3.9413058232188797`*^9, 
  3.941305835411392*^9}, {3.9413059862346745`*^9, 
  3.941305990051422*^9}},ExpressionUUID->"1ca13246-f7bb-b145-b1a6-\
359b1c55ada7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdkp",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdBurstML1Dyn2stkp",
      FontWeight->"Bold"], "[", 
     RowBox[{
      RowBox[{"bursts", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", "parsBurstML1", ",", 
      "bA", ",", "bD", ",", "nTh", ",", "tTh", ",", "qMax", ",", "jMax"}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["stdkp",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.927979837160076*^9, 3.927979846649067*^9}, 
   3.930222452479809*^9, {3.930222661155422*^9, 3.930222675381241*^9}, {
   3.930311501898731*^9, 3.9303115036816487`*^9}, {3.941306015132597*^9, 
   3.9413060155325756`*^9}, 3.941393803484068*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"8fce1317-d9e5-914a-9616-cafff8be2060"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: \
(\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]taud2,\
\[Delta]k,\[Delta]p1) = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "13.473349850293307`", ",", "8.468813646145907`", ",", 
     "0.004102118337056255`", ",", "0.007857983047611886`", ",", 
     "0.24154510207446309`", ",", "0.15369182546145277`", ",", 
     "0.2520347912853899`", ",", "0.02684573531520854`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]n01,\[Delta]n02,\[Delta]e1,\[Delta]e2,\[Delta]taud1,\[Delta]\
taud2,\[Delta]k,\[Delta]p1) = ", {13.473349850293307`, 8.468813646145907, 
   0.004102118337056255, 0.007857983047611886, 0.24154510207446309`, 
   0.15369182546145277`, 0.2520347912853899, 0.02684573531520854}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303127045457153`*^9, 3.930512674224767*^9, 
  3.941314213843109*^9, 3.9413986384934177`*^9, 3.941488688428364*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"7e47215c-51f2-6e4e-9f21-fa8856bce02f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\
\[Delta]taud1/taud1,\[Delta]taud2/taud2,\[Delta]k/k,\[Delta]p1/p1) = (%)\"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "3.2188558147790562`", ",", "4.241071338997586`", ",", 
     "1.3945866985320494`", ",", "1.1169562902040397`", ",", 
     "6.656848085860522`", ",", "7.7008236139306865`", ",", 
     "10.46462082392891`", ",", "5.338656265014845`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]n01/n01,\[Delta]n02/n02,\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]\
taud1/taud1,\[Delta]taud2/taud2,\[Delta]k/k,\[Delta]p1/p1) = (%)", {
   3.2188558147790562`, 4.241071338997586, 1.3945866985320494`, 
   1.1169562902040397`, 6.656848085860522, 7.7008236139306865`, 
   10.46462082392891, 5.338656265014845}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303127045457153`*^9, 3.930512674224767*^9, 
  3.941314213843109*^9, 3.9413986384934177`*^9, 3.941488688453306*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"52edc69f-1564-0c40-94ed-057625ac627e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1739.6382184`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.930234010235489*^9, 3.930312285360651*^9, 
  3.930312704554959*^9, 3.9305126742483063`*^9, 3.9413142138743*^9, 
  3.941398638522545*^9, 3.94148868845953*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"ba43dd51-ae24-df4a-af6d-f68e196af553"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"13.473349850293307`", ",", "8.468813646145907`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.004102118337056255`", ",", "0.007857983047611886`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.24154510207446309`", ",", "0.15369182546145277`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2520347912853899`", ",", "0.02684573531520854`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.930234010235489*^9, 3.930312285360651*^9, 
  3.930312704554959*^9, 3.9305126742483063`*^9, 3.9413142138743*^9, 
  3.941398638522545*^9, 3.9414886884671764`*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"c9513a7d-6076-1142-b1b4-e7919fc8002d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "correct the burstML1 isotropic diffusion time  ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["a", "2"], "/", "D"}]], "Input",
  CellChangeTimes->{{3.9251079656862087`*^9, 3.925107968780175*^9}, {
   3.925108027685259*^9, 3.925108078189184*^9}},ExpressionUUID->
  "227719c5-08ad-674f-acc5-7bc3693463a1"],
 "  to get ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox[
    SubscriptBox["a", "xy"], "2"], "/", "D"}]], "Input",
  CellChangeTimes->{{3.9251079656862087`*^9, 3.925107968780175*^9}, {
   3.925108027685259*^9, 3.925108078189184*^9}},ExpressionUUID->
  "eba1ddd4-581d-794f-9462-ef8d58423ce0"]
}], "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
   3.925033477987683*^9, 3.925033483884262*^9}, {3.925107606126749*^9, 
   3.9251076248156776`*^9}, {3.925107659815073*^9, 3.925107697058201*^9}, {
   3.930389544917061*^9, 3.930389555029682*^9}, {3.941305604484495*^9, 
   3.9413056599234734`*^9}, 
   3.941306082556605*^9},ExpressionUUID->"56b43ffa-1434-ee4e-a0a5-\
1607813bab7a"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"parsBurstML1", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "/", 
   RowBox[{"corrPhi", "[", 
    RowBox[{"az", "/", "axy"}], "]"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.925108090030218*^9, 3.925108119838186*^9}, {
  3.9251081852532177`*^9, 3.925108199509208*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"fed953e4-cd13-4f41-b085-d13c4fdefb8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.256091514305796`", ",", "1.2409112319365934`"}], "}"}]], "Output",
 CellChangeTimes->{3.925109766348205*^9, 3.9255836954275*^9, 
  3.927987412887205*^9, 3.9302289347079563`*^9, 3.930311726850968*^9, 
  3.930511787394625*^9, 3.941314213935383*^9, 3.9413986385772324`*^9, 
  3.9414886885176964`*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"72109d2f-fe24-df4a-8480-9016384f3382"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
 standard deviations of   {td1, td2} corrected for the elongated spot\
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.925107977869015*^9, 
  3.925107981116112*^9}, {3.9279874381500835`*^9, 3.927987438333395*^9}, {
  3.930222429905895*^9, 3.930222430077747*^9}, {3.9413058232188797`*^9, 
  3.941305835411392*^9}, {3.9413058669553967`*^9, 
  3.941305900731432*^9}},ExpressionUUID->"6db253b6-6ba3-f247-a007-\
2a4e0e0bf3b9"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"stdk1k2", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "/", 
   RowBox[{"corrPhi", "[", 
    RowBox[{"az", "/", "axy"}], "]"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.9413059106041927`*^9, 3.9413059369561043`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"99ebc169-2c30-7a4d-b502-ad1d63de736f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1501823754398586`", ",", "0.09555970628895741`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.94131421398629*^9, 3.941398638618473*^9, 
  3.941488688564453*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"2ad45758-e7d4-c149-ad35-0f0ef67e520b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["get diffusion coefficients from burstML1", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.925033477987683*^9, 3.925033483884262*^9}, {3.925107606126749*^9, 
  3.9251076248156776`*^9}, {3.925107659815073*^9, 3.925107697058201*^9}, {
  3.930389544917061*^9, 3.930389555029682*^9}, {3.941305604484495*^9, 
  3.9413056599234734`*^9}, {3.9413056929964085`*^9, 3.9413056975406246`*^9}, {
  3.9414047914128532`*^9, 
  3.941404795709572*^9}},ExpressionUUID->"70ac4bd1-6575-7342-aaba-\
e464fb3bcee8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"axy", "^", "2"}],
   FontWeight->"Bold"], 
  StyleBox["  ",
   FontWeight->"Bold"], 
  RowBox[{
   StyleBox[
    RowBox[{"corrPhi", "[", 
     RowBox[{"az", "/", "axy"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["/",
    FontWeight->"Bold"], 
   RowBox[{"parsBurstML1", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.925108149598011*^9, 3.925108153150139*^9}, {
  3.925108202431155*^9, 3.9251082029331894`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"75b8ea10-62d0-f541-9801-9a77999a10e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.11081110780070708`", ",", "0.20146485386375662`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.92510976640293*^9, 3.9255836954603176`*^9, 
  3.927987418478447*^9, 3.930228934739198*^9, 3.9303117268798637`*^9, 
  3.93051178742718*^9, 3.941314214041956*^9, 3.9413986386533833`*^9, 
  3.941488688610943*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"06772da3-5dbf-6040-a9b7-fdd5ddee3a52"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["find  burstML2  diffusion times   from 200 bursts ", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
   3.925033477987683*^9, 3.925033483884262*^9}, {3.925107606126749*^9, 
   3.9251076248156776`*^9}, {3.925107659815073*^9, 3.925107697058201*^9}, {
   3.9251083275251484`*^9, 3.925108329381048*^9}, {3.9251153147255993`*^9, 
   3.9251153216365795`*^9}, {3.930389621478451*^9, 3.9303896336311603`*^9}, 
   3.9413938231469326`*^9},ExpressionUUID->"ded49841-63a9-e24c-b00e-\
d7b2d1c419d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n01", ",", "n02"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"e1", ",", "e2"}], "}"}], ",", " ", "p1", ",", " ", 
     RowBox[{"and", " ", "initial", " ", "guess", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{"taud1", ",", "taud2"}], "}"}], " ", "from", " ", 
      "burstML1"}]}], " ", "*)"}],
   FontWeight->"Bold"], 
  StyleBox["\[IndentingNewLine]",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["parsBurstML2",
      FontWeight->"Bold"], 
     StyleBox["=",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["findMaxLDBurstML2Dyn2st",
       FontWeight->"Bold"], "[", 
      RowBox[{
       RowBox[{"bursts", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", "parsBurstML1", ",", 
       RowBox[{"az", "/", "axy"}], ",", "bA", ",", "bD", ",", "nTh", ",", 
       "tTh", ",", "qMax", ",", "jMax2"}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}]}]], "Input",
 CellChangeTimes->{{3.924964409223089*^9, 3.924964412792168*^9}, {
   3.924965008575491*^9, 3.924965010500595*^9}, 3.925018890870472*^9, {
   3.9250221287566566`*^9, 3.925022136741073*^9}, {3.925107382698206*^9, 
   3.925107384867131*^9}, {3.9251075286978645`*^9, 3.9251075563530445`*^9}, {
   3.925107631642018*^9, 3.925107653652489*^9}, {3.9251076844489384`*^9, 
   3.925107689480921*^9}, {3.925107735368817*^9, 3.9251079306149273`*^9}, {
   3.9251146391007385`*^9, 3.925114815096478*^9}, {3.925114903782427*^9, 
   3.925114906862555*^9}, 3.9302230819520645`*^9, 3.9302231139616737`*^9, {
   3.930223602320471*^9, 3.9302236028047543`*^9}, {3.930223716145735*^9, 
   3.930223718129736*^9}, 3.930313166979883*^9, {3.9413062066524715`*^9, 
   3.941306207011589*^9}, {3.9413062452445545`*^9, 3.941306248572422*^9}, 
   3.9413938258936996`*^9},
 CellLabel->
  "In[262]:=",ExpressionUUID->"096deac0-df22-624b-9035-365430ae4a6b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  LogLikelihood= \"\>", "\[InvisibleSpace]", 
   "69478.94838471527`", "\[InvisibleSpace]", "\<\"   steps=\"\>", 
   "\[InvisibleSpace]", "6"}],
  SequenceForm["  LogLikelihood= ", 69478.94838471527, "   steps=", 6],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303260159023495`*^9, 3.9305280229652195`*^9, 
  3.941316084286106*^9, 3.941403528363472*^9, 3.9415013455072746`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"ad6875f0-ac9e-b748-b39f-afb3cdad100f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (\\!\\(\\*SubscriptBox[\\(\[Tau]\\), \
\\(d1\\)]\\),\\!\\(\\*SubscriptBox[\\(\[Tau]\\), \\(d2\\)]\\)) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2.437275988430168`", ",", "1.355185562249536`"}], "}"}]}],
  SequenceForm[
  "  (\!\(\*SubscriptBox[\(\[Tau]\), \(d1\)]\),\!\(\*SubscriptBox[\(\[Tau]\), \
\(d2\)]\)) = ", {2.437275988430168, 1.355185562249536}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9303260159023495`*^9, 3.9305280229652195`*^9, 
  3.941316084286106*^9, 3.941403528363472*^9, 3.9415013455293865`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"4cd2fe50-3841-4c4b-8b38-5523d403e9bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12656.8607173`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.9249644038658104`*^9, 3.924964413462223*^9}, 
   3.9249651009442387`*^9, 3.9249671985105057`*^9, 3.9251148301778793`*^9, 
   3.925114875540983*^9, 3.9251150258836174`*^9, 3.925116492372999*^9, 
   3.925122515453785*^9, 3.9255908848246326`*^9, 3.930234447822668*^9, 
   3.930312931100275*^9, 3.9303130929907684`*^9, 3.930313171039259*^9, 
   3.930512787423352*^9, 3.9413160843139343`*^9, 3.9414035283951836`*^9, 
   3.9415013455347824`*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"d01ea07e-1433-6a4c-8fe0-376289d5b3c2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["get diffusion coefficients from burstML2", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.925033477987683*^9, 3.925033483884262*^9}, {3.925107606126749*^9, 
  3.9251076248156776`*^9}, {3.925107659815073*^9, 3.925107697058201*^9}, {
  3.930389544917061*^9, 3.930389555029682*^9}, {3.941305604484495*^9, 
  3.9413056599234734`*^9}, {3.9413056929964085`*^9, 3.941305697540624*^9}, {
  3.9414047914128532`*^9, 
  3.94140482276519*^9}},ExpressionUUID->"e07d44e9-b0bc-414e-920c-\
96dccd1df7bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"axy", "^", "2"}],
   FontWeight->"Bold"], 
  StyleBox[" ",
   FontWeight->"Bold"], 
  StyleBox["/",
   FontWeight->"Bold"], "parsBurstML2"}]], "Input",
 CellChangeTimes->{{3.925108149598011*^9, 3.925108153150139*^9}, {
   3.925108202431155*^9, 3.9251082029331894`*^9}, {3.9251083448212013`*^9, 
   3.925108351734041*^9}, 3.92513380998931*^9},
 CellLabel->
  "In[263]:=",ExpressionUUID->"12daffa7-a7ee-ee4b-896a-09154e11ac0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.10257352929531104`", ",", "0.18447658163138433`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.925133801500487*^9, 3.925133810860564*^9}, 
   3.925590884898936*^9, 3.930234448135111*^9, 3.9303262099731827`*^9, 
   3.930528023034004*^9, 3.9413160843906975`*^9, 3.941403528504038*^9, 
   3.941501345594385*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"9bf8b815-bf34-8045-8115-81401ee21380"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["find  standard deviations of diffusion times in  burstML2", "Text",
 CellChangeTimes->{{3.9249645151064057`*^9, 3.924964526647745*^9}, {
   3.924965057096119*^9, 3.9249650640816536`*^9}, {3.925107977869015*^9, 
   3.925107981116112*^9}, 3.9251083317099*^9, {3.9251994260654087`*^9, 
   3.9251994306827526`*^9}},ExpressionUUID->"5ee80725-9f5d-d94a-997f-\
aa351f71fcf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "set", " ", "ML", " ", "parameters", " ", "to", " ", "those", " ", "from",
      " ", "burstML1", " ", "and", " ", "taud", " ", "from", " ", 
     "burstML2"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"parsML", "=", "parsBurstML1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"parsML", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "=", "parsBurstML2"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9251339379833736`*^9, 3.92513404256362*^9}, {
  3.930223732158343*^9, 3.930223737469843*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"1564ebe6-50e4-134c-91c5-d963341a761f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["std",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdDBurstML2Dyn2st",
      FontWeight->"Bold"], "[", 
     RowBox[{
      RowBox[{"bursts", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "200"}], "]"}], "]"}], ",", "parsML", ",", 
      RowBox[{"az", "/", "axy"}], ",", "bA", ",", "bD", ",", "nTh", ",", 
      "tTh", ",", "qMax", ",", "jMax2"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", "std"}], "Input",
 CellChangeTimes->{
  3.925018886758653*^9, {3.92510798500511*^9, 3.925107989389204*^9}, {
   3.925108232622053*^9, 3.925108248854376*^9}, {3.9251083612061462`*^9, 
   3.925108362557211*^9}, {3.925114936892624*^9, 3.925114939348861*^9}, {
   3.925115040093947*^9, 3.925115046830679*^9}, 3.9251164116867275`*^9, {
   3.925133844992121*^9, 3.925133899321409*^9}, 3.925134057901518*^9, 
   3.930223263188162*^9, {3.930223331968555*^9, 3.930223359853935*^9}, {
   3.930223746968052*^9, 3.930223748827076*^9}, {3.930326247500786*^9, 
   3.930326249404751*^9}, {3.93032759705945*^9, 3.930327600197003*^9}, {
   3.941306275220623*^9, 3.941306278779543*^9}, 3.9413938426907845`*^9},
 CellLabel->
  "In[266]:=",ExpressionUUID->"72a45620-68c4-5b49-9178-50c13e30ac93"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: (\[Delta]taud1,\[Delta]taud2) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.1585937121945623`", ",", "0.10819378539907212`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]taud1,\[Delta]taud2) = ", {0.1585937121945623, 
   0.10819378539907212`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.930331083085614*^9, 3.9305319310890007`*^9, 
  3.9413183420362606`*^9, 3.941410464145088*^9, 3.9415165528210297`*^9},
 CellLabel->
  "During evaluation of \
In[266]:=",ExpressionUUID->"02bd77ab-ff69-f84b-99cb-996c496a4ae9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]taud1/taud1,\[Delta]taud2/taud2) = (%)\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"6.507006713536426`", ",", "7.983687873672163`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]taud1/taud1,\[Delta]taud2/taud2) = (%)", {6.507006713536426, 
   7.983687873672163}],
  Editable->False]], "Print",
 CellChangeTimes->{3.930331083085614*^9, 3.9305319310890007`*^9, 
  3.9413183420362606`*^9, 3.941410464145088*^9, 3.9415165528467464`*^9},
 CellLabel->
  "During evaluation of \
In[266]:=",ExpressionUUID->"8d98e7d6-a90a-7b48-9df8-6064066b2a62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15207.122646`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.9251413190356865`*^9, 3.925597674970066*^9, 3.930326261473223*^9, 
  3.9303276036218643`*^9, 3.930528023100448*^9, 3.941318342063116*^9, 
  3.941410464174055*^9, 3.9415165528534355`*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"07a3df85-76fc-5745-ac13-c3871c70af52"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1585937121945623`", ",", "0.10819378539907212`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.9251413190356865`*^9, 3.925597674970066*^9, 3.930326261473223*^9, 
  3.9303276036218643`*^9, 3.930528023100448*^9, 3.941318342063116*^9, 
  3.941410464174055*^9, 3.941516552861639*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"f6617e6e-7ecd-3c45-99ba-263300384d7e"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Example 4: ColorML equal count rates and diffusion coefficients\
\>", "Subsection",
 CellChangeTimes->{{3.924962181065222*^9, 3.9249622133327637`*^9}, {
   3.924962481168434*^9, 3.9249624864759674`*^9}, 3.925022052574007*^9, 
   3.9412974915064926`*^9, 3.941304910114874*^9, {3.941309689622072*^9, 
   3.941309701135046*^9}, 
   3.941394142169876*^9},ExpressionUUID->"a8b87097-bc9a-664e-8378-\
100ffb848080"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{
    StyleBox[
     RowBox[{"(", "*"}]], 
    RowBox[{
    "equal", " ", "count", " ", "rates", "  ", "and", " ", "diffusion", " ", 
     "coefficients", " ", "of", " ", "the", " ", "two", " ", "states"}], 
    StyleBox[
     RowBox[{"*", ")"}]]}],
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox[
    RowBox[{"n01", ":=", 
     StyleBox[
      RowBox[{"2", "00."}]]}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[" ",
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the",
       " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"n02", ":=", "200."}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d1", ":=", "0.2"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d2", ":=", "0.2"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.9413939110029144`*^9, 3.9413939476984425`*^9}, {
  3.941394166034897*^9, 3.941394173282099*^9}, {3.941477332194128*^9, 
  3.941477333588505*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"3a508ac5-e3a3-9a4a-8a3a-67b2bba08e29"],

Cell[CellGroupData[{

Cell["Get  generated bursts", "Text",
 CellChangeTimes->{{3.9412906031665287`*^9, 3.9412906224845104`*^9}, {
  3.941290784963421*^9, 3.941290788954603*^9}, {3.9413063213955803`*^9, 
  3.941306327323492*^9}},ExpressionUUID->"847f80a9-c0d0-0642-8805-\
fc5f3fb9601b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bursts", "=", 
    RowBox[{"Get", "[", "\"\<burstsSampleEqual\>\"", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"get", " ", "bursts"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9412904994034233`*^9, 3.941290527420414*^9}, {
  3.941291144956148*^9, 3.9412911452593822`*^9}, {3.9413096351011257`*^9, 
  3.941309635337345*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"81faa253-e6a6-b74d-a101-657c9b28d2e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Find colorML parameters {{e1,e2},{k1,k2}}   starting search from \
{e1,e2}={0.4,0.6} and {k1,k2}={1.2,1.5}\
\>", "Text",
 CellChangeTimes->{{3.9412906031665287`*^9, 3.9412906989309864`*^9}, {
  3.941290745090996*^9, 
  3.941290758715475*^9}},ExpressionUUID->"3b82e750-581a-b94d-916b-\
18c2a020fca6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["parsColorML",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["findMaxLColorMLDyn2st",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.4", ",", "0.6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.2", ",", "1.5"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["parsColorML",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.924964409223089*^9, 3.924964412792168*^9}, {
   3.924965008575491*^9, 3.924965010500595*^9}, 3.925018890870472*^9, {
   3.9250335222434254`*^9, 3.925033523885378*^9}, {3.927975077831654*^9, 
   3.9279751283035336`*^9}, 3.927976358200104*^9, 3.92797639195198*^9, {
   3.92797765892168*^9, 3.9279776849135284`*^9}, 3.92797772361846*^9, 
   3.9279785176206684`*^9},
 CellLabel->
  "In[214]:=",ExpressionUUID->"170c55e7-41ff-7c47-a110-24e4f78f1d8c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  LogLikelihood= \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "41201.760337633415`"}], 
   "\[InvisibleSpace]", "\<\"   steps=\"\>", "\[InvisibleSpace]", "14"}],
  SequenceForm["  LogLikelihood= ", -41201.760337633415`, "   steps=", 14],
  Editable->False]], "Print",
 CellChangeTimes->{3.92797769791754*^9, 3.9279777539333997`*^9, 
  3.927978578709687*^9, 3.9302226442009354`*^9, 3.930511120917692*^9, 
  3.941296818542818*^9, 3.94130930151552*^9, 3.94131303489106*^9, 
  3.9414104809490814`*^9, 3.9414774031915836`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"9608168f-8226-104d-9ce0-54e91ea50405"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (e,k) = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3172912745326643`", ",", "0.7015577448231792`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1799576062837889`", ",", "1.0349567450378259`"}], "}"}]}], 
    "}"}]}],
  SequenceForm[
  "  (e,k) = ", {{0.3172912745326643, 0.7015577448231792}, {
   1.1799576062837889`, 1.0349567450378259`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.92797769791754*^9, 3.9279777539333997`*^9, 
  3.927978578709687*^9, 3.9302226442009354`*^9, 3.930511120917692*^9, 
  3.941296818542818*^9, 3.94130930151552*^9, 3.94131303489106*^9, 
  3.9414104809490814`*^9, 3.941477403193615*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"a72f56c3-bf5c-d544-9192-425022a6dedb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"55.1393002`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.9249644038658104`*^9, 3.924964413462223*^9}, 
   3.9249651009442387`*^9, 3.9249671985105057`*^9, 3.925033413143204*^9, 
   3.9250335376202335`*^9, 3.92558234075972*^9, 3.927977656826383*^9, 
   3.927977697924362*^9, 3.927977753942877*^9, 3.927978578744467*^9, 
   3.9302226442165585`*^9, 3.930511120940607*^9, 3.9412968185478077`*^9, 
   3.941309301530031*^9, 3.941313034921831*^9, 3.941410480978096*^9, 
   3.9414774032143555`*^9},
 CellLabel->
  "Out[214]=",ExpressionUUID->"a663f7c0-dc64-6b4f-8906-2d8a53d3bc6b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.3172912745326643`", ",", "0.7015577448231792`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1799576062837889`", ",", "1.0349567450378259`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9249644038658104`*^9, 3.924964413462223*^9}, 
   3.9249651009442387`*^9, 3.9249671985105057`*^9, 3.925033413143204*^9, 
   3.9250335376202335`*^9, 3.92558234075972*^9, 3.927977656826383*^9, 
   3.927977697924362*^9, 3.927977753942877*^9, 3.927978578744467*^9, 
   3.9302226442165585`*^9, 3.930511120940607*^9, 3.9412968185478077`*^9, 
   3.941309301530031*^9, 3.941313034921831*^9, 3.941410480978096*^9, 
   3.9414774032205753`*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"2055d1b7-0cc7-d041-9a05-3291f647c1b0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Find  standard deviations  of  the colorML parameters {{e1,e2},{k1,k2}}  from \
the ML values parsColorML. \
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
  3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
  3.941290939675474*^9, 3.941291045099554*^9}, {3.9412911800434017`*^9, 
  3.941291345474531*^9}},ExpressionUUID->"5c96e44c-e7a6-b546-b6cb-\
89fa01cadaf7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdk1k2",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdColorMLDyn2stk1k2",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      StyleBox["parsColorML",
       FontWeight->"Bold"]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["stdk1k2",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{
  3.925018886758653*^9, 3.925033530810819*^9, {3.927976381679997*^9, 
   3.927976469703121*^9}, 3.927977747439543*^9, {3.927977821946455*^9, 
   3.927977831587202*^9}, {3.941291171644497*^9, 3.9412911722755737`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"fd7ac5a6-5f25-fe46-bd72-0960ecea00d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: (\[Delta]e1,\[Delta]e2,\[Delta]k1,\[Delta]k2) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.003355999796641861`", ",", "0.0032564015085254795`", ",", 
     "0.07545157069885124`", ",", "0.06580933072365752`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]e1,\[Delta]e2,\[Delta]k1,\[Delta]k2) = ", {
   0.003355999796641861, 0.0032564015085254795`, 0.07545157069885124, 
   0.06580933072365752}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.9250334322454433`*^9, 3.925033541754603*^9, 3.925582344437792*^9, 
  3.927977895327076*^9, 3.927978648673149*^9, 3.9302227663218384`*^9, 
  3.930511155985432*^9, 3.941296852158407*^9, 3.94131305775741*^9, 
  3.941410501739229*^9, 3.9414774712951393`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"f3d4ccb7-b2d6-6a4e-bbf1-0c678ecb3954"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k1/k1,\[Delta]k2/k2) = \
(%)\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.0577031472374667`", ",", "0.4641672809621999`", ",", 
     "6.3944306386126675`", ",", "6.358655184304568`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k1/k1,\[Delta]k2/k2) = (%)", {
   1.0577031472374667`, 0.4641672809621999, 6.3944306386126675`, 
   6.358655184304568}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.9250334322454433`*^9, 3.925033541754603*^9, 3.925582344437792*^9, 
  3.927977895327076*^9, 3.927978648673149*^9, 3.9302227663218384`*^9, 
  3.930511155985432*^9, 3.941296852158407*^9, 3.94131305775741*^9, 
  3.941410501739229*^9, 3.9414774713052025`*^9},
 CellLabel->
  "During evaluation of \
In[216]:=",ExpressionUUID->"fbd71f04-12d8-ba4c-a3df-4624174f1df3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"68.0389555`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925033432264284*^9, 3.925033541765555*^9, 3.92558234446303*^9, 
  3.927977895359616*^9, 3.927978648709912*^9, 3.930222766337459*^9, 
  3.930511156004915*^9, 3.9412968521657143`*^9, 3.941313057778055*^9, 
  3.9414105017697754`*^9, 3.941477471319969*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"d43b1bac-5961-7e4d-84bc-8b0cbb8205a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.003355999796641861`", ",", "0.0032564015085254795`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.07545157069885124`", ",", "0.06580933072365752`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925033432264284*^9, 3.925033541765555*^9, 3.92558234446303*^9, 
  3.927977895359616*^9, 3.927978648709912*^9, 3.930222766337459*^9, 
  3.930511156004915*^9, 3.9412968521657143`*^9, 3.941313057778055*^9, 
  3.9414105017697754`*^9, 3.941477471326662*^9},
 CellLabel->
  "Out[217]=",ExpressionUUID->"7001e47e-5278-104d-8fc8-bd593bc84bb6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Instead of the relaxation rates k1 and k2,  the relaxation rate, k=k1+k2,and  \
the population of the first state, p1=k2/(k1+k2), can be estimated. The \
colorML k and p1 are\
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
  3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
  3.941290939675474*^9, 3.9412911106524086`*^9}, {3.9412913793395214`*^9, 
  3.941291457348461*^9}, {3.9412917338895226`*^9, 
  3.941291739316593*^9}},ExpressionUUID->"b3848dfa-9604-7342-a088-\
f93428462fe8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "2", "]"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["//",
    FontWeight->"Bold"], "Total"}], 
  RowBox[{"(*", 
   RowBox[{"k", "=", 
    RowBox[{"k1", "+", "k2"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parsColorML", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
  RowBox[{"Total", "[", 
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "2", "]"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["]",
    FontWeight->"Bold"]}], 
  StyleBox[
   RowBox[{
    StyleBox[
     RowBox[{"(", "*"}]], 
    RowBox[{"p1", "=", 
     RowBox[{"k2", "/", 
      RowBox[{"(", 
       RowBox[{"k1", "+", "k2"}]}]}]}], 
    StyleBox[
     RowBox[{"*", ")"}]]}],
   FontWeight->"Bold"]}]}], "Input",
 CellChangeTimes->{{3.941291655428713*^9, 3.9412917101806145`*^9}, {
  3.941291788252449*^9, 3.9412918114207077`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"1445c2c7-d575-1d40-a150-a0f25e6e5e89"],

Cell[BoxData["2.2149143513216147`"], "Output",
 CellChangeTimes->{3.9412968521931343`*^9, 3.941313057817877*^9, 
  3.9414105018136425`*^9, 3.941477471357975*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"6f687e9d-7eba-4240-86bd-54980c9566b6"],

Cell[BoxData["0.46726716291321996`"], "Output",
 CellChangeTimes->{3.9412968521931343`*^9, 3.941313057817877*^9, 
  3.9414105018136425`*^9, 3.9414774713640575`*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"090e66b5-20d0-2c46-a0f6-07160874f605"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The standard deviations of k and p1 ", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
   3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
   3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
   3.941290939675474*^9, 3.9412911106524086`*^9}, {3.9412913793395214`*^9, 
   3.941291457348461*^9}, 
   3.9412917487633343`*^9},ExpressionUUID->"d42d2c26-bce1-ed4b-b8d8-\
d444381a6bca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdkp",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdColorMLDyn2stkp",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      StyleBox["parsColorML",
       FontWeight->"Bold"]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", "stdkp"}], "Input",
 CellChangeTimes->{{3.927976475263088*^9, 3.927976497784153*^9}, 
   3.927977751591348*^9, {3.927977844032476*^9, 3.927977857688723*^9}, {
   3.941291473100567*^9, 3.941291473500084*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"259d7f11-66a5-db48-bb38-6a48ec16c591"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: (\[Delta]e1,\[Delta]e2,\[Delta]k,\[Delta]p1) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0033559039982408393`", ",", "0.003256401380515771`", ",", 
     "0.1289635093610646`", ",", "0.012988111073627977`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]e1,\[Delta]e2,\[Delta]k,\[Delta]p1) = ", {
   0.0033559039982408393`, 0.003256401380515771, 0.1289635093610646, 
   0.012988111073627977`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.927977992206154*^9, 3.927978718753287*^9, 
  3.930222839714319*^9, 3.930511193762436*^9, 3.9412968857185383`*^9, 
  3.941313080226574*^9, 3.9414105231004467`*^9, 3.941477538777399*^9},
 CellLabel->
  "During evaluation of \
In[220]:=",ExpressionUUID->"52a394c7-0b8a-cd41-8ff8-72affeddbc1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k/k,\[Delta]p1/p1) = (%)\
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.0576729546640458`", ",", "0.4641672627157036`", ",", 
     "5.822505474494466`", ",", "2.7795899443591137`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k/k,\[Delta]p1/p1) = (%)", {
   1.0576729546640458`, 0.4641672627157036, 5.822505474494466, 
   2.7795899443591137`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.927977992206154*^9, 3.927978718753287*^9, 
  3.930222839714319*^9, 3.930511193762436*^9, 3.9412968857185383`*^9, 
  3.941313080226574*^9, 3.9414105231004467`*^9, 3.94147753878586*^9},
 CellLabel->
  "During evaluation of \
In[220]:=",ExpressionUUID->"6ecb1964-6556-994d-a73e-8180186bc067"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"67.3989613`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.927977992240513*^9, 3.9279787187897053`*^9, 
  3.9302228397299423`*^9, 3.930511193787145*^9, 3.9412968857370872`*^9, 
  3.9413130802565823`*^9, 3.9414105231242695`*^9, 3.9414775387985*^9},
 CellLabel->
  "Out[220]=",ExpressionUUID->"31de2889-a376-ce4d-a60d-575be9bc0275"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.0033559039982408393`", ",", "0.003256401380515771`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.1289635093610646`", ",", "0.012988111073627977`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.927977992240513*^9, 3.9279787187897053`*^9, 
  3.9302228397299423`*^9, 3.930511193787145*^9, 3.9412968857370872`*^9, 
  3.9413130802565823`*^9, 3.9414105231242695`*^9, 3.941477538804983*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"512523f7-8dee-d441-9a28-6270e4a8301c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FRET  efficiencies  in  colorML  are  influenced  by  background  noise.  \
Uncorrected (apparent) FRET efficiencies are\
\>", "Text",
 CellChangeTimes->{{3.9412918558315144`*^9, 
  3.941291903605404*^9}},ExpressionUUID->"1c813730-0004-a045-8543-\
30008efd73b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"parsColorML", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.92503607154747*^9, 3.9250360995895424`*^9}, {
  3.941291908020975*^9, 3.941291908416668*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"0e0d7719-6f06-7b40-9ce9-31df47e46387"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3172912745326643`", ",", "0.7015577448231792`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9250361002364006`*^9, 3.925582344492239*^9, 
  3.9279780350294933`*^9, 3.927978718860281*^9, 3.9302228397923775`*^9, 
  3.930511193815227*^9, 3.941296885776642*^9, 3.941309340917055*^9, 
  3.9413130802977524`*^9, 3.9414105231583443`*^9, 3.9414775388307476`*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"c91c98f3-11ae-594d-a8dc-4e33e9e4125e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Corrected  FRET efficiencies  depend on  the  mean  photon  count  rates nAv \
defined as the total number of photons in all bursts  divided by the total \
duration of all bursts\
\>", "Text",
 CellChangeTimes->{{3.9412918558315153`*^9, 3.941291903605404*^9}, {
  3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
  3.9412921323343143`*^9}, {3.941292167078026*^9, 
  3.941292167710148*^9}},ExpressionUUID->"938c64d8-e3c1-2c4b-8c84-\
84f7b5b28335"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nAv", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "bursts"}], "]"}], "]"}], "/", 
   RowBox[{"Total", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"Last", ",", 
      RowBox[{"bursts", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9279770231877975`*^9, 3.927977127335327*^9}, {
   3.927977230504328*^9, 3.927977238744379*^9}, 3.927978338433634*^9, {
   3.9412922356163483`*^9, 3.941292235997347*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"60110aff-5a25-014c-aa7f-e07a7ae3c010"],

Cell[BoxData["53.82446965938691`"], "Output",
 CellChangeTimes->{3.927978339138266*^9, 3.927978719046772*^9, 
  3.930222839995516*^9, 3.9305111939258747`*^9, 3.9412968858194923`*^9, 
  3.9413093469498825`*^9, 3.9413130803282547`*^9, 3.941410523200247*^9, 
  3.941477538857729*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"662f1dc1-2131-db4f-a319-6ffbb043d361"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
With the calculated nAv, the BN corrected  FRET efficiencies  are\
\>", "Text",
 CellChangeTimes->{{3.9412918558315153`*^9, 3.941291903605404*^9}, {
   3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
   3.9412921323343143`*^9}, {3.941292167078026*^9, 3.941292167710148*^9}, {
   3.941292207517117*^9, 3.941292218777252*^9}, 3.941295757620167*^9, {
   3.941547614004116*^9, 
   3.941547640116947*^9}},ExpressionUUID->"a992e289-8789-694a-8b71-\
950feecc6554"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["Map",
   FontWeight->"Bold"], 
  StyleBox["[",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["eBNCorr",
      FontWeight->"Bold"], "[", 
     RowBox[{"#", ",", " ", "bA", ",", " ", "bD", ",", " ", "nAv"}], "]"}], 
    "&"}], " ", ",", 
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "1", "]"}], "]"}],
    FontWeight->"Bold"]}], 
  StyleBox["]",
   FontWeight->"Bold"]}]], "Input",
 CellChangeTimes->{{3.925033502840843*^9, 3.925033507818064*^9}, {
  3.9250336065484066`*^9, 3.925033608540818*^9}, {3.92503603990686*^9, 
  3.925036061744723*^9}, {3.925036123191429*^9, 3.925036136556793*^9}, {
  3.927976608024113*^9, 3.927976612807223*^9}, {3.9279769271193132`*^9, 
  3.927976997064295*^9}, {3.9279771490553856`*^9, 3.927977161904291*^9}, {
  3.927977248871412*^9, 3.927977260927305*^9}, {3.941292229462612*^9, 
  3.941292229662548*^9}, {3.9412957135411415`*^9, 3.9412957471178055`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"31967f9b-810b-e642-9f67-4bcc2b1af2d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.29666880304547927`", ",", "0.7036172495296923`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9279783645918865`*^9, 3.9279787191288624`*^9, 
  3.930222840058012*^9, 3.930511193981088*^9, 3.9412968858614025`*^9, 
  3.941309353032091*^9, 3.9413130803576202`*^9, 3.9414105232340336`*^9, 
  3.9414775388920116`*^9},
 CellLabel->
  "Out[224]=",ExpressionUUID->"efb1de19-2b23-3344-bda9-80a12034132e"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Example 5: ColorML unequal count rates and diffusion coefficients\
\>", "Subsection",
 CellChangeTimes->{{3.924962181065222*^9, 3.9249622133327637`*^9}, {
   3.924962481168434*^9, 3.9249624864759674`*^9}, 3.925022052574007*^9, 
   3.9412974915064926`*^9, 3.941304910114874*^9, {3.9413097098707047`*^9, 
   3.9413097359171352`*^9}},ExpressionUUID->"37c917de-c233-be47-9804-\
9293b449f6e3"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "unequal", " ", "count", " ", "rates", "  ", "and", " ", "diffusion", " ",
      "coefficients", " ", "of", " ", "the", " ", "two", " ", "states"}], 
    "*)"}],
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14,
   FontWeight->"Bold",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox[
    RowBox[{"n01", ":=", "400."}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[" ",
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "total", " ", "photon", " ", "count", " ", "rate", " ", "at", " ", "the",
       " ", "center", " ", "of", " ", "the", " ", "spot"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"n02", ":=", "200."}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d1", ":=", "0.1"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"diffusion", " ", "coefficient"}], " ", "*)"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"d2", ":=", "0.2"}],
    FontSize->14,
    FontWeight->"Bold",
    FontColor->GrayLevel[0]]}]}]], "Input",
 CellChangeTimes->{{3.941393911002915*^9, 3.941393947698443*^9}, {
  3.941477451583814*^9, 3.941477454008684*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"5738b43f-1e90-9447-827e-090612baee15"],

Cell[CellGroupData[{

Cell["Get  generated bursts", "Text",
 CellChangeTimes->{{3.9412906031665287`*^9, 3.9412906224845104`*^9}, {
  3.941290784963421*^9, 3.941290788954603*^9}, {3.9413063213955803`*^9, 
  3.941306327323492*^9}},ExpressionUUID->"6d9c4882-97c4-744f-8a7b-\
5cc7aa542fab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bursts", "=", 
    RowBox[{"Get", "[", "\"\<burstsSampleUnEqual\>\"", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"get", " ", "bursts"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9412904994034233`*^9, 3.941290527420414*^9}, {
  3.941291144956148*^9, 3.9412911452593822`*^9}, {3.9413096351011257`*^9, 
  3.941309635337345*^9}, {3.941309741910534*^9, 3.9413097421581097`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"77724f00-acc4-2944-88eb-06390b8323ec"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Find colorML parameters {{e1,e2},{k1,k2}}   starting search from \
{e1,e2}={0.4,0.6} and {k1,k2}={1.2,1.5}\
\>", "Text",
 CellChangeTimes->{{3.9412906031665287`*^9, 3.9412906989309864`*^9}, {
  3.941290745090996*^9, 
  3.941290758715475*^9}},ExpressionUUID->"801747da-4864-4044-a9e3-\
1045129fc554"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["parsColorML",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["findMaxLColorMLDyn2st",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.4", ",", "0.6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.2", ",", "1.5"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["parsColorML",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.924964409223089*^9, 3.924964412792168*^9}, {
   3.924965008575491*^9, 3.924965010500595*^9}, 3.925018890870472*^9, {
   3.9250335222434254`*^9, 3.925033523885378*^9}, {3.927975077831654*^9, 
   3.9279751283035336`*^9}, 3.927976358200104*^9, 3.92797639195198*^9, {
   3.92797765892168*^9, 3.9279776849135284`*^9}, 3.92797772361846*^9, 
   3.9279785176206684`*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"53efb013-b258-a940-b66d-632b03a76515"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  LogLikelihood= \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "70640.87248673588`"}], 
   "\[InvisibleSpace]", "\<\"   steps=\"\>", "\[InvisibleSpace]", "16"}],
  SequenceForm["  LogLikelihood= ", -70640.87248673588, "   steps=", 16],
  Editable->False]], "Print",
 CellChangeTimes->{3.92797769791754*^9, 3.9279777539333997`*^9, 
  3.927978578709687*^9, 3.9302226442009354`*^9, 3.930511120917692*^9, 
  3.941296818542818*^9, 3.94130930151552*^9, 3.941313087555397*^9, 
  3.9414105575482616`*^9, 3.9414776466184235`*^9},
 CellLabel->
  "During evaluation of \
In[227]:=",ExpressionUUID->"04491372-5319-d744-b13a-7b50e76beea8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  (e,k) = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3141238507326677`", ",", "0.6988931156612518`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.9230354357268732`", ",", "1.2109754664916705`"}], "}"}]}], 
    "}"}]}],
  SequenceForm[
  "  (e,k) = ", {{0.3141238507326677, 0.6988931156612518}, {
   0.9230354357268732, 1.2109754664916705`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.92797769791754*^9, 3.9279777539333997`*^9, 
  3.927978578709687*^9, 3.9302226442009354`*^9, 3.930511120917692*^9, 
  3.941296818542818*^9, 3.94130930151552*^9, 3.941313087555397*^9, 
  3.9414105575482616`*^9, 3.941477646630329*^9},
 CellLabel->
  "During evaluation of \
In[227]:=",ExpressionUUID->"6c9e99c5-d2c6-1347-8d5e-8329b270e8bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"107.470103`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.9249644038658104`*^9, 3.924964413462223*^9}, 
   3.9249651009442387`*^9, 3.9249671985105057`*^9, 3.925033413143204*^9, 
   3.9250335376202335`*^9, 3.92558234075972*^9, 3.927977656826383*^9, 
   3.927977697924362*^9, 3.927977753942877*^9, 3.927978578744467*^9, 
   3.9302226442165585`*^9, 3.930511120940607*^9, 3.9412968185478077`*^9, 
   3.941309301530031*^9, 3.941313087572708*^9, 3.941410557582489*^9, 
   3.941477646641981*^9},
 CellLabel->
  "Out[227]=",ExpressionUUID->"08617a0e-929a-6c4c-9c20-e78c73d52c80"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.3141238507326677`", ",", "0.6988931156612518`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9230354357268732`", ",", "1.2109754664916705`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9249644038658104`*^9, 3.924964413462223*^9}, 
   3.9249651009442387`*^9, 3.9249671985105057`*^9, 3.925033413143204*^9, 
   3.9250335376202335`*^9, 3.92558234075972*^9, 3.927977656826383*^9, 
   3.927977697924362*^9, 3.927977753942877*^9, 3.927978578744467*^9, 
   3.9302226442165585`*^9, 3.930511120940607*^9, 3.9412968185478077`*^9, 
   3.941309301530031*^9, 3.941313087572708*^9, 3.941410557582489*^9, 
   3.941477646647602*^9},
 CellLabel->
  "Out[228]=",ExpressionUUID->"d69c5269-ef72-a948-8ba8-618aa2ad1abe"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Find  standard deviations  of  the colorML parameters {{e1,e2},{k1,k2}}  from \
the ML values parsColorML. \
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
  3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
  3.941290939675474*^9, 3.941291045099554*^9}, {3.9412911800434017`*^9, 
  3.941291345474531*^9}},ExpressionUUID->"a6db54c0-d286-7d44-9f36-\
80228981ff85"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdk1k2",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdColorMLDyn2stk1k2",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      StyleBox["parsColorML",
       FontWeight->"Bold"]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 StyleBox["stdk1k2",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{
  3.925018886758653*^9, 3.925033530810819*^9, {3.927976381679997*^9, 
   3.927976469703121*^9}, 3.927977747439543*^9, {3.927977821946455*^9, 
   3.927977831587202*^9}, {3.941291171644497*^9, 3.9412911722755737`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"7f87db89-69fb-3b4f-b2ca-2aadba62c476"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: (\[Delta]e1,\[Delta]e2,\[Delta]k1,\[Delta]k2) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.001951174135748626`", ",", "0.003254449005214555`", ",", 
     "0.04917181242888803`", ",", "0.0664890835959463`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]e1,\[Delta]e2,\[Delta]k1,\[Delta]k2) = ", {
   0.001951174135748626, 0.003254449005214555, 0.04917181242888803, 
   0.0664890835959463}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.9250334322454433`*^9, 3.925033541754603*^9, 3.925582344437792*^9, 
  3.927977895327076*^9, 3.927978648673149*^9, 3.9302227663218384`*^9, 
  3.930511155985432*^9, 3.941296852158407*^9, 3.9413130975507584`*^9, 
  3.941410590408684*^9, 3.9414777641153545`*^9},
 CellLabel->
  "During evaluation of \
In[229]:=",ExpressionUUID->"ae558ebf-9641-3a44-a8e1-45372117300a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k1/k1,\[Delta]k2/k2) = \
(%)\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.621148038010382`", ",", "0.4656576137733715`", ",", 
     "5.32718577485231`", ",", "5.490539274802362`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k1/k1,\[Delta]k2/k2) = (%)", {
   0.621148038010382, 0.4656576137733715, 5.32718577485231, 
   5.490539274802362}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9249650723269596`*^9, 3.9249672001108093`*^9, 
  3.9250334322454433`*^9, 3.925033541754603*^9, 3.925582344437792*^9, 
  3.927977895327076*^9, 3.927978648673149*^9, 3.9302227663218384`*^9, 
  3.930511155985432*^9, 3.941296852158407*^9, 3.9413130975507584`*^9, 
  3.941410590408684*^9, 3.941477764123911*^9},
 CellLabel->
  "During evaluation of \
In[229]:=",ExpressionUUID->"c8440d90-cadd-5349-b8c5-ff3ab6b5f175"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"117.4586832`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925033432264284*^9, 3.925033541765555*^9, 3.92558234446303*^9, 
  3.927977895359616*^9, 3.927978648709912*^9, 3.930222766337459*^9, 
  3.930511156004915*^9, 3.9412968521657143`*^9, 3.9413130975712776`*^9, 
  3.9414105904350586`*^9, 3.941477764137781*^9},
 CellLabel->
  "Out[229]=",ExpressionUUID->"3c11a75d-42a3-9a43-a1ef-c0551155a38a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.001951174135748626`", ",", "0.003254449005214555`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.04917181242888803`", ",", "0.0664890835959463`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.924965072336111*^9, 3.924967200142918*^9, 
  3.925033432264284*^9, 3.925033541765555*^9, 3.92558234446303*^9, 
  3.927977895359616*^9, 3.927978648709912*^9, 3.930222766337459*^9, 
  3.930511156004915*^9, 3.9412968521657143`*^9, 3.9413130975712776`*^9, 
  3.9414105904350586`*^9, 3.9414777641432896`*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"b600990b-60db-1141-8490-948c7e2c7c5d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Instead of the relaxation rates k1 and k2,  the relaxation rate, k=k1+k2,and  \
the population of the first state, p1=k2/(k1+k2), can be estimated. The \
colorML k and p1 are\
\>", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
  3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
  3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
  3.941290939675474*^9, 3.9412911106524086`*^9}, {3.9412913793395214`*^9, 
  3.941291457348461*^9}, {3.9412917338895226`*^9, 
  3.941291739316593*^9}},ExpressionUUID->"09261ae9-fdb7-bb49-a380-\
428407e90c6b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "2", "]"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["//",
    FontWeight->"Bold"], "Total"}], 
  RowBox[{"(*", 
   RowBox[{"k", "=", 
    RowBox[{"k1", "+", "k2"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parsColorML", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
  RowBox[{"Total", "[", 
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "2", "]"}], "]"}],
    FontWeight->"Bold"], 
   StyleBox["]",
    FontWeight->"Bold"]}], 
  StyleBox[
   RowBox[{
    StyleBox[
     RowBox[{"(", "*"}]], 
    RowBox[{"p1", "=", 
     RowBox[{"k2", "/", 
      RowBox[{"(", 
       RowBox[{"k1", "+", "k2"}]}]}]}], 
    StyleBox[
     RowBox[{"*", ")"}]]}],
   FontWeight->"Bold"]}]}], "Input",
 CellChangeTimes->{{3.941291655428713*^9, 3.9412917101806145`*^9}, {
  3.941291788252449*^9, 3.9412918114207077`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"d4718600-cd1d-b445-813f-eaef575a6aa2"],

Cell[BoxData["2.134010902218544`"], "Output",
 CellChangeTimes->{3.9412968521931343`*^9, 3.9413130976119537`*^9, 
  3.941410590468151*^9, 3.941477764171255*^9},
 CellLabel->
  "Out[231]=",ExpressionUUID->"1865b67a-ef3f-3242-b44b-616680791ebf"],

Cell[BoxData["0.5674645172771731`"], "Output",
 CellChangeTimes->{3.9412968521931343`*^9, 3.9413130976119537`*^9, 
  3.941410590468151*^9, 3.941477764176609*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"01cf67fd-0990-9947-b5e1-b8ec72ee7b83"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The standard deviations of k and p1 ", "Text",
 CellChangeTimes->{{3.924964515106406*^9, 3.924964526647745*^9}, {
   3.924965057096119*^9, 3.9249650640816536`*^9}, {3.9412908312747097`*^9, 
   3.941290843508362*^9}, {3.941290877315466*^9, 3.941290878068384*^9}, {
   3.941290939675474*^9, 3.9412911106524086`*^9}, {3.9412913793395214`*^9, 
   3.941291457348461*^9}, 
   3.941291748763335*^9},ExpressionUUID->"2bb25297-4fcc-584f-8671-\
b08c7a22b96b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    StyleBox["stdkp",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Bold"], 
    RowBox[{
     StyleBox["stdColorMLDyn2stkp",
      FontWeight->"Bold"], "[", 
     RowBox[{"bursts", ",", 
      StyleBox["parsColorML",
       FontWeight->"Bold"]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", "stdkp"}], "Input",
 CellChangeTimes->{{3.927976475263088*^9, 3.927976497784153*^9}, 
   3.927977751591348*^9, {3.927977844032476*^9, 3.927977857688723*^9}, {
   3.941291473100567*^9, 3.941291473500084*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"5a37d1a3-9290-8244-a86a-a54928337080"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" std: (\[Delta]e1,\[Delta]e2,\[Delta]k,\[Delta]p1) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.0019511353867056878`", ",", "0.003254423788180897`", ",", 
     "0.10461511532182187`", ",", "0.011456932443129226`"}], "}"}]}],
  SequenceForm[
  " std: (\[Delta]e1,\[Delta]e2,\[Delta]k,\[Delta]p1) = ", {
   0.0019511353867056878`, 0.003254423788180897, 0.10461511532182187`, 
   0.011456932443129226`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.927977992206154*^9, 3.927978718753287*^9, 
  3.930222839714319*^9, 3.930511193762436*^9, 3.9412968857185383`*^9, 
  3.941313107805441*^9, 3.941410622907028*^9, 3.9414778835764866`*^9},
 CellLabel->
  "During evaluation of \
In[233]:=",ExpressionUUID->"c2778278-3a8a-e049-ae83-89a5ebca78eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k/k,\[Delta]p1/p1) = (%)\
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.6211357024163646`", ",", "0.4656540056345742`", ",", 
     "4.90227651663179`", ",", "2.018968956526525`"}], "}"}]}],
  SequenceForm[
  " (\[Delta]e1/e1,\[Delta]e2/e2,\[Delta]k/k,\[Delta]p1/p1) = (%)", {
   0.6211357024163646, 0.4656540056345742, 4.90227651663179, 
   2.018968956526525}],
  Editable->False]], "Print",
 CellChangeTimes->{3.927977992206154*^9, 3.927978718753287*^9, 
  3.930222839714319*^9, 3.930511193762436*^9, 3.9412968857185383`*^9, 
  3.941313107805441*^9, 3.941410622907028*^9, 3.9414778835803013`*^9},
 CellLabel->
  "During evaluation of \
In[233]:=",ExpressionUUID->"daad25a2-ced7-b94d-8458-c570591bd3bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"119.3887138`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.927977992240513*^9, 3.9279787187897053`*^9, 
  3.9302228397299423`*^9, 3.930511193787145*^9, 3.9412968857370872`*^9, 
  3.9413131078261642`*^9, 3.941410622941723*^9, 3.941477883595438*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"3d06d0f0-e2a7-8548-b804-3fc525196f4f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.0019511353867056878`", ",", "0.003254423788180897`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.10461511532182187`", ",", "0.011456932443129226`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.927977992240513*^9, 3.9279787187897053`*^9, 
  3.9302228397299423`*^9, 3.930511193787145*^9, 3.9412968857370872`*^9, 
  3.9413131078261642`*^9, 3.941410622941723*^9, 3.94147788360079*^9},
 CellLabel->
  "Out[234]=",ExpressionUUID->"f986cd94-69ab-834e-a9c7-ad4c6a6e6a8a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FRET  efficiencies  in  colorML  are  influenced  by  background  noise.  \
Uncorrected (apparent) FRET efficiencies are\
\>", "Text",
 CellChangeTimes->{{3.9412918558315144`*^9, 
  3.941291903605404*^9}},ExpressionUUID->"3c7648bc-c4b7-8c41-b412-\
452db41037a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"parsColorML", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.92503607154747*^9, 3.9250360995895424`*^9}, {
  3.941291908020975*^9, 3.941291908416668*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"196048d1-5f93-cf41-afc6-309f04993545"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3141238507326677`", ",", "0.6988931156612518`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9250361002364006`*^9, 3.925582344492239*^9, 
  3.9279780350294933`*^9, 3.927978718860281*^9, 3.9302228397923775`*^9, 
  3.930511193815227*^9, 3.941296885776642*^9, 3.941309340917055*^9, 
  3.9413131078672657`*^9, 3.9414106229828014`*^9, 3.941477883626667*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"e06072f3-9de7-1441-a53f-87851631a0c4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Corrected  FRET efficiencies  depend on  the  mean  photon  count  rates nAv \
defined as the total number of photons in all bursts  divided by the total \
duration of all bursts\
\>", "Text",
 CellChangeTimes->{{3.9412918558315153`*^9, 3.941291903605404*^9}, {
  3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
  3.9412921323343143`*^9}, {3.941292167078026*^9, 
  3.941292167710148*^9}},ExpressionUUID->"31ee2214-f69b-6d47-a2bd-\
8c659d989c2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nAv", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "bursts"}], "]"}], "]"}], "/", 
   RowBox[{"Total", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"Last", ",", 
      RowBox[{"bursts", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9279770231877975`*^9, 3.927977127335327*^9}, {
   3.927977230504328*^9, 3.927977238744379*^9}, 3.927978338433634*^9, {
   3.9412922356163483`*^9, 3.941292235997347*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"85753586-59fa-dd43-ae1e-7d970ee13202"],

Cell[BoxData["69.67940292239234`"], "Output",
 CellChangeTimes->{3.927978339138266*^9, 3.927978719046772*^9, 
  3.930222839995516*^9, 3.9305111939258747`*^9, 3.9412968858194923`*^9, 
  3.9413093469498825`*^9, 3.9413131079048576`*^9, 3.941410623018688*^9, 
  3.9414778836545124`*^9},
 CellLabel->
  "Out[236]=",ExpressionUUID->"8fd011bd-acd8-9746-89c7-1d835e3f9f38"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Corrected  FRET efficiencies  ", "Text",
 CellChangeTimes->{{3.9412918558315144`*^9, 3.941291903605404*^9}, {
   3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
   3.9412921323343143`*^9}, {3.941292167078026*^9, 3.941292167710148*^9}, {
   3.9412922075171165`*^9, 3.941292218777252*^9}, 
   3.941295757620167*^9},ExpressionUUID->"6bdb1f3a-c5af-484c-a337-\
69736e84da0c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["Map",
   FontWeight->"Bold"], 
  StyleBox["[",
   FontWeight->"Bold"], 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["eBNCorr",
      FontWeight->"Bold"], "[", 
     RowBox[{"#", ",", " ", "bA", ",", " ", "bD", ",", " ", "nAv"}], "]"}], 
    "&"}], " ", ",", 
   StyleBox[
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "1", "]"}], "]"}],
    FontWeight->"Bold"]}], 
  StyleBox["]",
   FontWeight->"Bold"]}]], "Input",
 CellChangeTimes->{{3.925033502840843*^9, 3.925033507818064*^9}, {
  3.9250336065484066`*^9, 3.925033608540818*^9}, {3.92503603990686*^9, 
  3.925036061744723*^9}, {3.925036123191429*^9, 3.925036136556793*^9}, {
  3.927976608024113*^9, 3.927976612807223*^9}, {3.9279769271193132`*^9, 
  3.927976997064295*^9}, {3.9279771490553856`*^9, 3.927977161904291*^9}, {
  3.927977248871412*^9, 3.927977260927305*^9}, {3.941292229462612*^9, 
  3.941292229662548*^9}, {3.9412957135411415`*^9, 3.9412957471178055`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"b5bdb5ab-18a3-f946-959f-9303aa44594e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2982624542376666`", ",", "0.7003430288690271`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9279783645918865`*^9, 3.9279787191288624`*^9, 
  3.930222840058012*^9, 3.930511193981088*^9, 3.9412968858614025`*^9, 
  3.941309353032091*^9, 3.9413131079334183`*^9, 3.941410623053112*^9, 
  3.941477883697838*^9},
 CellLabel->
  "Out[237]=",ExpressionUUID->"b5096cce-45f7-d844-a830-aa5f57dd0869"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
colorML population can be interpreted as a burst fraction when transitions \
are slow\
\>", "Text",
 CellChangeTimes->{{3.9412918558315153`*^9, 3.941291903605404*^9}, {
   3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
   3.9412921323343143`*^9}, {3.941292167078026*^9, 3.941292167710148*^9}, {
   3.941292207517117*^9, 3.941292218777252*^9}, 3.941295757620167*^9, {
   3.941295978612196*^9, 3.9412960366133175`*^9}, {3.94154776238735*^9, 
   3.941547762641596*^9}},ExpressionUUID->"6f5a4a3f-1f43-2f4d-a017-\
6b23bf7e7b7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p1ML", "=", 
  RowBox[{
   RowBox[{"parsColorML", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", 
   RowBox[{"Total", "[", 
    RowBox[{"parsColorML", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.92503607154747*^9, 3.9250360995895424`*^9}, {
  3.925106352064013*^9, 3.925106363359236*^9}, {3.9251064161216545`*^9, 
  3.925106417657694*^9}, {3.927977291457338*^9, 3.927977328575262*^9}, {
  3.9412960567249737`*^9, 3.941296058749378*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"818d6321-8f42-4047-8c66-3c25cad68051"],

Cell[BoxData["0.5674645172771731`"], "Output",
 CellChangeTimes->{3.9251063637270336`*^9, 3.9255823446387463`*^9, 
  3.927978433564003*^9, 3.927978719168148*^9, 3.930222840089245*^9, 
  3.930511194012474*^9, 3.9412969491731033`*^9, 3.9413093758112774`*^9, 
  3.9413131079680233`*^9, 3.9414106231148834`*^9, 3.941477883736698*^9},
 CellLabel->
  "Out[238]=",ExpressionUUID->"5cc92867-a745-be4f-8c8c-c5a8513a4425"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ColorML population can be corrected for unequal brightness and diffusivity \
using estimates for  the count rates and diffusion coefficients (exact values \
in this case):\
\>", "Text",
 CellChangeTimes->{{3.9412918558315153`*^9, 3.941291903605404*^9}, {
   3.941291985151682*^9, 3.941291990742361*^9}, {3.941292024052227*^9, 
   3.9412921323343143`*^9}, {3.941292167078026*^9, 3.941292167710148*^9}, {
   3.941292207517117*^9, 3.941292218777252*^9}, 3.941295757620167*^9, {
   3.941295978612196*^9, 3.9412960366133175`*^9}, {3.9412960925722904`*^9, 
   3.941296130284668*^9}, {3.941547793245863*^9, 
   3.941547885969507*^9}},ExpressionUUID->"97db7421-c9fc-974a-95ea-\
de969ee17954"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox["p1Corr",
   FontWeight->"Bold"], "[", 
  RowBox[{
   StyleBox["p1ML",
    FontWeight->"Bold"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"n01", ",", " ", "n02"}], "}"}], ",", " ", 
   RowBox[{
    RowBox[{"axy", "^", "2"}], "/", 
    RowBox[{"{", 
     RowBox[{"d1", ",", " ", "d2"}], "}"}]}], ",", 
   RowBox[{"az", "/", "axy"}], ",", 
   RowBox[{"bA", "+", "bD"}], ",", " ", "nTh", ",", " ", "tTh", ",", " ", 
   "qMax", ",", " ", "jMax"}], "]"}]], "Input",
 CellChangeTimes->{{3.925036253417362*^9, 3.9250363068368397`*^9}, {
   3.925106371618894*^9, 3.9251063922628326`*^9}, 3.927977341888644*^9, {
   3.9412961349971848`*^9, 3.941296135292679*^9}, {3.9414837416576633`*^9, 
   3.9414837423865833`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"428ef7f6-b0dd-264b-85f2-b930667eed82"],

Cell[BoxData["0.5374815274169195`"], "Output",
 CellChangeTimes->{3.925036333170656*^9, 3.925106282569332*^9, 
  3.9251063992440968`*^9, 3.92558234467231*^9, 3.927978441103401*^9, 
  3.927978719211979*^9, 3.9302228401360664`*^9, 3.930511194051491*^9, 
  3.941296969235737*^9, 3.9413093866900234`*^9, 3.941313108014166*^9, 
  3.9414106231527023`*^9, 3.9414778838187428`*^9, 3.9414837470176315`*^9, 
  3.9414838108325844`*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"295ada64-64ec-b14b-a155-f06c744790f1"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
RulerUnits->"Inches",
CellGrouping->Manual,
WindowSize->{1578.75, 813.75},
WindowMargins->{{145.5, Automatic}, {Automatic, 85.5}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PrintCellBrackets"->True,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{54, 54}, {72, 72}}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"68c462fe-956c-a340-ba7c-d7f0fb907346"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 460, 7, 122, "Title",ExpressionUUID->"62156fb9-ce8f-4703-a030-792eeb38a9b2"],
Cell[1043, 31, 4055, 85, 417, "Text",ExpressionUUID->"a27a199f-6b88-9f41-9829-fe4911119ee4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5135, 121, 156, 3, 83, "Section",ExpressionUUID->"4fa8f302-cdd9-a647-81c8-6b498f7475ca"],
Cell[CellGroupData[{
Cell[5316, 128, 282, 5, 56, "Subsubsection",ExpressionUUID->"39480b57-aa20-b347-b267-3d3962b1cb4d"],
Cell[5601, 135, 2080, 49, 131, "Text",ExpressionUUID->"edbaee63-3696-9f45-b424-1c4d0cf019fb"],
Cell[CellGroupData[{
Cell[7706, 188, 1715, 35, 52, "Subtitle",ExpressionUUID->"61c67ca1-4f31-b74a-8245-d6fd17708252",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9424, 225, 21938, 441, 1208, "Code",ExpressionUUID->"d5f98567-49b2-b144-98e1-bf1dd672c95a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[31399, 671, 1765, 34, 74, "Subtitle",ExpressionUUID->"d4031275-63c1-344a-839f-cf6c1d8c414e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[33167, 707, 31995, 618, 1963, "Code",ExpressionUUID->"8935ffa4-a9c8-9b43-9fa8-7297fc43d643",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[65199, 1330, 3204, 71, 74, "Subtitle",ExpressionUUID->"7dc6f988-afd2-bf40-9daa-8b00fd139e70",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[68406, 1403, 23902, 442, 941, "Code",ExpressionUUID->"131cd7f8-ec67-2243-9c90-dd6d930c0ad0"]
}, Closed]],
Cell[CellGroupData[{
Cell[92345, 1850, 2310, 51, 76, "Subtitle",ExpressionUUID->"91860aa9-a8c2-4a4c-bb95-08bba1a15024",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[94658, 1903, 20812, 462, 1177, "Code",ExpressionUUID->"b7390fc1-9564-824e-b2de-e60eab9104d9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[115507, 2370, 2371, 52, 76, "Subtitle",ExpressionUUID->"9bf05d11-b44b-0a4a-b3a9-0e334549dfaf",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[117881, 2424, 20931, 473, 1177, "Code",ExpressionUUID->"e9c4e268-0ebb-1e43-b923-f7e3c530ec7c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[138849, 2902, 2288, 48, 53, "Subtitle",ExpressionUUID->"81745a67-9d3c-004b-be08-b0d3b5095d73"],
Cell[141140, 2952, 3516, 94, 339, "Code",ExpressionUUID->"ed9f8764-b4d6-ac44-8d98-d49c6f2a20d9"],
Cell[CellGroupData[{
Cell[144681, 3050, 206, 3, 35, "Input",ExpressionUUID->"ff797d22-1932-d24d-b5ae-8db8858bbf83"],
Cell[144890, 3055, 237, 3, 60, "Output",ExpressionUUID->"888acf0b-097e-fa4c-a864-1b1d3eab7a96"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145188, 3065, 353, 6, 56, "Subsubsection",ExpressionUUID->"1c55a70d-95de-0549-82f9-fac6acbd8d06"],
Cell[145544, 3073, 1785, 33, 45, "Text",ExpressionUUID->"d27a1358-15fc-de44-9ad5-eeab7536cb98"],
Cell[CellGroupData[{
Cell[147354, 3110, 1814, 37, 52, "Subtitle",ExpressionUUID->"3dd99222-1377-2347-bb7b-eff7bf2f32c0",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[149171, 3149, 28358, 598, 1700, "Code",ExpressionUUID->"7e4f6ee4-65c5-2e4c-84a6-1f21c3247141",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[177566, 3752, 2024, 40, 74, "Subtitle",ExpressionUUID->"a668da2e-b7e3-9c46-84dc-15f3c887e55c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[179593, 3794, 32732, 644, 2012, "Code",ExpressionUUID->"ff5ea0f9-b4d3-5d4b-bd9f-ac613105da59",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[212362, 4443, 3560, 81, 74, "Subtitle",ExpressionUUID->"d0a4e92f-02c8-ba44-af5a-dc4f0b8f56b9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[215925, 4526, 23376, 422, 1056, "Code",ExpressionUUID->"e70c34f4-b0ad-cf4e-a88a-d3bc185ce3c7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[239338, 4953, 2346, 51, 76, "Subtitle",ExpressionUUID->"a93004d3-e42a-904a-8ed9-10d9b4d9d5c7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[241687, 5006, 20837, 467, 1245, "Code",ExpressionUUID->"a95373dd-71bf-2648-994b-52e4c75341f4",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[262585, 5480, 207, 4, 83, "Section",ExpressionUUID->"c1098daf-fd9c-3540-9ddf-3d3df5cc22c5"],
Cell[CellGroupData[{
Cell[262817, 5488, 1656, 31, 50, "Subtitle",ExpressionUUID->"71ae0eb7-031f-5048-9473-ad454e758b86"],
Cell[264476, 5521, 13790, 285, 1161, "Code",ExpressionUUID->"b35b4623-f513-b34c-840c-e4b9978991ee"]
}, Closed]],
Cell[CellGroupData[{
Cell[278303, 5811, 2106, 48, 50, "Subtitle",ExpressionUUID->"5bcb6269-9976-924c-b25d-f162cb06564d"],
Cell[280412, 5861, 15838, 296, 831, "Code",ExpressionUUID->"4a0d44ee-f137-574c-97b4-fe581e338ddf"]
}, Closed]],
Cell[CellGroupData[{
Cell[296287, 6162, 2132, 44, 52, "Subtitle",ExpressionUUID->"4111b4fe-9da9-3842-a894-8336b24977c6",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[298422, 6208, 16447, 370, 999, "Code",ExpressionUUID->"ee4c07ac-fd1a-ed47-8687-2d7418424499"]
}, Closed]],
Cell[CellGroupData[{
Cell[314906, 6583, 2170, 44, 52, "Subtitle",ExpressionUUID->"e1ce960e-beb5-9542-bfab-025880a6b941",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[317079, 6629, 17577, 398, 999, "Code",ExpressionUUID->"a88be000-0a70-e445-b32b-2cc63962f2f9"]
}, Closed]],
Cell[CellGroupData[{
Cell[334693, 7032, 779, 21, 50, "Subtitle",ExpressionUUID->"6713a408-1a0a-864d-818b-53aa94a058d1"],
Cell[335475, 7055, 2000, 47, 173, "Code",ExpressionUUID->"b8591cde-dc88-e548-9990-38379c232f2b"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[337524, 7108, 1245, 18, 83, "Section",ExpressionUUID->"22be18a9-4604-184f-b798-2e9907e02468"],
Cell[338772, 7128, 494, 9, 72, "Text",ExpressionUUID->"26e53366-a709-904f-8d70-b374fc5da731"],
Cell[CellGroupData[{
Cell[339291, 7141, 1597, 33, 50, "Subtitle",ExpressionUUID->"7ecd24c7-8f0f-d54c-9338-4acd67517950",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[340891, 7176, 18470, 357, 966, "Code",ExpressionUUID->"07f92517-9144-f547-b410-88444e72bb33"]
}, Closed]],
Cell[CellGroupData[{
Cell[359398, 7538, 728, 15, 50, "Subtitle",ExpressionUUID->"eb8684f3-1364-bb4b-90c9-7e1b3f580a2b"],
Cell[360129, 7555, 17956, 327, 930, "Code",ExpressionUUID->"f65d1b83-f40f-a243-9455-36cb0c4f9c8f"]
}, Closed]],
Cell[CellGroupData[{
Cell[378122, 7887, 628, 12, 50, "Subtitle",ExpressionUUID->"3468d4f2-6e80-fb44-b5a4-651da27cbcf8"],
Cell[378753, 7901, 4676, 109, 468, "Code",ExpressionUUID->"8c4f7871-6e69-c146-b7be-3be9b6ba2852"]
}, Closed]],
Cell[CellGroupData[{
Cell[383466, 8015, 557, 11, 50, "Subtitle",ExpressionUUID->"64e877a2-6b50-484b-b836-4546aaf3c690"],
Cell[384026, 8028, 4492, 109, 513, "Code",ExpressionUUID->"eda5650a-2049-8e46-b991-1e067a5909c4"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[388567, 8143, 313, 5, 83, "Section",ExpressionUUID->"0921c886-fd89-c948-bb6c-b581d7410680"],
Cell[388883, 8150, 2177, 52, 273, "Text",ExpressionUUID->"ddd42176-6444-af4e-b005-b49be642680d"],
Cell[CellGroupData[{
Cell[391085, 8206, 2754, 60, 90, "Subtitle",ExpressionUUID->"82c9e417-e68e-7440-93b3-d96517972f2b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[393842, 8268, 14954, 326, 1329, "Code",ExpressionUUID->"4f772abb-991f-7e40-bc6e-a61cf284f2bb",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[408833, 8599, 1443, 30, 50, "Subtitle",ExpressionUUID->"a9a52028-7752-9e4c-8ffc-58616cd8f996",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[410279, 8631, 7452, 184, 656, "Code",ExpressionUUID->"fe817b36-824e-af4f-a60a-d13c2b898e80",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[417768, 8820, 1155, 26, 50, "Subtitle",ExpressionUUID->"39f8d9fb-24ee-1940-bfc7-b3eff7fbb7bc",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[418926, 8848, 6258, 162, 480, "Code",ExpressionUUID->"e7348b14-4d4d-9f41-90d6-1d2bace8628c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[425221, 9015, 1436, 33, 74, "Subtitle",ExpressionUUID->"b1e59fdd-8127-ce4f-baeb-624ab8edf039",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[426660, 9050, 6275, 142, 414, "Code",ExpressionUUID->"03a2bd39-31af-9c4c-8c3d-edc96d87eca7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[432984, 9198, 155, 3, 83, "Section",ExpressionUUID->"4296c3ab-40ee-df40-94b8-68b2c89059a5"],
Cell[CellGroupData[{
Cell[433164, 9205, 177, 3, 67, "Subsection",ExpressionUUID->"6cf4be3e-485d-5744-a51d-1b47c0968c25"],
Cell[433344, 9210, 5960, 160, 464, "Input",ExpressionUUID->"c5699082-179f-9746-982f-5bfb9d989546"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439341, 9375, 342, 5, 67, "Subsection",ExpressionUUID->"7436f627-c3aa-6a43-8efe-43db040620f3"],
Cell[CellGroupData[{
Cell[439708, 9384, 711, 12, 43, "Text",ExpressionUUID->"009fa71f-a5a8-e249-bdc4-0f56b69c2224"],
Cell[CellGroupData[{
Cell[440444, 9400, 2405, 60, 107, "Input",ExpressionUUID->"ba406bce-926b-f344-a1e6-5c7b8eb2fae0"],
Cell[442852, 9462, 1083, 18, 40, "Output",ExpressionUUID->"cb68de95-3b85-d74c-b1dc-f6a01b3f1bc1"],
Cell[443938, 9482, 2379, 58, 65, "Output",ExpressionUUID->"db86512e-a7a8-7a46-887d-009bb892ace9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[446366, 9546, 258, 4, 37, "Text",ExpressionUUID->"d749fdef-1bb0-ad47-8dd6-78fc3d8da23f"],
Cell[CellGroupData[{
Cell[446649, 9554, 1248, 34, 60, "Input",ExpressionUUID->"c69d6b21-863f-5241-b606-a2e70c66ba4e"],
Cell[447900, 9590, 1789, 47, 65, "Output",ExpressionUUID->"0068ce93-7c41-8e45-ac41-c51cf308453d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[449738, 9643, 217, 4, 37, "Text",ExpressionUUID->"a8f7845c-97e5-7e4e-a258-ebe7ce75c646"],
Cell[CellGroupData[{
Cell[449980, 9651, 1050, 26, 60, "Input",ExpressionUUID->"1775f98b-7d04-da4a-841c-e7350336aaa4"],
Cell[451033, 9679, 2338, 55, 65, "Output",ExpressionUUID->"50f1554d-a61f-b340-b3f1-4abbee4eb061"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[453420, 9740, 309, 6, 37, "Text",ExpressionUUID->"e7c09b33-cd07-504a-b7bd-0e77b1ad236f"],
Cell[453732, 9748, 658, 18, 35, "Input",ExpressionUUID->"0c8ed64d-c058-a74f-88f4-a864a149f0fc"],
Cell[CellGroupData[{
Cell[454415, 9770, 528, 13, 60, "Input",ExpressionUUID->"5e8e0f55-e342-0b4e-9c93-dd50983dda96"],
Cell[454946, 9785, 524, 9, 40, "Output",ExpressionUUID->"f1b40f84-dd40-6243-a34c-833e429b3e92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[455507, 9799, 838, 19, 83, "Input",ExpressionUUID->"75143194-e63c-944b-b311-7b0feec4ab5d"],
Cell[456348, 9820, 10051, 236, 255, "Output",ExpressionUUID->"a059cd1a-91bd-0046-b971-0335e8ade131"],
Cell[466402, 10058, 3998, 92, 112, "Output",ExpressionUUID->"0584ecf5-ac67-4d4a-9145-48802ed3c75e"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[470461, 10157, 466, 7, 67, "Subsection",ExpressionUUID->"4daa62d2-e13e-d84e-b3e0-2e25ab722b92"],
Cell[CellGroupData[{
Cell[470952, 10168, 637, 11, 43, "Text",ExpressionUUID->"2ca257d0-53e4-bb4e-91a5-7b77d5ed703c"],
Cell[CellGroupData[{
Cell[471614, 10183, 3598, 81, 226, "Input",ExpressionUUID->"c411af84-0d4f-0546-bb34-c6bc2a5f3a3f"],
Cell[CellGroupData[{
Cell[475237, 10268, 6476, 190, 297, "Input",ExpressionUUID->"7a0dde17-0ac7-7b45-a34f-163c9b11053f"],
Cell[481716, 10460, 829, 14, 40, "Output",ExpressionUUID->"48f093f3-c86c-8047-a84d-93091e76333c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[482594, 10480, 1477, 33, 83, "Input",ExpressionUUID->"866c5872-0e57-3343-a945-f97e62966f40"],
Cell[484074, 10515, 620, 12, 40, "Output",ExpressionUUID->"daf64cc7-5f23-f543-82aa-3e2aec77b100"],
Cell[484697, 10529, 494, 8, 40, "Output",ExpressionUUID->"1722ef67-712a-d74d-bf63-3c64a4d6b95c"]
}, Open  ]],
Cell[485206, 10540, 777, 18, 83, "Input",ExpressionUUID->"10b9a6cb-6754-f243-9945-3df28d77d3f3"]
}, Closed]],
Cell[CellGroupData[{
Cell[486020, 10563, 526, 9, 37, "Text",ExpressionUUID->"c1fe3d25-1ab4-ef4a-9924-3f2fc19cb3d2"],
Cell[CellGroupData[{
Cell[486571, 10576, 6378, 188, 274, "Input",ExpressionUUID->"e5b5d5c8-f342-3f43-a441-1455ca8960d6"],
Cell[492952, 10766, 733, 12, 40, "Output",ExpressionUUID->"9af431ee-5bbe-0e40-ad61-803154efb52f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493722, 10783, 1393, 32, 83, "Input",ExpressionUUID->"79118ef6-5338-9145-a98a-e355ab90cb07"],
Cell[495118, 10817, 553, 11, 40, "Output",ExpressionUUID->"6753b3ea-e36d-cf4e-8810-59a5ac7292b6"],
Cell[495674, 10830, 425, 7, 40, "Output",ExpressionUUID->"e0b985a4-392b-8844-80c5-338551d7f15c"]
}, Open  ]],
Cell[496114, 10840, 828, 18, 83, "Input",ExpressionUUID->"80a67e6c-17b0-2a49-8ea0-115f771d265e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[496991, 10864, 365, 6, 67, "Subsection",ExpressionUUID->"acbd99be-4f4c-734e-b6bd-1a8f267336f4"],
Cell[497359, 10872, 1704, 57, 131, "Input",ExpressionUUID->"075141c1-c8ef-164a-993e-07acc8fc98d9"],
Cell[CellGroupData[{
Cell[499088, 10933, 339, 5, 43, "Text",ExpressionUUID->"759d3e8a-ee7d-6c42-9244-a0b00e7aeaec"],
Cell[499430, 10940, 436, 10, 60, "Input",ExpressionUUID->"c49b9f73-58a6-ad4a-9fa4-933ba8e7f9f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499903, 10955, 409, 6, 43, "Text",ExpressionUUID->"ebea82cd-7b83-9d46-9d5c-d609cd2efbbd"],
Cell[CellGroupData[{
Cell[500337, 10965, 2248, 56, 83, "Input",ExpressionUUID->"03e01cc2-12df-8b4d-a21b-2ea30a47c2de"],
Cell[502588, 11023, 542, 11, 27, "Print",ExpressionUUID->"0390a81e-ae83-6849-80ea-239eed818780"],
Cell[503133, 11036, 1188, 27, 27, "Print",ExpressionUUID->"7f584de5-97ae-2748-bbe5-a0900b06b2a4"],
Cell[504324, 11065, 476, 9, 40, "Output",ExpressionUUID->"bf698e98-4905-3047-88f6-3dcafa885381"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[504849, 11080, 487, 9, 37, "Text",ExpressionUUID->"77a7c2bb-3200-6743-993a-78434f829113"],
Cell[CellGroupData[{
Cell[505361, 11093, 1213, 29, 60, "Input",ExpressionUUID->"ad306e33-a09d-0a4a-9f3b-e9163cfa083c"],
Cell[506577, 11124, 642, 15, 27, "Print",ExpressionUUID->"095a396f-ea78-5447-ac30-8693dcb9871c"],
Cell[507222, 11141, 1180, 23, 27, "Print",ExpressionUUID->"76a0a362-e2bd-f04a-b414-e56520d7f0b7"],
Cell[508405, 11166, 1225, 24, 27, "Print",ExpressionUUID->"77b01a54-db61-d343-9bf8-b89c615d6312"],
Cell[509633, 11192, 422, 8, 40, "Output",ExpressionUUID->"f9970e3d-3499-8444-b0ae-cdb4547627db"],
Cell[510058, 11202, 779, 18, 40, "Output",ExpressionUUID->"1889e3a1-5ace-774e-9d2d-fd4feacf96f0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[510886, 11226, 538, 10, 37, "Text",ExpressionUUID->"1ca13246-f7bb-b145-b1a6-359b1c55ada7"],
Cell[CellGroupData[{
Cell[511449, 11240, 913, 24, 60, "Input",ExpressionUUID->"8fce1317-d9e5-914a-9616-cafff8be2060"],
Cell[512365, 11266, 1056, 21, 27, "Print",ExpressionUUID->"7e47215c-51f2-6e4e-9f21-fa8856bce02f"],
Cell[513424, 11289, 1101, 22, 27, "Print",ExpressionUUID->"52edc69f-1564-0c40-94ed-057625ac627e"],
Cell[514528, 11313, 350, 7, 40, "Output",ExpressionUUID->"ba43dd51-ae24-df4a-af6d-f68e196af553"],
Cell[514881, 11322, 711, 17, 40, "Output",ExpressionUUID->"c9513a7d-6076-1142-b1b4-e7919fc8002d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[515641, 11345, 1026, 23, 38, "Text",ExpressionUUID->"56b43ffa-1434-ee4e-a0a5-1607813bab7a"],
Cell[CellGroupData[{
Cell[516692, 11372, 412, 11, 35, "Input",ExpressionUUID->"fed953e4-cd13-4f41-b085-d13c4fdefb8c"],
Cell[517107, 11385, 422, 8, 40, "Output",ExpressionUUID->"72109d2f-fe24-df4a-8480-9016384f3382"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[517578, 11399, 515, 9, 37, "Text",ExpressionUUID->"6db253b6-6ba3-f247-a007-2a4e0e0bf3b9"],
Cell[CellGroupData[{
Cell[518118, 11412, 360, 10, 35, "Input",ExpressionUUID->"99ebc169-2c30-7a4d-b502-ad1d63de736f"],
Cell[518481, 11424, 284, 7, 40, "Output",ExpressionUUID->"2ad45758-e7d4-c149-ad35-0f0ef67e520b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[518814, 11437, 529, 8, 37, "Text",ExpressionUUID->"70ac4bd1-6575-7342-aaba-e464fb3bcee8"],
Cell[CellGroupData[{
Cell[519368, 11449, 577, 19, 35, "Input",ExpressionUUID->"75b8ea10-62d0-f541-9801-9a77999a10e3"],
Cell[519948, 11470, 428, 9, 40, "Output",ExpressionUUID->"06772da3-5dbf-6040-a9b7-fdd5ddee3a52"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[520425, 11485, 519, 7, 37, "Text",ExpressionUUID->"ded49841-63a9-e24c-b00e-d7b2d1c419d3"],
Cell[CellGroupData[{
Cell[520969, 11496, 1975, 46, 60, "Input",ExpressionUUID->"096deac0-df22-624b-9035-365430ae4a6b"],
Cell[522947, 11544, 540, 11, 27, "Print",ExpressionUUID->"ad6875f0-ac9e-b748-b39f-afb3cdad100f"],
Cell[523490, 11557, 704, 15, 27, "Print",ExpressionUUID->"4cd2fe50-3841-4c4b-8b38-5523d403e9bd"],
Cell[524197, 11574, 634, 11, 40, "Output",ExpressionUUID->"d01ea07e-1433-6a4c-8fe0-376289d5b3c2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[524880, 11591, 526, 8, 37, "Text",ExpressionUUID->"e07d44e9-b0bc-414e-920c-96dccd1df7bb"],
Cell[CellGroupData[{
Cell[525431, 11603, 473, 13, 35, "Input",ExpressionUUID->"12daffa7-a7ee-ee4b-896a-09154e11ac0c"],
Cell[525907, 11618, 433, 9, 40, "Output",ExpressionUUID->"9bf8b815-bf34-8045-8115-81401ee21380"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[526389, 11633, 374, 5, 37, "Text",ExpressionUUID->"5ee80725-9f5d-d94a-997f-aa351f71fcf2"],
Cell[526766, 11640, 708, 19, 83, "Input",ExpressionUUID->"1564ebe6-50e4-134c-91c5-d963341a761f"],
Cell[CellGroupData[{
Cell[527499, 11663, 1317, 29, 60, "Input",ExpressionUUID->"72a45620-68c4-5b49-9178-50c13e30ac93"],
Cell[528819, 11694, 595, 14, 27, "Print",ExpressionUUID->"02bd77ab-ff69-f84b-99cb-996c496a4ae9"],
Cell[529417, 11710, 608, 14, 27, "Print",ExpressionUUID->"8d98e7d6-a90a-7b48-9df8-6064066b2a62"],
Cell[530028, 11726, 426, 8, 40, "Output",ExpressionUUID->"07a3df85-76fc-5745-ac13-c3871c70af52"],
Cell[530457, 11736, 449, 9, 40, "Output",ExpressionUUID->"f6617e6e-7ecd-3c45-99ba-263300384d7e"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[530967, 11752, 418, 8, 67, "Subsection",ExpressionUUID->"a8b87097-bc9a-664e-8378-100ffb848080"],
Cell[531388, 11762, 1857, 63, 131, "Input",ExpressionUUID->"3a508ac5-e3a3-9a4a-8a3a-67b2bba08e29"],
Cell[CellGroupData[{
Cell[533270, 11829, 264, 4, 43, "Text",ExpressionUUID->"847f80a9-c0d0-0642-8805-fc5f3fb9601b"],
Cell[533537, 11835, 537, 13, 60, "Input",ExpressionUUID->"81faa253-e6a6-b74d-a101-657c9b28d2e7"]
}, Closed]],
Cell[CellGroupData[{
Cell[534111, 11853, 309, 7, 37, "Text",ExpressionUUID->"3b82e750-581a-b94d-916b-18c2a020fca6"],
Cell[CellGroupData[{
Cell[534445, 11864, 1044, 28, 60, "Input",ExpressionUUID->"170c55e7-41ff-7c47-a110-24e4f78f1d8c"],
Cell[535492, 11894, 676, 13, 27, "Print",ExpressionUUID->"9608168f-8226-104d-9ce0-54e91ea50405"],
Cell[536171, 11909, 838, 20, 27, "Print",ExpressionUUID->"a72f56c3-bf5c-d544-9192-425022a6dedb"],
Cell[537012, 11931, 624, 11, 40, "Output",ExpressionUUID->"a663f7c0-dc64-6b4f-8906-2d8a53d3bc6b"],
Cell[537639, 11944, 784, 16, 40, "Output",ExpressionUUID->"2055d1b7-0cc7-d041-9a05-3291f647c1b0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[538472, 11966, 502, 9, 37, "Text",ExpressionUUID->"5c96e44c-e7a6-b546-b6cb-89fa01cadaf7"],
Cell[CellGroupData[{
Cell[538999, 11979, 760, 22, 60, "Input",ExpressionUUID->"fd7ac5a6-5f25-fe46-bd72-0960ecea00d8"],
Cell[539762, 12003, 938, 20, 27, "Print",ExpressionUUID->"f3d4ccb7-b2d6-6a4e-bbf1-0c678ecb3954"],
Cell[540703, 12025, 941, 20, 27, "Print",ExpressionUUID->"fbd71f04-12d8-ba4c-a3df-4624174f1df3"],
Cell[541647, 12047, 490, 9, 40, "Output",ExpressionUUID->"d43b1bac-5961-7e4d-84bc-8b0cbb8205a9"],
Cell[542140, 12058, 661, 15, 40, "Output",ExpressionUUID->"7001e47e-5278-104d-8fc8-bd593bc84bb6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[542850, 12079, 622, 11, 37, "Text",ExpressionUUID->"b3848dfa-9604-7342-a088-f93428462fe8"],
Cell[CellGroupData[{
Cell[543497, 12094, 1047, 37, 60, "Input",ExpressionUUID->"1445c2c7-d575-1d40-a150-a0f25e6e5e89"],
Cell[544547, 12133, 244, 4, 40, "Output",ExpressionUUID->"6f687e9d-7eba-4240-86bd-54980c9566b6"],
Cell[544794, 12139, 247, 4, 40, "Output",ExpressionUUID->"090e66b5-20d0-2c46-a0f6-07160874f605"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[545090, 12149, 457, 7, 37, "Text",ExpressionUUID->"d42d2c26-bce1-ed4b-b8d8-d444381a6bca"],
Cell[CellGroupData[{
Cell[545572, 12160, 671, 19, 60, "Input",ExpressionUUID->"259d7f11-66a5-db48-bb38-6a48ec16c591"],
Cell[546246, 12181, 816, 18, 27, "Print",ExpressionUUID->"52a394c7-0b8a-cd41-8ff8-72affeddbc1d"],
Cell[547065, 12201, 815, 18, 27, "Print",ExpressionUUID->"6ecb1964-6556-994d-a73e-8180186bc067"],
Cell[547883, 12221, 379, 7, 40, "Output",ExpressionUUID->"31de2889-a376-ce4d-a60d-575be9bc0275"],
Cell[548265, 12230, 552, 13, 40, "Output",ExpressionUUID->"512523f7-8dee-d441-9a28-6270e4a8301c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[548866, 12249, 272, 6, 37, "Text",ExpressionUUID->"1c813730-0004-a045-8543-30008efd73b7"],
Cell[CellGroupData[{
Cell[549163, 12259, 286, 6, 35, "Input",ExpressionUUID->"0e0d7719-6f06-7b40-9ce9-31df47e46387"],
Cell[549452, 12267, 478, 9, 40, "Output",ExpressionUUID->"c91c98f3-11ae-594d-a8dc-4e33e9e4125e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[549979, 12282, 476, 9, 37, "Text",ExpressionUUID->"938c64d8-e3c1-2c4b-8c84-84f7b5b28335"],
Cell[CellGroupData[{
Cell[550480, 12295, 657, 17, 35, "Input",ExpressionUUID->"60110aff-5a25-014c-aa7f-e07a7ae3c010"],
Cell[551140, 12314, 363, 6, 40, "Output",ExpressionUUID->"662f1dc1-2131-db4f-a319-6ffbb043d361"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[551552, 12326, 488, 9, 37, "Text",ExpressionUUID->"a992e289-8789-694a-8b71-950feecc6554"],
Cell[CellGroupData[{
Cell[552065, 12339, 1053, 27, 35, "Input",ExpressionUUID->"31967f9b-810b-e642-9f67-4bcc2b1af2d5"],
Cell[553121, 12368, 435, 9, 40, "Output",ExpressionUUID->"efb1de19-2b23-3344-bda9-80a12034132e"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[553617, 12384, 398, 7, 67, "Subsection",ExpressionUUID->"37c917de-c233-be47-9804-9293b449f6e3"],
Cell[554018, 12393, 1704, 57, 131, "Input",ExpressionUUID->"5738b43f-1e90-9447-827e-090612baee15"],
Cell[CellGroupData[{
Cell[555747, 12454, 264, 4, 43, "Text",ExpressionUUID->"6d9c4882-97c4-744f-8a7b-5cc7aa542fab"],
Cell[556014, 12460, 587, 13, 60, "Input",ExpressionUUID->"77724f00-acc4-2944-88eb-06390b8323ec"]
}, Closed]],
Cell[CellGroupData[{
Cell[556638, 12478, 309, 7, 37, "Text",ExpressionUUID->"801747da-4864-4044-a9e3-1045129fc554"],
Cell[CellGroupData[{
Cell[556972, 12489, 1044, 28, 60, "Input",ExpressionUUID->"53efb013-b258-a940-b66d-632b03a76515"],
Cell[558019, 12519, 674, 13, 27, "Print",ExpressionUUID->"04491372-5319-d744-b13a-7b50e76beea8"],
Cell[558696, 12534, 838, 20, 27, "Print",ExpressionUUID->"6c9e99c5-d2c6-1347-8d5e-8329b270e8bd"],
Cell[559537, 12556, 622, 11, 40, "Output",ExpressionUUID->"08617a0e-929a-6c4c-9c20-e78c73d52c80"],
Cell[560162, 12569, 782, 16, 40, "Output",ExpressionUUID->"d69c5269-ef72-a948-8ba8-618aa2ad1abe"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[560993, 12591, 502, 9, 37, "Text",ExpressionUUID->"a6db54c0-d286-7d44-9f36-80228981ff85"],
Cell[CellGroupData[{
Cell[561520, 12604, 760, 22, 60, "Input",ExpressionUUID->"7f87db89-69fb-3b4f-b2ca-2aadba62c476"],
Cell[562283, 12628, 936, 20, 27, "Print",ExpressionUUID->"ae558ebf-9641-3a44-a8e1-45372117300a"],
Cell[563222, 12650, 934, 20, 27, "Print",ExpressionUUID->"c8440d90-cadd-5349-b8c5-ff3ab6b5f175"],
Cell[564159, 12672, 493, 9, 40, "Output",ExpressionUUID->"3c11a75d-42a3-9a43-a1ef-c0551155a38a"],
Cell[564655, 12683, 663, 15, 40, "Output",ExpressionUUID->"b600990b-60db-1141-8490-948c7e2c7c5d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[565367, 12704, 622, 11, 37, "Text",ExpressionUUID->"09261ae9-fdb7-bb49-a380-428407e90c6b"],
Cell[CellGroupData[{
Cell[566014, 12719, 1047, 37, 60, "Input",ExpressionUUID->"d4718600-cd1d-b445-813f-eaef575a6aa2"],
Cell[567064, 12758, 243, 4, 40, "Output",ExpressionUUID->"1865b67a-ef3f-3242-b44b-616680791ebf"],
Cell[567310, 12764, 244, 4, 40, "Output",ExpressionUUID->"01cf67fd-0990-9947-b5e1-b8ec72ee7b83"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[567603, 12774, 455, 7, 37, "Text",ExpressionUUID->"2bb25297-4fcc-584f-8671-b08c7a22b96b"],
Cell[CellGroupData[{
Cell[568083, 12785, 671, 19, 60, "Input",ExpressionUUID->"5a37d1a3-9290-8244-a86a-a54928337080"],
Cell[568757, 12806, 819, 18, 27, "Print",ExpressionUUID->"c2778278-3a8a-e049-ae83-89a5ebca78eb"],
Cell[569579, 12826, 810, 18, 27, "Print",ExpressionUUID->"daad25a2-ced7-b94d-8458-c570591bd3bb"],
Cell[570392, 12846, 380, 7, 40, "Output",ExpressionUUID->"3d06d0f0-e2a7-8548-b804-3fc525196f4f"],
Cell[570775, 12855, 550, 13, 40, "Output",ExpressionUUID->"f986cd94-69ab-834e-a9c7-ad4c6a6e6a8a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[571374, 12874, 272, 6, 37, "Text",ExpressionUUID->"3c7648bc-c4b7-8c41-b412-452db41037a2"],
Cell[CellGroupData[{
Cell[571671, 12884, 286, 6, 35, "Input",ExpressionUUID->"196048d1-5f93-cf41-afc6-309f04993545"],
Cell[571960, 12892, 476, 9, 40, "Output",ExpressionUUID->"e06072f3-9de7-1441-a53f-87851631a0c4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[572485, 12907, 476, 9, 37, "Text",ExpressionUUID->"31ee2214-f69b-6d47-a2bd-8c659d989c2a"],
Cell[CellGroupData[{
Cell[572986, 12920, 657, 17, 35, "Input",ExpressionUUID->"85753586-59fa-dd43-ae1e-7d970ee13202"],
Cell[573646, 12939, 365, 6, 40, "Output",ExpressionUUID->"8fd011bd-acd8-9746-89c7-1d835e3f9f38"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[574060, 12951, 397, 6, 37, "Text",ExpressionUUID->"6bdb1f3a-c5af-484c-a337-69736e84da0c"],
Cell[CellGroupData[{
Cell[574482, 12961, 1053, 27, 35, "Input",ExpressionUUID->"b5bdb5ab-18a3-f946-959f-9303aa44594e"],
Cell[575538, 12990, 430, 9, 40, "Output",ExpressionUUID->"b5096cce-45f7-d844-a830-aa5f57dd0869"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[576017, 13005, 555, 10, 37, "Text",ExpressionUUID->"6f5a4a3f-1f43-2f4d-a017-6b23bf7e7b7b"],
Cell[CellGroupData[{
Cell[576597, 13019, 611, 14, 35, "Input",ExpressionUUID->"818d6321-8f42-4047-8c66-3c25cad68051"],
Cell[577211, 13035, 412, 6, 40, "Output",ExpressionUUID->"5cc92867-a745-be4f-8c8c-c5a8513a4425"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[577672, 13047, 694, 12, 37, "Text",ExpressionUUID->"97db7421-c9fc-974a-95ea-de969ee17954"],
Cell[CellGroupData[{
Cell[578391, 13063, 824, 21, 35, "Input",ExpressionUUID->"428ef7f6-b0dd-264b-85f2-b930667eed82"],
Cell[579218, 13086, 507, 8, 40, "Output",ExpressionUUID->"295ada64-64ec-b14b-a155-f06c744790f1"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

